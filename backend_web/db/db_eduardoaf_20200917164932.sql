/*
SQLyog Community v12.1 (32 bit)
MySQL - 10.4.11-MariaDB-1:10.4.11+maria~bionic : Database - db_eduardoaf
*********************************************************************
*/

/*!40101 SET NAMES utf8 */;

/*!40101 SET SQL_MODE=''*/;

/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
CREATE DATABASE /*!32312 IF NOT EXISTS*/`db_eduardoaf` /*!40100 DEFAULT CHARACTER SET utf8 */;

USE `db_eduardoaf`;

/*Table structure for table `app_array` */

DROP TABLE IF EXISTS `app_array`;

CREATE TABLE `app_array` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `type` varchar(15) DEFAULT NULL,
  `id_tosave` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL,
  `slug` varchar(150) DEFAULT NULL,
  `url_final` varchar(200) DEFAULT NULL,
  `id_user` int(11) DEFAULT NULL COMMENT 'propietario del tipo o categoria',
  `order_by` int(5) NOT NULL DEFAULT 100,
  `code_cache` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=19 DEFAULT CHARSET=utf8mb4;

/*Data for the table `app_array` */

insert  into `app_array`(`processflag`,`insert_platform`,`insert_user`,`insert_date`,`update_platform`,`update_user`,`update_date`,`delete_platform`,`delete_user`,`delete_date`,`cru_csvnote`,`is_erpsent`,`is_enabled`,`i`,`id`,`code_erp`,`type`,`id_tosave`,`description`,`slug`,`url_final`,`id_user`,`order_by`,`code_cache`) values (NULL,'1',NULL,'2020-09-02 15:46:46',NULL,NULL,'2020-09-08 15:22:55',NULL,NULL,NULL,NULL,'0','1',NULL,1,NULL,'post',NULL,'generic','global',NULL,NULL,200,NULL),(NULL,'1',NULL,'2020-09-02 15:47:15',NULL,NULL,'2020-09-08 15:22:58',NULL,NULL,NULL,NULL,'0','1',NULL,2,NULL,'post',NULL,'single page','sp',NULL,NULL,300,NULL),(NULL,'1',NULL,'2020-09-02 15:47:35',NULL,NULL,'2020-09-05 11:21:55',NULL,NULL,NULL,NULL,'0','1',NULL,3,NULL,'post',NULL,'PHP','php',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-02 15:47:45',NULL,NULL,'2020-09-07 13:36:55',NULL,NULL,NULL,NULL,'0','1',NULL,4,NULL,'post',NULL,'Javascript','javascript',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-02 15:47:53',NULL,NULL,'2020-09-05 11:22:11',NULL,NULL,NULL,NULL,'0','1',NULL,5,NULL,'post',NULL,'SQL','sql',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-02 15:48:21',NULL,NULL,'2020-09-05 11:22:14',NULL,NULL,NULL,NULL,'0','1',NULL,6,NULL,'post',NULL,'Docker','docker',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-05 11:21:49',NULL,NULL,'2020-09-05 11:22:32',NULL,NULL,NULL,NULL,'0','1',NULL,7,NULL,'post',NULL,'Python','python',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-06 08:08:41',NULL,NULL,'2020-09-17 14:39:07',NULL,NULL,NULL,NULL,'0','1',NULL,8,NULL,'submenu-blog',NULL,'PHP','php','/blog/php',NULL,100,NULL),(NULL,'1',NULL,'2020-09-06 08:09:02',NULL,NULL,'2020-09-17 14:42:43',NULL,NULL,NULL,NULL,'0','1',NULL,9,NULL,'submenu-blog',NULL,'Javascript','javascript','/blog/javascript',NULL,100,NULL),(NULL,'1',NULL,'2020-09-06 08:09:10',NULL,NULL,'2020-09-17 14:42:47',NULL,NULL,NULL,NULL,'0','1',NULL,10,NULL,'submenu-blog',NULL,'SQL','sql','/blog/sql',NULL,100,NULL),(NULL,'1',NULL,'2020-09-06 08:09:23',NULL,NULL,'2020-09-17 14:42:51',NULL,NULL,NULL,NULL,'0','1',NULL,11,NULL,'submenu-blog',NULL,'Docker','docker','/blog/docker',NULL,100,NULL),(NULL,'1',NULL,'2020-09-06 08:09:30',NULL,NULL,'2020-09-17 14:42:55',NULL,NULL,NULL,NULL,'0','1',NULL,12,NULL,'submenu-blog',NULL,'Python','python','/blog/python',NULL,100,NULL),(NULL,'1',NULL,'2020-09-13 16:28:09',NULL,NULL,'2020-09-17 14:43:33',NULL,NULL,NULL,NULL,'0','1',NULL,14,NULL,'submenu-service',NULL,'Convertir PDF a jpg','convertir-pdf-a-jpg','/servicios/convertir-pdf-a-jpg',NULL,100,NULL),(NULL,'1',NULL,'2020-09-16 09:23:26',NULL,NULL,'2020-09-16 09:23:26',NULL,NULL,NULL,NULL,'0','1',NULL,15,NULL,'post',NULL,'Linux','linux',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-16 09:23:59',NULL,NULL,'2020-09-17 14:43:00',NULL,NULL,NULL,NULL,'0','1',NULL,16,NULL,'submenu-blog',NULL,'Linux','slug','/blog/linux',NULL,100,NULL),(NULL,'1',NULL,'2020-09-16 09:49:30',NULL,NULL,'2020-09-16 09:50:19',NULL,NULL,NULL,NULL,'0','1',NULL,17,NULL,'post',NULL,'Modula 2','modula-2',NULL,NULL,100,NULL),(NULL,'1',NULL,'2020-09-17 13:21:05',NULL,NULL,'2020-09-17 14:45:07',NULL,NULL,NULL,NULL,'0','1',NULL,18,NULL,'post',NULL,'Visual Basic','visual-basic',NULL,NULL,100,NULL);

/*Table structure for table `app_post_comments` */

DROP TABLE IF EXISTS `app_post_comments`;

CREATE TABLE `app_post_comments` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL COMMENT 'para seo: 160 cjars',
  `id_post` int(11) DEFAULT NULL,
  `id_parent` int(11) DEFAULT NULL COMMENT 'respuesta a uno anterior',
  `name` varchar(25) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `site` varchar(150) DEFAULT NULL,
  `content` varchar(3000) DEFAULT NULL,
  `num_likes` int(5) DEFAULT NULL,
  `num_dislikes` int(5) DEFAULT NULL,
  `is_active` tinyint(4) DEFAULT 0 COMMENT 'si se ha aprobado',
  `code_cache` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `app_post_comments` */

/*Table structure for table `app_posts_tags` */

DROP TABLE IF EXISTS `app_posts_tags`;

CREATE TABLE `app_posts_tags` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `type` varchar(15) DEFAULT NULL,
  `id_tosave` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL,
  `order_by` int(5) NOT NULL DEFAULT 100,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `app_posts_tags` */

/*Table structure for table `app_tag` */

DROP TABLE IF EXISTS `app_tag`;

CREATE TABLE `app_tag` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `id_type` int(11) DEFAULT NULL,
  `description` varchar(50) DEFAULT NULL,
  `id_user` int(11) DEFAULT NULL,
  `slug` varchar(150) DEFAULT NULL COMMENT 'la descripcion en slug',
  `order_by` int(5) NOT NULL DEFAULT 100,
  `code_cache` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `app_tag` */

/*Table structure for table `app_tag_array` */

DROP TABLE IF EXISTS `app_tag_array`;

CREATE TABLE `app_tag_array` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `type` varchar(15) DEFAULT NULL,
  `id_tosave` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL,
  `slug` varchar(150) DEFAULT NULL,
  `order_by` int(5) NOT NULL DEFAULT 100,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `app_tag_array` */

/*Table structure for table `base_user` */

DROP TABLE IF EXISTS `base_user`;

CREATE TABLE `base_user` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL,
  `email` varchar(100) NOT NULL,
  `password` varchar(100) DEFAULT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `fullname` varchar(100) DEFAULT NULL,
  `address` varchar(250) DEFAULT NULL,
  `age` tinyint(4) DEFAULT NULL,
  `geo_location` varchar(500) DEFAULT NULL,
  `id_gender` int(11) DEFAULT NULL,
  `id_nationality` int(11) DEFAULT NULL,
  `id_country` int(11) DEFAULT NULL COMMENT 'app_array.type=country',
  `id_language` int(11) DEFAULT NULL COMMENT 'su idioma de preferencia',
  `path_picture` varchar(100) DEFAULT NULL,
  `id_profile` int(11) DEFAULT NULL COMMENT 'app_array.type=profile: user,maintenaince,system,enterprise, individual, client',
  `tokenreset` varchar(250) DEFAULT NULL,
  `log_attempts` int(5) DEFAULT 0,
  `rating` int(11) DEFAULT NULL COMMENT 'la puntuacion',
  `date_validated` varchar(14) DEFAULT NULL COMMENT 'cuando valido su cuenta por email',
  `is_notificable` tinyint(4) DEFAULT 0 COMMENT 'para enviar notificaciones push',
  `code_cache` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `base_user_email_uindex` (`email`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `base_user` */

/*Table structure for table `base_user_array` */

DROP TABLE IF EXISTS `base_user_array`;

CREATE TABLE `base_user_array` (
  `processflag` varchar(5) DEFAULT NULL,
  `insert_platform` varchar(3) DEFAULT '1',
  `insert_user` varchar(15) DEFAULT NULL,
  `insert_date` timestamp NOT NULL DEFAULT current_timestamp(),
  `update_platform` varchar(3) DEFAULT NULL,
  `update_user` varchar(15) DEFAULT NULL,
  `update_date` timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `delete_platform` varchar(3) DEFAULT NULL,
  `delete_user` varchar(15) DEFAULT NULL,
  `delete_date` timestamp NULL DEFAULT NULL,
  `cru_csvnote` varchar(500) DEFAULT NULL,
  `is_erpsent` varchar(3) DEFAULT '0',
  `is_enabled` varchar(3) DEFAULT '1',
  `i` int(11) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `code_erp` varchar(25) DEFAULT NULL,
  `type` varchar(15) DEFAULT NULL,
  `id_tosave` varchar(25) DEFAULT NULL,
  `description` varchar(250) DEFAULT NULL,
  `order_by` int(5) NOT NULL DEFAULT 100,
  `code_cache` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;

/*Data for the table `base_user_array` */

/*Table structure for table `failed_jobs` */

DROP TABLE IF EXISTS `failed_jobs`;

CREATE TABLE `failed_jobs` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `connection` text COLLATE utf8mb4_unicode_ci NOT NULL,
  `queue` text COLLATE utf8mb4_unicode_ci NOT NULL,
  `payload` longtext COLLATE utf8mb4_unicode_ci NOT NULL,
  `exception` longtext COLLATE utf8mb4_unicode_ci NOT NULL,
  `failed_at` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

/*Data for the table `failed_jobs` */

/*Table structure for table `imp_post` */

DROP TABLE IF EXISTS `imp_post`;

CREATE TABLE `imp_post` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `publish_date` datetime DEFAULT NULL,
  `last_update` datetime DEFAULT NULL,
  `title` varchar(500) DEFAULT NULL,
  `content` text DEFAULT NULL,
  `excerpt` varchar(1000) DEFAULT NULL,
  `id_status` varchar(100) DEFAULT NULL,
  `slug` varchar(300) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=38 DEFAULT CHARSET=utf8mb4;

/*Data for the table `imp_post` */

insert  into `imp_post`(`id`,`publish_date`,`last_update`,`title`,`content`,`excerpt`,`id_status`,`slug`) values (1,'2011-07-22 18:14:46','2011-07-22 18:14:46','Javascript - Entendiendo los eventos sobre elementos input','Como se interpretan los <strong>eventos</strong> en <strong>javascript</strong> \n\nActualmente estoy trabajando con un CRM hecho con AJAX en su totalidad (Hydra).  Llegué a un punto en el que necesitaba saber el orden de ejecución de los eventos sobre un input de tipo text (o textbox).\n\nLa lista de eventos es la siguiente: \n<ul>\n<li>onabort \n onblur \n onchange \n onclick \n ondblclick \n onerror \n onfocus \n onkeydown \n onkeypress \n onkeyup \n onload \n onmousedown \n onmousemove \n onmouseout \n onmouseover \n onmouseup \n onreset \n onselect \n onsubmit \n onunload ','','draft','javascript-entendiendo-los-eventos-sobre-elementos-input'),(2,'2013-08-04 13:51:00','2013-08-04 13:51:00','configurando_xampp','para configurar mysql en xampp: C:\\xampp\\phpMyAdmin\\config.inc.php:\n<pre>/*\n * This is needed for cookie based authentication to encrypt password in\n * cookie\n */\n$cfg[\'blowfish_secret\'] = \'xampp\'; /* YOU SHOULD CHANGE THIS FOR A MORE SECURE COOKIE AUTH! */\n\n/*\n * Servers configuration\n */\n$i = 0;\n\n/*\n * First server\n */\n$i++;\n\n/* Authentication type and info */\n$cfg[\'Servers\'][$i][\'auth_type\']            = \'config\';\n$cfg[\'Servers\'][$i][\'user\']                 = \'root\';\n$cfg[\'Servers\'][$i][\'password\']             = \'\';\n$cfg[\'Servers\'][$i][\'AllowNoPassword\']      = true;\n\n/* Server parameters */\n$cfg[\'Servers\'][$i][\'host\']             = \'localhost\';\n$cfg[\'Servers\'][$i][\'connect_type\']     = \'tcp\';\n$cfg[\'Servers\'][$i][\'compress\']         = false;\n\n/* Select mysqli if your server has it */\n$cfg[\'Servers\'][$i][\'extension\'] = \'mysqli\';\n\n/* User for advanced features */\n$cfg[\'Servers\'][$i][\'controluser\'] = \'root\';\n$cfg[\'Servers\'][$i][\'controlpass\'] = \'\';\n\n/* Advanced phpMyAdmin features */\n$cfg[\'Servers\'][$i][\'pmadb\']            = \'phpmyadmin\';\n$cfg[\'Servers\'][$i][\'bookmarktable\']    = \'pma_bookmark\';\n$cfg[\'Servers\'][$i][\'relation\']         = \'pma_relation\';\n$cfg[\'Servers\'][$i][\'table_info\']       = \'pma_table_info\';\n$cfg[\'Servers\'][$i][\'table_coords\']     = \'pma_table_coords\';\n$cfg[\'Servers\'][$i][\'pdf_pages\']        = \'pma_pdf_pages\';\n$cfg[\'Servers\'][$i][\'column_info\']      = \'pma_column_info\';\n$cfg[\'Servers\'][$i][\'history\']          = \'pma_history\';\n$cfg[\'Servers\'][$i][\'designer_coords\']  = \'pma_designer_coords\';\n\n/*\n * End of servers configuration\n */\n\n/*\n * Directories for saving/loading files from server\n */\n$cfg[\'UploadDir\']   = \'\';\n$cfg[\'SaveDir\']     = \'\';\n\n$cfg[\'AllowAnywhereRecoding\']       = true;\n$cfg[\'DefaultCharset\']              = \'utf-8\';\n$cfg[\'DefaultLang\']                 = \'en-utf-8\';\n$cfg[\'DefaultConnectionCollation\']  = \'utf8_general_ci\';\n\n$cfg[\'MySQLManualBase\'] = \'http://dev.mysql.com/doc/refman/5.1/en\';\n$cfg[\'MySQLManualType\'] = \'searchable\';</pre>\nHosts virutales en xampp:\nPrimero modificar el archivo hosts local en windows:\nc:\\WINDOWS\\System32\\drivers\\etc\\hosts\naqui añadir algo como:\n127.0.0.1 dominio.svn\n\nDespues en xampp:\nc:\\xampp\\apache\\conf\\\n* httpd.conf (archivo principal de configuración usuarios avanzados de momento no hacer nada leer documentación)\n* extra\\httpd-vhosts.conf (archivo de configuración de host virtuales)\n\nañadir algo como esto:\n\nServerAdmin eacevedof@yahoo.es\nDocumentRoot \"C:/xampp/htdocs/svn_eduardoaf.com\"\nServerName eduardoaf.svn','','draft',''),(3,'2010-08-14 10:35:18','2010-10-31 18:50:45','Puntos de vista.','Pienso en las personas que me resultan antípaticas y que me atacan y las veo a ellas y a mi como diferentes,  aunque,  ... no opuestas.  Sino comprometídas en una misma tarea, una misma danza, una misma obra de arte.\r\n\r\nContemplo la variedad de mi propía vida, con sus cambios de humor, sus altibajos y las personas que afectan a mi vida,  las malas y las buenas, las queridas y aborrecidas...\r\n\r\nMuchos movimientos de una sola danza ejecutada por un solo danzante...\r\n\r\nPor último, me pongo ante ti, y veo todas esas cosas como absurdas tus estímulos.. toda mi vida exasperante y me quede estupefacta sin comprender nada,  sumida en el asombro.\r\n\r\nRecorro el camino hasta el templo de mi corazón e invento una forma de culto que resulte acorde con el día de hoy o con mi actual estado de ánimo.\r\n\r\nEncerradas en el templo están las personas que me han transformado por medio de su amor.\r\n\r\nEscojo a una persona de cuyo amor estoy completamente segura.  Evoco los momentos en los que he sentido el amor y los revivo en laimaginacion.\r\n\r\nMe permito sentir la alegria que ocasionaria y permanezco asi el mayor tiempo posible porque al hacerlo me embebo en el amor y en la vida.\r\n\r\nDejo tambien que mi amor fluya en el interior de esa persona.  Asi, sus corrientes  se interpretan y crean entorno a nosotros una atmosfera única...\r\n\r\nY dejo que mi mente creé alguna imagen o alguna escena (tal vez mi propia historia) que simbolice el texto que mi corazón recita.\r\n\r\nCon la mirada decrubo el amor, la nectitud y la brevedad que se oculta en todo ser humano.\r\n\r\nLes observo como una extraña... y luego los miro yo tal como lo hacen para descubrir lo que ven en mi.\r\n\r\nLes veo posar su mirada en los rigurosos recaudadores de impuestos... en una mujer adultera..  y me crucifican sin más.. pero yo aprendo el arte de mirar!\r\n\r\nCuando yo miro el mal, lo llamo por su nombre y lo condeno de modo inequivoco.  Solo que alli donde ven la malicia yo veo ignorancia.\r\n\r\nby MDG.','','private','puntos-de-vista'),(4,'2010-08-13 20:59:51','2010-11-06 19:06:31','La clase de terceros FPDF','Estoy haciendo una aplicación web de facturación.  Utilizo el dueto PHP y MySQL.\r\n\r\n<a rel=\"prettyPhoto\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_lg-w582xh825.jpg\"><img class=\"alignright size-full wp-image-535\" title=\"post_generar-pdf-con-php_th-w113xh160\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_th-w113xh160.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a>Este  dueto se convirtio en un trio en el momento en que necesitaba imprimir  las facturas y/o enviarlas por email.  En este caso se me ocurrieron dos  soluciones una, la mas sencilla, utilizar una libreria (PHP) de  terceros para generar un PDF, y otra, currarme un código para imprimir  desde el formulario HTML. Esta última descartada por tiempo y porque  seguro habria que pelearse no solo con PHP sino con CSS.\r\n\r\nEl famoso google me devolvió la página <a href=\"http://www.fpdf.org/\">http://www.fpdf.org/</a>.   Instalé esta libreria (solo es subirla al servidor). Seguidamente con  ensayo y error y ayuda del manual en la misma web fui entendiendo el  comportamiento.\r\n\r\nLa verdad es que es sencilla pero potente, me recuerda mucho a una experiencia con C# y sus clases para imprimir.\r\n\r\nCuando  ya habia conseguido dominarla, saltó un problema y es que no se podian  ver los caracteres castellanos como la \"ñ, ó, ü\" en el PDF generado (ver  figura 1),  pero sin embargo se veia bien en el formulario HTML (ver  figura 2). Asi que volviendo a <a rel=\"prettyPhoto\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_lg-w743xh529.jpg\" target=\"_blank\"><img class=\"alignright size-full wp-image-535\" style=\"border: 0pt none;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_th-w225xh160.jpg\" border=\"0\" alt=\"\" width=\"180\" height=\"128\" /></a>google encontre que se podia solucionar añadiendo\r\n<pre class=\"brush: php\">$txt = utf8_decode($txt);\r\n</pre>\r\na la funcion\r\n<pre class=\"brush: php\">function Cell($w, $h=0, $txt=\'\',\r\n$border=0, $ln=0, $align=\'\', $fill=false, $link=\'\')\r\n{...}</pre>\r\nde la clase fpdf.php.\r\nEsto  en principio funcionó, digo en principio porque los datos no los estaba  recuperando desde la BD sino que los ponia directamente (tecleaba en el  PDFFactura.php) en forma de simulacion de los mismos.\r\nEl  siguiente proceso, recuperar los datos de la BD y con estos generar la  factura, me llevaria a tener que estudiar sobre los juegos de caracteres  (CHARSET), el cotejamiento (COLLATION) y como se comunicaba MySQL y la  aplicacion.\r\nBreve resumen:\r\n\r\nEl  charset viene a ser el conjunto de simbolos de un lenguaje, es decir en  español existe la \"ñ\" mientras que en ingles no ambos alfabetos son  latinos, luego el CHARSET viene a ser LATIN y el cotejamiento es la  forma de compararlos.  Si por ejemplo hacemos una peticion \"<span style=\"color: #3366ff;\"><strong>SELECT</strong></span>\" con  un order by \"Nombre_empresa\" entraria en juego el cotejamiento,  suponiendo que las empresas \"MCQ\" y \"mcq\" existen y son distintas cual  deberia ir primera en el result?.  Esto depende si el cotejamiento es:\r\n\r\n_ci: Case insensitive\r\n_cs: Case sensitive\r\n_bin: Binario\r\n\r\nNo he hecho pruebas sobre esto, pero la teoria es esa.\r\nVolviendo a mi dilema...\r\nEn el formulario web se visualizaba bien porque estoy trabajando con la directiva:\r\n<pre class=\"brush: xhtml\">\r\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" /&gt;\r\n</pre>\r\ny como mi MySQL tiene estos parametros:\r\n\r\ncharset server          Latin1\r\n\r\ncollation server        latin1_swedish_ci\r\n\r\nno generaba conflicto entre esos dos juegos (latin1 e iso-8859-1).\r\nLa secuencia era esta:\r\n\r\nLa  información de MySQL a PHP se pasa en Latin1, el PHP trabaja con UTF-8  Unicode, por eso lo recibe y los transforma a UTF-8 pero no se porque  razón (especulo que el HTML usara una funcion analoga a utfdecode pero  para Latin1) automaticamente se convertia en iso-8859-1 visualizandose  perfectamente en la web. (ver figura 2)\r\nPor lógica, debería  suceder lo mismo en el archivo PHP del PDF (PDFFactura.php), pero no era  asi. (ver figura 1) al parecer se quedaba en Latin1 y la clase fpdf.php  lo pasaba a UTF-8 pero con los caracteres desconocidos. Como no se iba a  visualizar en un HTML sino en PDF, la clase no hacia una conversion al  iso-8859-1.\r\n\r\n<a rel=\"prettyPhoto\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_lg-w564xh800.jpg\" target=\"_blank\"><img class=\"alignright size-full wp-image-535\" style=\"border: 0pt none;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/post_generar-pdf-con-php_th-w113xh1601.jpg\" border=\"0\" alt=\"\" width=\"127\" height=\"180\" /></a>\r\nLeyendo este <a href=\"http://dev.mysql.com/doc/refman/5.1/en/charset-syntax.html\">articulo</a>.  Deduje que tenia que cambiar la codificación en que me tenia que devolver la informacion MySQL.\r\nLa secuencia deberia ser esta:\r\n\r\nDe MySQL a PHP se pasa en UTF-8 (ya no en Latin1). Mi clase fpdf.php  (en PHP) la recibe correctamente puesto que PHP trabaja con UTF-8 y  cuando utilizo el metodo CELL de la clase mencionada, le aplico la  funcion utf8_decode($txt); transformado asi al iso-8859-1. que es la codificacion que usa la libreria fpdf.php.\r\nObteniendo el resultado (ver imagen 3).\r\nEl código relacionado es el siguiente:\r\n\r\nNombre archivo: PDFFactura.php\r\n<pre class=\"brush: php\">&lt;?php include ($_SERVER[\'DOCUMENT_ROOT\'].\'/proyMODULOS/config.php\'); ?&gt;\r\n&lt;?php\r\nrequire_once $_RUTARAIZ.\'Clases/fpdf.php\';//http://www.fpdf.org/\r\n?&gt;\r\n&lt;?php\r\nsession_start();\r\n\r\n$oUsuSesion=$_SESSION[\'oUsuSesion\'];\r\nif($oUsuSesion==null||!$oUsuSesion-&gt;getSesion())\r\n{\r\n   $_SESSION[\'sWarning\']=\"Debe iniciar sesión.\";\r\n   header(\'Location: ../../index.php\');\r\n   exit;\r\n}\r\nelse\r\n{\r\n    //Me conecto\r\n    $oBD = new CBaseDatos();\r\n    $bEstado=$oBD-&gt;fBoolConectar();\r\n     //Cambio la codificacion en que MySQL me enviara la informacion\r\n     //este archivo.php ya no lo recibira en LATIN1\r\n    mysql_query(\"SET NAMES utf8\");\r\n\r\n    //Recupero los datos\r\n    //La factura y sus Detalles, el Cliente\r\n    $oFactura = $_SESSION[\'oFactura\'];\r\n    $oFactura-&gt;pAtributosDesdeIDN($oBD);\r\n\r\n    //Este constructor se puede mejorar con variables por defecto!!\r\n    $oCliente=new CCliente($oFactura-&gt;getIdCliente(), null, null, null, null, null, null, null, null, null, null, null, null);\r\n    $oCliente-&gt;pAtributosDesdeIDN($oBD);\r\n\r\n    //Creo mi array con los detalles de la factura\r\n    $arDetalles=CDetalleFactura::fArTabla($oFactura-&gt;getIdFactura(), $oBD);\r\n\r\n    $sWarning=$_SESSION[\'sWarning\'];\r\n}\r\n\r\n//Heredo de la clase FPDF\r\nclass PDF extends FPDF\r\n{\r\n    //http://www.fpdf.org/\r\n    //Cabecera de página, Titulo y Logo\r\n    function Header()\r\n    {\r\n        //Arial bold 15\r\n        $this-&gt;SetFont(\'Arial\',\'B\',15);\r\n        //Logo de la empresa\r\n        $this-&gt;Image(\'../Images/LogoHoja.jpg\',137,1,74);\r\n        //Movernos a la derecha\r\n        $this-&gt;Cell(1);\r\n        //Título\r\n        $this-&gt;Cell(10,10,\'Factura nº: \',0,0,\'L\');\r\n    }\r\n\r\n    //Pie de página\r\n    function Footer()\r\n    {\r\n        //Posición: a 1,5 cm del final\r\n        $this-&gt;SetY(-15);\r\n        //Arial italic 8\r\n        $this-&gt;SetFont(\'Arial\',\'B\',8);\r\n        //Número de página\r\n        $this-&gt;Cell(0,10,\'Page \'.$this-&gt;PageNo().\'/{nb}\',0,0,\'C\');\r\n    }\r\n\r\n    //Muestra el Nº al lado de \"FACTURA nº:\"\r\n    function NFactura(CFactura $oFactura)\r\n    {\r\n        //Arial bold 15\r\n        $this-&gt;SetFont(\'Arial\',\'B\',15);\r\n        $this-&gt;Cell(20);\r\n        //Título\r\n        $this-&gt;Cell(10,10,$oFactura-&gt;getIdFactura(),0,0,\'L\');\r\n        //Salto de línea\r\n        $this-&gt;Ln(20);\r\n    }\r\n\r\n    function MiEmpresa(CFactura $oFactura)\r\n    {\r\n        $dFechaLarga=CUtils::fFechaLarga($oFactura-&gt;getFecha());\r\n        $sEmpresa=\"El nombre de tu empresa\"; //La empresa que emitira la factura\r\n        $sNIF=\"B5555555\";\r\n        $x=115;\r\n        //Arial bold 15\r\n        $this-&gt;SetFont(\'Arial\',\'B\',12);\r\n        $this-&gt;Cell($x);\r\n        $this-&gt;Cell(1,7,\'FECHA:\',20,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;SetFont(\'Arial\',\'\',12);\r\n        $this-&gt;Cell($x);\r\n        $this-&gt;Cell(1,7,$dFechaLarga,20,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;Cell($x);\r\n        $this-&gt;Cell(1,6,$sEmpresa,20,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;Cell($x);\r\n        $this-&gt;Cell(1,6,$sNIF,20,0,\'L\');\r\n        $this-&gt;Ln(20);\r\n    }\r\n\r\n    function Cliente(CCliente $oCliente)\r\n    {\r\n        $this-&gt;SetFont(\'Arial\',\'BU\',12);\r\n        $this-&gt;Cell(0,7,\'FACTURAR A:\',0,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;SetFont(\'Arial\',\'B\',12);\r\n        $this-&gt;Cell(0,7,$oCliente-&gt;getEmpresa(),0,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;SetFont(\'Arial\',\'\',12);\r\n        $this-&gt;Cell(0,7,$oCliente-&gt;getCifnif(),0,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;Cell(0,7,$oCliente-&gt;getDireccion(),0,0,\'L\');\r\n        $this-&gt;Ln();\r\n        $this-&gt;Cell(0,7,$oCliente-&gt;getCodigoPostal().\' - \'.$oCliente-&gt;getCiudad(),0,0,\'L\');\r\n        $this-&gt;Ln(20);\r\n    }\r\n\r\n    function Detalles($arDetalles)\r\n    {\r\n        $header=array(\'Concepto\',\'Cantidad\');\r\n        $this-&gt;SetFont(\'Arial\',\'B\',12);\r\n        //Anchuras de las columnas\r\n        $w=array(150,35);\r\n        //Cabeceras\r\n        for($i=0;$iCell($w[$i],7,$header[$i],1,0,\'C\');\r\n        }\r\n        $this-&gt;Ln();\r\n\r\n        $this-&gt;SetFont(\'Arial\',\'\',12);\r\n        //Datos\r\n        foreach($arDetalles as $row)\r\n        {\r\n            $this-&gt;Cell($w[0],6,$row[CONCEPTO],\'LR\');\r\n            $this-&gt;Cell($w[1],6,number_format($row[CANTIDAD],2,\',\',\'\').\' \'.chr(128),\'LR\',0,\'R\');\r\n            $this-&gt;Ln();\r\n        }\r\n\r\n        //Línea de cierre\r\n        $this-&gt;Cell(array_sum($w),0,\'\',\'T\');\r\n        $this-&gt;Ln();\r\n    }\r\n\r\n    function Totales(CFactura $oFactura)\r\n    {\r\n        $this-&gt;SetFont(\'Arial\',\'B\',12);\r\n\r\n        $arTitulos[0]=\'Subtotal: \';\r\n        $arTitulos[1]=\'Iva: \';\r\n        $arTitulos[2]=\'Total: \';\r\n\r\n        //Anchuras de las columnas\r\n        $w=array(150,35);\r\n\r\n        //Subtotal\r\n        $this-&gt;Cell($w[0],6,$arTitulos[0],\'LR\',0,\'R\');\r\n        $this-&gt;Cell($w[1],6,number_format($oFactura-&gt;getSubtotal(),2,\',\',\'\').\' \'.chr(128),\'LR\',0,\'R\');\r\n        $this-&gt;Ln();\r\n        //Iva\r\n        $this-&gt;Cell($w[0],6,$arTitulos[1],\'LR\',0,\'R\');\r\n        $this-&gt;Cell($w[1],6,number_format($oFactura-&gt;getIva(),2,\',\',\'\').\' \'.chr(128),\'LR\',0,\'R\');\r\n        $this-&gt;Ln();\r\n        //Total\r\n        $this-&gt;Cell($w[0],6,$arTitulos[2],\'LR\',0,\'R\');\r\n        $this-&gt;Cell($w[1],6,number_format($oFactura-&gt;getTotal(),2,\',\',\'\').\' \'.chr(128),\'LR\',0,\'R\');\r\n        $this-&gt;Ln();\r\n\r\n        //Línea de cierre\r\n        $this-&gt;Cell(array_sum($w),0,\'\',\'T\');\r\n    }\r\n\r\n}\r\n\r\n//Creación del objeto de la clase heredada\r\n$pdf=new PDF();\r\n$pdf-&gt;Header($oFactura);\r\n\r\n//Muestra numero de paginas en el pie\r\n$pdf-&gt;AliasNbPages();\r\n//Creo pagina sobre la que diburjare\r\n$pdf-&gt;AddPage();\r\n\r\n$pdf-&gt;NFactura($oFactura);\r\n//Creo los datos de la empresa emisora\r\n$pdf-&gt;MiEmpresa($oFactura);\r\n$pdf-&gt;Ln(10);\r\n//Creo el cliente\r\n$pdf-&gt;Cliente($oCliente);\r\n//Creo los detalles\r\n$pdf-&gt;Detalles($arDetalles);\r\n//Creo los totales\r\n$pdf-&gt;Totales($oFactura);\r\n\r\n$pdf-&gt;Output();\r\n?&gt;</pre>','Explicación detallada de como generar un pdf utilizando la clase FPDF para php.\r\n\r\nGenerar un pdf con php.','publish','la-clase-de-terceros-fpdf'),(5,'2010-08-13 21:48:47','2010-12-16 23:23:05','Clase con funciones sencillas e imprescindibles (CUtils.cs)','Ésta es la clase con funciones genéricas que suelo utilizar en mis proyectos en C#.\r\n\r\nSe divide en los siguientes espacios:\r\n\r\n<strong><span style=\"color: #0000ff;\">NSUtils </span></strong>&lt;--contenedor de los restantes (Base)\r\n\r\n<strong><span style=\"color: #0000ff;\">NSBase </span></strong>&lt;-- cuenta con operaciones sobre los tipos básicos y controles mas comunes de un formulario windows\r\n\r\n<strong><span style=\"color: #0000ff;\">NSDatagrid </span></strong>&lt;-- cuenta con operaciones sobre controles Dtagridview y sus componentes, columnas, filas etc..\r\n\r\n<strong><span style=\"color: #0000ff;\">NSBusqueda </span></strong>&lt;-- cuenta con operaciones especiales de busqueda y creacion de reportes\r\n\r\n<strong><span style=\"color: #0000ff;\">NSGestoresEventos</span></strong>&lt;-- Este es un espacio que creé para experimentar con delegados y controladores de eventos.\r\n\r\n<pre class=\"brush: csharp\">\r\nusing System;\r\nusing System.Collections;\r\nusing System.Collections.Generic;\r\nusing System.ComponentModel;\r\nusing System.Drawing;\r\nusing System.Text;\r\nusing System.Windows.Forms;</code>\r\n\r\n#region Espacios Datos\r\n\r\n//Datos OleDB\r\nusing System.Data;\r\nusing System.Data.OleDb;\r\n//Mysql\r\nusing MySql.Data.MySqlClient;\r\nusing MySql.Data.Types;\r\n\r\n//Para trabajar con CURRENCY\r\nusing System.Globalization;\r\n\r\n#endregion\r\n\r\n//MIS LINKS:\r\n//Tecla intro http://www.elguille.info/NET/dotnet/pulsarTeclas.htm relacionado con fIsNumeric\r\n\r\n#region Notas\r\n//STATIC: Compartidos. Pag114, vida de una variable. Se mantiene durante todo el programa. No se\r\n//        destruye.  Permite compartir la var/proc con las clases internas.\r\n//PUBLIC (c,v,p):   Son completamente accesibles, incluso desde otros ensamblados\r\n//INTERNAL(c,v,p):  Accesibles para todas las clases pero siempre que sean del mismo ensamblado\r\n//PRIVATE (c,v,p):  Solo accesibles dentro del ambito donde se encuentran. NO son HEREDABLES en el caso de \"c\"\r\n//PROTECTED(v,p):   Accesible dentro de la propia clase y las derivadas de ella.\r\n//\r\n//*En un procedimiento y/o funcion el argumento conexion siempre se pone al final\r\n//struct: Pag 122\r\n//enum: Pag 117\r\n//operadores logicos: Pag 144\r\n//NOTA sobre Clases: Para llamar a atributos (variables) de una clase no hace falta\r\n//crear el objeto pero si para sus metodos/funciones\r\n//\r\n#endregion\r\n\r\nnamespace NSUtils\r\n{\r\n\r\n#region NSBase\r\nnamespace NSBase\r\n{\r\n///\r\n/// Clase con mis tipos predefinidos\r\n/// enum Navega { Neutro, Inicio, Anterior, Siguiente, Final }\r\n/// enum Menu(Neutro,Nuevo,Modificar,Borrar,Duplicar), Opcion(Neutro, Aceptar, Cancelar)\r\n///\r\npublic static class CTipos\r\n{\r\npublic static Label lblAviso = new Label();\r\n//Tiene relacion con los botones del panel Navega\r\npublic enum Navega { Neutro, Inicio, Anterior, Siguiente, Final };\r\n//Son las distintas opciones que se puede hacer con un registro\r\npublic enum Menu { Neutro, Nuevo, Modificar, Borrar, Duplicar };\r\n//Son las opciones de confirmacion, sirven para guardar el estado\r\npublic enum Opcion { Neutro, Aceptar, Cancelar }\r\n\r\n}//FIN CLASE clsTipos\r\n\r\n///\r\n/// Clase con todos los metodos generales\r\n///\r\npublic static class CAccionBase\r\n{\r\n//Hay Acciones que usan funciones en CFuncion por eso necesito esta variable\r\n//private CFuncion CFuncion;\r\n\r\n///\r\n///HACE: BLOQUEA todos los controles dentro de un panel siempre y cuando no\r\n///sean Label o Button\r\n///SE USA: por ejemplo al cargar un formulario o al agregar, editar un registro.\r\n///\r\n///\r\nSi se bloqueara o no el/los controles que tiene el panel             ///\r\nEl control tipo Panel donde se realizara el bloqueo o desbloqueo             public static void desbloquea_controles(bool bBloquea, Panel oPanel)\r\n{\r\ntry\r\n{\r\nif (!bBloquea)\r\n{\r\nforeach (Control pCntrl in oPanel.Controls)\r\n{\r\n//¬(a v b)= ¬a ^ ¬b, si es lbl o boton se bloquean\r\nif (!((pCntrl is Label) || (pCntrl is Button)))\r\n{\r\npCntrl.Enabled = false;\r\npCntrl.BackColor = Color.Beige;\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nforeach (Control pCntrl in oPanel.Controls)\r\n{\r\nif ((pCntrl is ComboBox) || (pCntrl is TextBox) || (pCntrl is DateTimePicker))\r\n{\r\npCntrl.Enabled = true;\r\npCntrl.BackColor = Color.White;\r\n}\r\n}\r\n}\r\n\r\n}\r\ncatch (Exception e)\r\n{\r\n\r\nCTipos.lblAviso.Text = \" Error:pBloqueaCampos() \" + e.ToString();\r\n}\r\n\r\n}//FIN DE BLOQUEA CAMPOS\r\n\r\n///\r\n///HACE: ASIGNA a los textbox y el label de \"ID\" el caracter vacio.\r\n///SE USA: Al crear un nuevo registro, lo mejor es sustituirlo por uno de valores por defecto.\r\n///\r\n///\r\nEl nombre de la etiqueta labelID q sera limpiada             ///\r\nEl control tipo Panel donde se realiazara esta asigancion             public static void inserta_blancos(string sNomEtiqueta, Panel oPanel)\r\n{\r\nforeach (Control oControl in oPanel.Controls)\r\n{\r\nif (oControl is TextBox)\r\n{\r\noControl.Text = \"\";\r\n}\r\nif ((oControl is Label) &amp;&amp; (oControl.Name == sNomEtiqueta))\r\n{\r\noControl.Text = \"\";\r\n}\r\n}\r\n}//Fin LimpiaText\r\n\r\n///\r\n///HACE: LLENA desde una sentencia SQL un array\r\n///SE USA: Por ejemplo para pedir todos los paises en la BD y guardarlo en un array\r\n///\r\n///\r\nLa sentencia SELECT completa con un solo campo              ///\r\nEste parametro es solo para saber sobre que tabla se hace el SELECT             ///\r\nEl Array en el que se llenarn los datos             ///\r\nLa conexion a la base de datos             public static void sql_a_array(string sSQL, string sNombreTabla, ref string[] sArLista, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset = new DataSet();\r\n//El objeto es el contenido de una celda (FilaI,ColumnaJ)\r\nobject oAuxObjeto;\r\nint iNumPaises;\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, sNombreTabla);\r\n\r\niNumPaises = oDataset.Tables[sNombreTabla].Rows.Count;\r\nsArLista = new string[iNumPaises];\r\n\r\nfor (int i = 0; i &lt; iNumPaises; i++)\r\n{\r\n//La columna siempre es 0 es decir la primera\r\noAuxObjeto = oDataset.Tables[sNombreTabla].Rows[i][0];\r\nsArLista[i] = CFuncionBase.valor_de_celda_sin_null(oAuxObjeto);\r\n}\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" Error:pSqlaArray()\" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n/// HACE: LLENA desde una sentencia SQL un array\r\n/// SE USA: Por ejemplo para pedir todos los paises en la BD y guardarlo en un array\r\n///\r\n///\r\n///\r\n///\r\npublic static void sql_a_array(string sSQL, ref string[] sArLista, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset = new DataSet();\r\n//El objeto es el contenido de una celda (FilaI,ColumnaJ)\r\nobject oAuxObjeto;\r\nint iNumPaises;\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"RESULTADOS\");\r\n\r\niNumPaises = oDataset.Tables[\"RESULTADOS\"].Rows.Count;\r\nsArLista = new string[iNumPaises];\r\n\r\nfor (int i = 0; i &lt; iNumPaises; i++)\r\n{\r\n//La columna siempre es 0 es decir la primera\r\noAuxObjeto = oDataset.Tables[\"RESULTADOS\"].Rows[i][0];\r\nsArLista[i] = CFuncionBase.valor_de_celda_sin_null(oAuxObjeto);\r\n}\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" Error:pSqlaArray()\" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: LLENA un control COMBOBOX  con un array de tipo string\r\n///SE USA: Por ejemplo para llenar los paises y sus ciudades en un combo\r\n///\r\n///\r\nEl Array con los valores que se pasaran al ComboBox             ///\r\npublic static void array_a_combobox(string[] sArValores, ref ComboBox oCombo)\r\n{\r\nint iNumValores;\r\ntry\r\n{\r\niNumValores = sArValores.Length;\r\n//Se limpia el combo\r\noCombo.Items.Clear();\r\nfor (int i = 0; i &lt; iNumValores; i++)\r\n{\r\noCombo.Items.Add(sArValores[i]);\r\n}\r\noCombo.SelectedIndex = 0;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"Error:pArrayaCombo() \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: ACTUALIZA el registro en que se encuentra al presionar los botones de navegacion\r\n///SE USA: En los eventos de los botones de navegacion, solo en los FORMS q no usen tablas\r\n///\r\n///\r\nSi es Inicio, Anterior, Siguiente, Final             ///\r\nSe usa para comprobar que se llego al final del recorrido             ///\r\nVariable a ser modificada cRegActual             public static void navega_por_registros(CTipos.Navega tOpcion, int iNumRegs, ref int iRegActual)\r\n{\r\ntry\r\n{\r\nswitch (tOpcion)\r\n{\r\ncase CTipos.Navega.Anterior:\r\nif (iRegActual &gt; 0)\r\n{\r\niRegActual--;\r\n}\r\nelse\r\n{\r\niRegActual = 0;\r\n}\r\nbreak;\r\ncase CTipos.Navega.Siguiente:\r\nif (iRegActual &lt; (iNumRegs - 1))\r\n{\r\niRegActual++;\r\n}\r\nelse\r\n{\r\niRegActual = iNumRegs - 1;\r\n}\r\n\r\nbreak;\r\ncase CTipos.Navega.Inicio:\r\nif (tOpcion == CTipos.Navega.Inicio)\r\n{\r\niRegActual = 0;\r\n}\r\nbreak;\r\ncase CTipos.Navega.Final:\r\nif (tOpcion == CTipos.Navega.Final)\r\n{\r\niRegActual = iNumRegs - 1;\r\n}\r\nbreak;\r\ndefault:\r\nCTipos.lblAviso.Text = \"\";\r\nCTipos.lblAviso.Text = \"No se asigno |&lt; &lt;&lt; &gt;&gt; &gt;|\";\r\nbreak;\r\n}\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" Error:pNavegaRegistros()\" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: BORRA un unico registro pasandole directamente un SQL con DELETE.\r\n///SE USA: Al presionar el boton ACEPTAR, en el procedimiento ACEPTAR_ELIMINAR\r\n///\r\n///\r\nEl string completo DELETE FROM cNomTabla WHERE ID..             ///\r\npublic static void sql_elimina_registro(string sSQL, OleDbConnection oConx)\r\n{\r\nOleDbCommand oComando;\r\ntry\r\n{\r\noComando = new OleDbCommand(sSQL, oConx);\r\noComando.ExecuteNonQuery();\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"ERROR: oEventlimaRegistro() \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: BORRA uno o varios registros desde un SQL con DELETE unido al Array de IDS\r\n///ejemplo: \"DELETE FROM cNomTabla WHERE IDPROV=\'\" + ArIDS[i] +\"\'\";\r\n///SE USA: Normalmente para borrar en grupo desde un DATAGRIDVIEW\r\n///\r\n///\r\n\"DELETE FROM cNomTabla WHERE ID=\'\"             ///\r\nEl Array con todos los IDS de los registros que se borraran             ///\r\npublic static void sql_elimina_registros(string sSQL, string[] sArIds, OleDbConnection oConx)\r\n{\r\nOleDbCommand oComando;\r\nstring sSQLCompleto;\r\n\r\nfor (int i = 0; i &lt; sArIds.Length; i++)\r\n{\r\nsSQLCompleto = sSQL + sArIds[i] + \"\'\";\r\ntry\r\n{\r\noComando = new OleDbCommand(sSQLCompleto, oConx);\r\noComando.ExecuteNonQuery();\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" ERROR oEventliminaRegistrosDesdeArray(): \" + e.ToString());\r\n}\r\n}\r\n}\r\n\r\n///\r\n/// HACE: ACTUALIZA un dataset cualquiera con un SQL leido\r\n/// SE USA: Por ejemplo en el form SQL\r\n///\r\n///\r\n///\r\n///\r\npublic static void sql_llena_dataset(string sSQL, ref DataSet oDataset, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\noDataset = new DataSet();     //Limpio el DATASET\r\n\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"tabla\");\r\n}\r\ncatch (Exception e)\r\n{\r\ne.ToString();\r\n}\r\n}\r\n\r\npublic static void sql_llena_dataset(string sSQL, string sNombre, ref DataSet oDataset, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\noDataset = new DataSet();\r\n\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, sNombre);\r\n}\r\ncatch (Exception e)\r\n{\r\ne.ToString();\r\n}\r\n}\r\n\r\n///\r\n///HACE: ACTUALIZA un cDataset y el cNumRegs de una clase, usando un SELECT * by idn\r\n///SE USA: Al ejecutar el constructor de una clase. usar en lugar de cBDataset()\r\n///\r\n///\r\nLa tabla sobre la cual se hara el SELECT             ///\r\nVariable de clase cNumRegs             ///\r\nEl Dataset de clase cDataset             ///\r\npublic static void llena_dataset_con_todos(string sNombreTabla, ref int iNumRegs, ref DataSet oDataset, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nstring sSQL;\r\n\r\noDataset = new DataSet();     //Limpio el DATASET\r\n\r\nsSQL = \"SELECT * FROM \" + sNombreTabla + \" ORDER BY idn\";\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, sNombreTabla);\r\n//Actualizo el numero de registros en caso de DELETE E INSERT\r\niNumRegs = oDataset.Tables[sNombreTabla].Rows.Count;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"ERROR en pActualizaDataSetGeneral(): \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: ACTUALIZA un cDataset de una clase, usando un SELECT * by idn\r\n///SE USA: Al ACEPTAR NUEVO en lugar de cDataset=oDataset;\r\n///\r\n///\r\nLa tabla sobre la cual se hara el SELECT             ///\r\nEl Dataset de clase cDataset             ///\r\npublic static void llena_dataset_con_todos(string sNombreTabla, ref DataSet oDataset, CBaseDatos oBD)\r\n{\r\nMySqlDataAdapter oAdaptador;\r\nstring sSQL;\r\n\r\noDataset = new DataSet();     //Limpio el DATASET\r\n\r\nsSQL = \"SELECT * FROM \" + sNombreTabla + \" ORDER BY idn\";\r\ntry\r\n{\r\noAdaptador = new MySqlDataAdapter(sSQL, oBD.oConn);\r\noAdaptador.Fill(oDataset, sNombreTabla);\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"ERROR en llena_dataset_con_todos(): \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///NOTA: clase Hibrida: Formulario con un panel de controles y otro con un datagridview\r\n///HACE: ACTUALIZA un cDataset y el cNumRegs de una clase Hibrida.\r\n///SE USA: Al ejecutar el constructor de una clase. usar en lugar de cBDataset()\r\n///\r\n///\r\nSELECT completo by idn             ///\r\ncNumRegs             ///\r\ncDataset             ///\r\npublic static void llena_dataset_con_todos_hibrido(string sSQL, ref int iNumRegs, ref DataSet oDataset, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\noDataset = new DataSet();     //Limpio el DATASET\r\n\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"tabla\");\r\n//Actualizo el numero de registros en caso de DELETE E INSERT\r\niNumRegs = oDataset.Tables[\"tabla\"].Rows.Count;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"ERROR en llena_dataset_con_todos_hibrido(): \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n///HACE: BUSCA y deja SELECCIONADO un item dentro de un COMBOBOX\r\n///SE USA: Al editar un registro, se hace un resguardo y este se busca para dejarlo\r\n///seleccionado\r\n///\r\n///\r\nEl valor que se buscara en la lista de items del ComboBox             ///\r\nEl ComboBox donde se buscara y se dejara seleccionado ese valor             public static void autoselecciona_item_en_combo(string sABuscar, ref ComboBox oComboBox)\r\n{\r\nbool isFound;\r\nint j, iNumItems;\r\n\r\niNumItems = oComboBox.Items.Count;\r\ntry\r\n{\r\nif (iNumItems &gt; 0)\r\n{\r\nj = 0; isFound = false;\r\nwhile ((j &lt; iNumItems) &amp;&amp; (!isFound))\r\n{\r\noComboBox.SelectedIndex = j;\r\nif (sABuscar == oComboBox.SelectedItem.ToString())\r\n{\r\noComboBox.SelectedIndex = j;\r\nisFound = true;\r\n}\r\nelse\r\n{\r\nj++;\r\n}\r\n}\r\nif (!isFound)\r\n{\r\nMessageBox.Show(\"VALOR NO ENCONTRADO SE ASIGNARA EL PRIMERO DE LA LISTA!!\");\r\noComboBox.SelectedIndex = 0;\r\n}\r\n}\r\nelse\r\n{\r\nMessageBox.Show(oComboBox.Name.ToString() + \" esta vacio\");\r\n}\r\n\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\"ERROR en pBuscaUnItemYloSelecciona(): \" + e.ToString());\r\n}\r\n}\r\n\r\n///\r\n/// HACE: CONVIERTE a mayusculas el texto que se va introduciendo en un TEXTBOX\r\n/// SE USA: En el evento TextChanged de un TEXTBOX\r\n///\r\n///\r\npublic static void a_mayusculas(ref KeyPressEventArgs oEvent)\r\n{\r\noEvent.KeyChar = char.ToUpper(oEvent.KeyChar);\r\n}\r\n\r\n///\r\n/// HACE: EVALUA los caracteres que se van introduciendo en TEXTBOX\r\n/// SE USA: En evento KEYPRESS de un TEXTBOX\r\n///\r\n///\r\nKeyPressEventArgs             public static void valida_chars_telefono(ref KeyPressEventArgs oEvent)\r\n{\r\n//TODO puedo crear una lista de caracters validos\r\nif (((oEvent.KeyChar &gt;= \'0\') &amp;&amp; (oEvent.KeyChar &lt;= \'9\')) || (oEvent.KeyChar == \'+\') || (oEvent.KeyChar == \' \') || (oEvent.KeyChar == \'-\') || (oEvent.KeyChar == \'\\r\') || (oEvent.KeyChar == \'\\b\'))\r\n{\r\n\r\n}\r\nelse\r\n{\r\noEvent.Handled = true;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: OCULTA un grupo de Pestañas, excepto la seleccionada\r\n/// SE USA: Al realizar alguna accion NUEVO, ELIMINAR, DUPLICAR.. en\r\n/// un FORMULARIO HIBRIDO\r\n///\r\n///\r\nEs el Array de Pestañas guardado al comienzo             public static void oculta_pestanas(TabPage[] oArTabPages, TabControl oTabControl)\r\n{\r\nint iNumTabs;\r\nint iIndex;\r\n\r\niIndex = oTabControl.SelectedIndex;\r\niNumTabs = oTabControl.TabCount;\r\n\r\nfor (int i = 0; i &lt; iNumTabs; i++)\r\n{\r\nif (i != iIndex)\r\n{\r\noTabControl.TabPages.Remove(oArTabPages[i]);\r\n}\r\n}\r\n}\r\n\r\n}//FIN CLASE CAccionBase\r\n\r\n///\r\n///Clase que tiene exclusivamente Funciones Globales\r\n///\r\npublic static class CFuncionBase\r\n{\r\n///\r\n/// Devuelve el RadioButton.text que esta marcado\r\n///\r\n///\r\n///\r\npublic static string valor_radiobutton_seleccionado(GroupBox oGroupBox)\r\n{\r\n//RadioButton oCtrl = new RadioButton();\r\nforeach (RadioButton oRadioButton in oGroupBox.Controls)\r\n{\r\nif (oRadioButton.Checked)\r\n{\r\nreturn oRadioButton.Text;\r\n}\r\n}\r\nreturn \"\";\r\n}\r\n\r\n///\r\n///HACE: DEVUELVE un unico valor dependiendo del SELECT exclusivo, es decir\r\n///que se basa en un ID ejemplo: select Nombre from 26Paises where IDPAIS=valor\r\n///SE USA: Al llenar el equivalente, por ejemplo el dato: \"NOMBRE\", de un ID para posteriormente\r\n///ser mostrado.\r\n///\r\n///\r\n\"SELECT UnCampo FROM UnaTabla WHERE ID=Valor\"             ///\r\n/// UnUnicoValor o sino existe \"SIN ASIGNAR\"\r\npublic static string valor_de_un_campo(string sSQL, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset = new DataSet();\r\n\r\n//Es el unico valor que sera devuelto\r\nstring sResultado;\r\n\r\ntry\r\n{\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"tabla\");\r\n\r\nif (oDataset != null)\r\n{\r\n//El nombre de la tabla sera igual al nombre del campo devuelto\r\nsResultado = oDataset.Tables[\"tabla\"].Rows[0][0].ToString();\r\n}\r\nelse\r\n{\r\nsResultado = \"NEX\";\r\n}\r\nreturn sResultado;\r\n\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" Error:fDevuelveUnUnicoValor() \" + e.ToString());\r\nreturn \"Se ejecuto Exeption\";\r\n}\r\n\r\n}\r\n\r\n///\r\n///HACE:  DEVUELVE un valor tipo string despues de verificar una celda en un grid o dataset\r\n///para q no sea null algo que da muchos problemas\r\n///SE USA: Al pasar de celdas a estructuras.\r\n///\r\n///\r\nTabla.Rows.Columna             /// Si es null=&gt;\"SIN ASIGNAR\" sino objCelda.ToString()\r\npublic static string valor_de_celda_sin_null(object objCelda)\r\n{\r\n\r\n//Toda celda es de tipo object y tiene tres estados no determinado=null,\r\n//vacia=\"\" y llena=\"sdf algo\"\r\ntry\r\n{\r\nif (objCelda == null)//Si la celda esta vacia\r\n{\r\nreturn \"SIN ASIGNAR\";\r\n}\r\nelse\r\n{\r\nreturn objCelda.ToString();\r\n}\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" Error:valor_de_celda_sin_null()\" + e.ToString());\r\nreturn \"Se ejecuto Exception\";\r\n}\r\n}\r\n///\r\n/// Devuelve false si el estado del DgvCell es null o false\r\n/// sino devuelve true\r\n///\r\n///\r\nLa celda a verificar             /// true o false\r\npublic static bool isChecked(DataGridViewCell oDgvCell)\r\n{\r\ntry\r\n{\r\nif (oDgvCell is DataGridViewCheckBoxCell)\r\n{\r\nif ((oDgvCell == null) || (oDgvCell.Value.ToString() == \"false\"))\r\n{\r\nreturn false;\r\n}\r\nelse\r\n{\r\nreturn true;\r\n}\r\n}\r\nreturn false;\r\n}\r\ncatch\r\n{\r\nreturn false;\r\n}\r\n}\r\n\r\n///\r\n///TODO si se comienza en 000000 dar un error pq se comienza a leer desde 1\r\n///es decir no se cuenta con esta existencia el rango es de [1-n]\r\n///Al crear nuevo registro este p asigna la ID nueva\r\n///\r\n///\r\nEjemplo: Para pagos PAG             ///\r\nIDPAGO             ///\r\nNºPAGOS             ///\r\n///\r\npublic static string calcula_id(string sPrefijoId, string sNombreCampoId, string sNombreTabla, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset = new DataSet();\r\nbool isFound;\r\nobject objAuxCelda;  //Celda a comprobar si es NULL\r\nstring sSQL;  //Select q dvulve tbla con una columna\r\nstring sIdObtenido; //El valor q le corresponde al ID\r\nstring sAux;     //Dspues d comprobar NULL se guarda l contnido\r\nint iNumRegs;       //La cantidad de registros en la tabla\r\nint iNumCaracteresId;   //El numero de carac de los q se compone el ID\r\nint j, iAux;      //j=Indice para recorrer con While iAux:para hacer calculos\r\nint[] iArNumerosId; //Matriz con los valores numericos de los IDS\r\n\r\ntry\r\n{\r\nsSQL = \"SELECT \" + sNombreCampoId + \" FROM \" + sNombreTabla + \" ORDER BY \" + sNombreCampoId;\r\n\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"lista_ids\");\r\nobjAuxCelda = oDataset.Tables[\"lista_ids\"];\r\nif (objAuxCelda != null)\r\n{\r\niNumRegs = oDataset.Tables[\"lista_ids\"].Rows.Count;\r\niArNumerosId = new int[iNumRegs];\r\nsAux = \"\";\r\n//Pasamos a Entero quitando los 0\'s y lo guardamos en una matriz los IDS\r\nfor (int i = 0; i &lt; iNumRegs; i++)\r\n{\r\nobjAuxCelda = oDataset.Tables[\"lista_ids\"].Rows[i][0];\r\nsAux = objAuxCelda.ToString();\r\nsAux = sAux.Remove(0, sPrefijoId.Length);\r\niArNumerosId[i] = int.Parse(sAux);\r\n}\r\n//numero de caracteres de los que se compone el ID\r\niNumCaracteresId = sAux.Length;\r\nj = 0; sIdObtenido = \"\"; iAux = 0;\r\nisFound = false;\r\nwhile (!isFound)\r\n{\r\nif (j + 1 != iArNumerosId[j])\r\n{\r\nsIdObtenido = (j + 1).ToString();\r\nisFound = true;\r\n}\r\nelse if (j + 1 == iNumRegs)\r\n{\r\niAux = j + 2;\r\nsIdObtenido = iAux.ToString();\r\nisFound = true;\r\n}\r\nj++;\r\n}\r\nif (sIdObtenido.Length &lt; iNumCaracteresId)\r\n{\r\niAux = (iNumCaracteresId - sIdObtenido.Length);\r\nfor (int i = 0; i &lt; iAux; i++)\r\n{\r\nsIdObtenido = \"0\" + sIdObtenido;\r\n}\r\n}\r\nsIdObtenido = sPrefijoId + sIdObtenido;\r\nreturn sIdObtenido;\r\n}\r\nelse\r\n{\r\nsIdObtenido = \"ERROR EN LA OBTENCION DEL ID\";\r\nNSBase.CTipos.lblAviso.Text = sIdObtenido;\r\nreturn sIdObtenido;\r\n}\r\n}\r\ncatch (ArgumentOutOfRangeException e)\r\n{\r\nreturn MessageBox.Show(e.ToString()).ToString();\r\n}\r\n\r\n}\r\n\r\n///\r\n/// HACE: CALCULA el ID que le corresponde a un nuevo registro\r\n/// SE USA: Al crear un nuevo registro\r\n///\r\n///\r\n///\r\n///\r\n///\r\n///\r\n///\r\npublic static string calcula_id(string sNomTabla, string sNomCampoId, string sPrefijoId, int iNumDigitosNumeros, OleDbConnection oConx)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset = new DataSet();\r\nbool isFound;\r\nobject objAuxCelda;  //Celda a comprobar si es NULL\r\nstring sSQL;  //Select q dvulve tbla con una columna\r\nstring sIdObtenido; //El valor q le corresponde al ID\r\nstring sAux;     //Dspues d comprobar NULL se guarda l contnido\r\nint iNumRegs;       //La cantidad de registros en la tabla\r\nint j, iAux;      //j=Indice para recorrer con While iAux:para hacer calculos\r\nint[] iArNumerosId; //Matriz con los valores numericos de los IDS\r\n\r\ntry\r\n{\r\nsSQL = \"SELECT \" + sNomCampoId + \" FROM \" + sNomTabla + \" ORDER BY \" + sNomCampoId;\r\n\r\noAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\noAdaptador.Fill(oDataset, \"lista_ids\");\r\nobjAuxCelda = oDataset.Tables[\"lista_ids\"];\r\niNumRegs = oDataset.Tables[\"lista_ids\"].Rows.Count;\r\n\r\nif (iNumRegs &gt; 0)\r\n{\r\n//Array de tamaño igual a la cantidad de registros\r\niArNumerosId = new int[iNumRegs];\r\n//Para guardar el IDCOMPLETO y seguidamente el IDSINPREFIJO\r\nsAux = \"\";\r\n\r\n//GUARDA LOS IDS EXISTENTES EN EL ARRAY\r\nfor (int i = 0; i &lt; iNumRegs; i++)                         {                             objAuxCelda = oDataset.Tables[\"lista_ids\"].Rows[i][0];                             sAux = objAuxCelda.ToString();                             sAux = sAux.Remove(0, sPrefijoId.Length);                             iArNumerosId[i] = int.Parse(sAux);                         }                         //SI TODO ESTA ORDENADO SE DEBE CUMPLIR QUE AR[j]=0..0j=&gt;AR[j]=j\r\n//si no hay una concidencia se ejecutara el if\r\n//si se respeta la concidencia hasta el final se ejecutara el if\r\n\r\n//j Indicie para recorrer el array\r\n//iAux Guarda el Numero que le correspondera al ID\r\n//sIdObtenido Guarda el iAux en formato string\r\nj = 0; sIdObtenido = \"\"; iAux = 0;\r\nisFound = false;\r\n\r\nwhile (!isFound)\r\n{\r\n//Si no coinciden\r\nif (j != iArNumerosId[j])\r\n{\r\niAux = j;\r\nisFound = true;\r\n}\r\n//Si coinciden y se llega al final\r\nelse if (j + 1 == iNumRegs)\r\n{\r\niAux = j + 1;\r\nisFound = true;\r\n}\r\nj++;\r\n}\r\n\r\nsIdObtenido = iAux.ToString();\r\n\r\n//iAux Guarda la cantidad de digitos numericos faltantes\r\n//que se llenaran con 0`s\r\nif (sIdObtenido.Length &lt; iNumDigitosNumeros)\r\n{\r\niAux = (iNumDigitosNumeros - sIdObtenido.Length);\r\nfor (int i = 0; i &lt; iAux; i++)\r\n{\r\nsIdObtenido = \"0\" + sIdObtenido;\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nsIdObtenido = \"\";\r\nfor (int i = 0; i &lt; iNumDigitosNumeros; i++)\r\n{\r\nsIdObtenido = sIdObtenido + \"0\";\r\n}\r\n}\r\nsIdObtenido = sPrefijoId + sIdObtenido;\r\nreturn sIdObtenido;\r\n}\r\ncatch (ArgumentOutOfRangeException e)\r\n{\r\nreturn MessageBox.Show(e.ToString()).ToString();\r\n}\r\n\r\n}\r\n\r\n///\r\n///HACE: DEVUELVE true o false dependiendo si una cadena completa es un numero entero o no\r\n///SE USA: Al buscar si se presiona una tecla, para verificar que lo que se inserta es un\r\n///numero entero bien formado.\r\n///\r\n///\r\nEl string a comprobar             /// Si existe algun caracter no numerico devuelve false\r\npublic static bool isNumerico(string sAComprobar)\r\n{\r\nforeach (char cChar in sAComprobar)\r\n{\r\nif (!Char.IsNumber(cChar))\r\n{\r\nreturn false;\r\n}\r\n}\r\nreturn true;\r\n}\r\n\r\n///\r\n/// Segun un SQL se sabe si devuelve registros o no\r\n///\r\n///\r\n///\r\n///\r\npublic static bool isInTable(string sSQL, OleDbConnection oConx)\r\n{\r\nOleDbCommand oComando = new OleDbCommand(sSQL, oConx);\r\nOleDbDataReader oLector;\r\noLector = oComando.ExecuteReader();\r\n\r\nif (oLector.HasRows)\r\n{\r\noLector.Close();\r\nreturn true;\r\n}\r\nelse\r\n{\r\noLector.Close();\r\nreturn false;\r\n}\r\n}\r\n\r\n///\r\n///HACE: DEVUELVE true o false dependiendo si existe o no un RegistroID en una tabla, el usa un\r\n///select exclusivo concatenando los argumentos.\r\n///SE USA: Despues de agregar un registro dentro de un while para verificar que se ha actualizado\r\n///en la BD\r\n///\r\n///\r\nLa tabla donde se buscara el registro             ///\r\nEl nombre del campo de ID             ///\r\nEl ID             ///\r\n///\r\npublic static bool isInTable(string sNomTabla, string sNomCampo, string sId, OleDbConnection oConx)\r\n{\r\nstring sSQL = \"SELECT * FROM \" + sNomTabla +\r\n\" WHERE \" + sNomCampo + \"=\'\" + sId + \"\'\";\r\nOleDbCommand oComando = new OleDbCommand(sSQL, oConx);\r\nOleDbDataReader oLector;\r\noLector = oComando.ExecuteReader();\r\n\r\nif (oLector.HasRows)\r\n{\r\noLector.Close();\r\nreturn true;\r\n}\r\nelse\r\n{\r\noLector.Close();\r\nreturn false;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: DEVUELVE true o false dependiendo si existe o no un RegistroID en una tabla, el usa un\r\n/// select exclusivo concatenando los argumentos.\r\n/// SE USA: Despues de agregar un registro dentro de un while para verificar que se ha actualizado\r\n/// en la BD\r\n///\r\n///\r\n\"SELECT * FROM tabla WHERE campo_id=\'\"             ///\r\n///\r\n///\r\npublic static bool isInTable(string sSQL, string sId, OleDbConnection oConx)\r\n{\r\nsSQL = sSQL + sId + \"\'\";\r\nOleDbCommand oComando = new OleDbCommand(sSQL, oConx);\r\nOleDbDataReader oLector;\r\noLector = oComando.ExecuteReader();\r\n\r\nif (oLector.HasRows)\r\n{\r\noLector.Close();\r\nreturn true;\r\n}\r\nelse\r\n{\r\noLector.Close();\r\nreturn false;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: CARGA UNA IMAGEN .png DESDE LA RUTA C:\\csharp\\TTNoBorrar\\Thumbs\\\r\n/// SE USA: Al navegar o pasar un registro a los controles\r\n///\r\n///\r\nID que es al mismo tiempo el NOMBRE de la imagen almacenada en la ruta anterior             ///\r\nprivate static Bitmap get_imagen(string sNombreImagen)\r\n{\r\n//Contenedor para almacenar imagenes para poder tratarlas\r\n//despues\r\nBitmap oBitmap;\r\n\r\nstring sRutaImagen = @\"C:\\csharp\\TTNoBorrar\\Thumbs\\\" + sNombreImagen + \".png\";\r\ntry\r\n{\r\noBitmap = new Bitmap(sRutaImagen);\r\nreturn oBitmap;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" ERROR: obtener_imagen() \" + e.ToString());\r\nreturn null;\r\n}\r\n\r\n}\r\n\r\n}//FIN CLASE CFuncionBase\r\n\r\npublic static class CInt\r\n{\r\n\r\n///\r\n/// Lista de los caracteres validos para poder crear un numero int\r\n///\r\nprivate static char[] cArValidos = { \'0\', \'1\', \'2\', \'3\', \'4\', \'5\', \'6\', \'7\', \'8\', \'9\', \'\\b\' };\r\n\r\n///\r\n/// HACE: COMPRUEBA si un caracter (keychar) esta en el array Validos\r\n/// SE USA: Al intentar validar un caracter introducido en un TEXTBOX\r\n///\r\n///\r\nEl caracter a comprobar en la lista             ///\r\nprivate static bool isValido(char cChar)\r\n{\r\nforeach (char unChar in cArValidos)\r\n{\r\nif (cChar == unChar)\r\n{\r\nreturn true;\r\n}\r\n}\r\nreturn false;\r\n}\r\n\r\n///\r\n/// HACE: VALIDA cada tecla que se va presionando\r\n/// SE USA: En el evento OnKeyPress de un TEXTBOX\r\n///\r\n///\r\nKeyPressEventArgs             public static void valida_keypress(ref KeyPressEventArgs oEvent)\r\n{\r\nif (isValido(oEvent.KeyChar))\r\n{\r\nif (oEvent.KeyChar == \'.\')\r\n{\r\noEvent.KeyChar = \',\';\r\n}\r\n}\r\nelse\r\n{\r\n//Con esto no se imprime en pantalla el caracter\r\noEvent.Handled = true;\r\n}\r\n}\r\n\r\npublic static void sintaxis_on_leave(TextBox oTextBox)\r\n{\r\nint iInt;\r\ntry\r\n{\r\niInt = int.Parse(oTextBox.Text);\r\n}\r\ncatch\r\n{\r\noTextBox.Focus();\r\n}\r\n}\r\n\r\n///\r\n/// HACE: CONVIERTE un valor tipo string en int\r\n/// y lo devuelve, en caso de un fallo devuelve 0\r\n/// SE USA: Para evitar el int.parse, ya que este no controla\r\n/// el error\r\n///\r\n///\r\nun valor int en formato string             /// 0 si algo falla o el Valor si todo va bien\r\nprivate static int a_entero(string sValor)\r\n{\r\nint iResultado;\r\ntry\r\n{\r\niResultado = int.Parse(sValor);\r\n}\r\ncatch //Si hay error\r\n{\r\niResultado = 0;\r\n}\r\nreturn iResultado;\r\n}\r\n\r\n///\r\n/// HACE: DEVUELVE un valor int dependiendo del contenido del textbox\r\n/// si este no es correcto devolvera 0.00\r\n/// SE USA: Al asignar de CONTROLES a ESTRUCTURA en lugar del simple\r\n/// int.parse().  Para evitar que se presione aceptar sin tabulacion\r\n///\r\n///\r\n/// El valor o 0.00 en caso de ERROR\r\nprivate static int text_a_entero(TextBox oTextBox)\r\n{\r\nint iInt;\r\ntry\r\n{\r\niInt = int.Parse(oTextBox.Text);\r\n}\r\ncatch\r\n{\r\niInt = 0;\r\n}\r\nreturn iInt;\r\n}\r\n\r\n///\r\n/// HACE: LEE el contenido de TEXTBOX y le aplica el int.Parse\r\n/// si ocurre un ERROR devuelve FALSE sino TRUE\r\n/// SE USA: Al validar el contenido de las cajas de texto antes de\r\n/// AceptarNuevo o AceptarModificar\r\n///\r\n///\r\n///\r\npublic static bool isNotInt(TextBox oTextBox)\r\n{\r\nint iInt;\r\ntry\r\n{\r\niInt = int.Parse(oTextBox.Text);\r\nreturn false;\r\n}\r\ncatch\r\n{\r\nreturn true;\r\n}\r\n}\r\n\r\n}//FIN CLASE CInt\r\n\r\n///\r\n/// Clase para trabajar con numeros Double y cajas de texto\r\n///\r\npublic static class CDouble\r\n{\r\n\r\n///\r\n/// Lista de los caracteres validos para poder crear un numero double\r\n///\r\nprivate static char[] cArValidos = { \'0\', \'1\', \'2\', \'3\', \'4\', \'5\', \'6\', \'7\', \'8\', \'9\', \'\\b\', \'.\', \',\' };\r\n\r\n///\r\n/// HACE: COMPRUEBA si un caracter (keychar) esta en el array Validos\r\n/// SE USA: Al intentar validar un caracter introducido en un TEXTBOX\r\n///\r\n///\r\nEl caracter a comprobar en la lista             ///\r\nprivate static bool isValido(char cChar)\r\n{\r\nforeach (char unChar in cArValidos)\r\n{\r\nif (cChar == unChar)\r\n{\r\nreturn true;\r\n}\r\n}\r\nreturn false;\r\n}\r\n\r\n///\r\n/// HACE: VALIDA cada tecla que se va presionando\r\n/// SE USA: En el evento OnKeyPress de un TEXTBOX\r\n///\r\n///\r\nKeyPressEventArgs             public static void valida_keypress(ref KeyPressEventArgs oEvent)\r\n{\r\nif (isValido(oEvent.KeyChar))\r\n{\r\nif (oEvent.KeyChar == \'.\')\r\n{\r\noEvent.KeyChar = \',\';\r\n}\r\n}\r\nelse\r\n{\r\n//Con esto no se imprime en pantalla el caracter\r\noEvent.Handled = true;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: COMPRUEBA si se escribio bien un double\r\n/// SE USA: En el evento OnLeave de un TEXTBOX\r\n///\r\n///\r\npublic static void sintaxis_on_leave(TextBox oTextBox)\r\n{\r\nconst int iNumEnteros = 6;//4;\r\nconst int iNumDecimales = 2;\r\nbool isComa = false;\r\nbool isError = false;\r\nint iContDecimal = 0;\r\nint iContEntero = 0;\r\n\r\nforeach (char cChar in oTextBox.Text)\r\n{\r\nif (cChar == \',\')\r\n{\r\nif (isComa)\r\n{\r\n//\"NO PUEDE TENER MAS DE UNA COMA 0,00 \";\r\nisError = true;\r\nbreak;\r\n}\r\nisComa = true;\r\n}\r\nelse if (cChar &gt;= \'0\' &amp;&amp; cChar &lt;= \'9\')                     {                         if (isComa)                         {                             if (iContDecimal &gt;= iNumDecimales)\r\n{\r\n//\"NO PUEDE TENER MAS DE DOS DECIMALES ,00 \";\r\nisError = true;\r\n//MessageBox.Show(oTextBox.Name.ToString());\r\nbreak;\r\n}\r\niContDecimal++;\r\n}\r\nelse\r\n{\r\nif (iContEntero &gt;= iNumEnteros)\r\n{\r\n//\"NO PUEDE TENER MAS DE CUATRO ENTEROS 0000,00 \";\r\nisError = true;\r\nbreak;\r\n}\r\niContEntero++;\r\n}\r\n}\r\n}//Fin foreach\r\n\r\n//Relleno con el 0 faltante en decimales\r\nif (oTextBox.Text == \"\" || oTextBox.Text == \",\")\r\n{\r\noTextBox.Text = \"0,00\";\r\n}\r\nelse if (!isError)\r\n{\r\nif (iContEntero == 0)\r\n{\r\nif (!isComa)\r\n{\r\noTextBox.Text = \"0,\" + oTextBox.Text;\r\n}\r\nelse\r\n{\r\noTextBox.Text = \'0\' + oTextBox.Text;\r\n}\r\n}\r\nelse if (iContEntero &gt; 0 &amp;&amp; iContEntero &lt;= iNumEnteros)\r\n{\r\nif (!isComa)\r\n{\r\noTextBox.Text = oTextBox.Text + \",00\";\r\n}\r\nelse\r\n{\r\nif (iContDecimal == 0)\r\n{\r\noTextBox.Text = oTextBox.Text + \"00\";\r\n}\r\nelse if (iContDecimal == 1)\r\n{\r\noTextBox.Text = oTextBox.Text + \"0\";\r\n}\r\n}\r\n}\r\n}\r\nelse if (isError)\r\n{\r\noTextBox.Focus();\r\noTextBox.SelectAll();\r\n}\r\n}\r\n\r\npublic static void sintaxis_on_leave2(TextBox oTextBox)\r\n{\r\ndouble fDouble;\r\ntry\r\n{\r\nfDouble = double.Parse(oTextBox.Text);\r\n}\r\ncatch\r\n{\r\noTextBox.Focus();\r\n}\r\n}\r\n\r\n///\r\n/// HACE: CONVIERTE un valor tipo string en DOUBLE\r\n/// y lo devuelve, en caso de un fallo devuelve 0\r\n/// SE USA: Para evitar el Double.parse, ya que este no controla\r\n/// el error\r\n///\r\n///\r\nun valor double en formato string             /// 0 si algo falla o el Valor si todo va bien\r\npublic static double obtener_double(string sValor)\r\n{\r\ndouble fResultado;\r\ntry\r\n{\r\nfResultado = double.Parse(sValor);\r\n}\r\ncatch //Si hay error\r\n{\r\nfResultado = 0.00;\r\n}\r\nreturn fResultado;\r\n}\r\n\r\n///\r\n/// HACE: DEVUELVE un valor double dependiendo del contenido del textbox\r\n/// si este no es correcto devolvera 0.00\r\n/// SE USA: Al asignar de CONTROLES a ESTRUCTURA en lugar del simple\r\n/// double.parse().  Para evitar que se presione aceptar sin tabulacion\r\n///\r\n///\r\n/// El valor o 0.00 en caso de ERROR\r\npublic static double obtener_double(TextBox oTextBox)\r\n{\r\ndouble fDouble;\r\ntry\r\n{\r\nfDouble = double.Parse(oTextBox.Text);\r\n}\r\ncatch\r\n{\r\nfDouble = 0.00;\r\n}\r\nreturn fDouble;\r\n}\r\n\r\n///\r\n/// HACE: LEE el contenido de TEXTBOX y le aplica el double.Parse\r\n/// si ocurre un ERROR devuelve FALSE sino TRUE\r\n/// SE USA: Al validar el contenido de las cajas de texto antes de\r\n/// AceptarNuevo o AceptarModificar\r\n///\r\n///\r\n///\r\npublic static bool isNotDouble(TextBox oTextBox)\r\n{\r\ndouble fDouble;\r\ntry\r\n{\r\nfDouble = double.Parse(oTextBox.Text);\r\nreturn false;\r\n}\r\ncatch\r\n{\r\nreturn true;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: PASA a un formato moneda con dos decimales un número double\r\n/// SE USA: Al transferir datos de tipo moneda a un control\r\n///\r\n///\r\n///\r\npublic static string obtener_moneda_esp(double fDouble)\r\n{\r\nNumberFormatInfo oNumberFormatInfo = new NumberFormatInfo();\r\nstring sResultado;\r\n\r\n//FORMATO DE LA MONEDA\r\noNumberFormatInfo.CurrencyDecimalDigits = 2;\r\noNumberFormatInfo.CurrencyGroupSeparator = \".\";\r\noNumberFormatInfo.CurrencyDecimalSeparator = \",\";\r\noNumberFormatInfo.CurrencySymbol = \"€ \";\r\n\r\nsResultado = fDouble.ToString(\"c\", oNumberFormatInfo);\r\n//si es 0.35\r\nif (fDouble &gt;= 0)\r\n{\r\nsResultado = sResultado.Remove(0, 2);\r\n}\r\n//si es -0.54\r\nelse\r\n{\r\nsResultado = sResultado.Remove(sResultado.Length - 1, 1);\r\nsResultado = sResultado.Remove(0, 3);\r\nsResultado = \"-\" + sResultado;\r\n}\r\nreturn sResultado;\r\n}\r\n\r\n}//FIN CLASE CDouble\r\n\r\n///\r\n/// Clase para hacer calculos matematicos con TEXTBOXES\r\n///\r\npublic static class CMatematicas\r\n{\r\n\r\n///\r\n/// HACE: LEE un DOUBLE y comprueba si solo tiene parte entera,\r\n/// si es asi lo devuelve con parte decimal a i,00\r\n///\r\n///\r\n///\r\nprivate static string double_sin_decimales(double fDouble)\r\n{\r\nstring sResultado;\r\ndouble fDoubleX100;\r\n//Primero guarda DoubleX100 en entero\r\n//Despues guarda el resto de ese Doublex100 /100\r\nint iResto;\r\n\r\nfDoubleX100 = fDouble * 100;\r\niResto = int.Parse(fDoubleX100.ToString());\r\niResto = iResto / 100;\r\n//Si es 0 no hay decimales\r\nif (iResto == 0)\r\n{\r\nsResultado = fDouble.ToString() + \",00\";\r\n}\r\nelse\r\n{\r\nsResultado = fDouble.ToString();\r\n}\r\nreturn sResultado;\r\n}\r\n\r\n///\r\n/// HACE: DEVUELVE un string con digitos numericos del calculo\r\n/// de un subtotal, este es inverso al del Total\r\n/// SE USA: En el evento txtTOTAL_TextChanged\r\n///\r\n///\r\n///\r\n///\r\npublic static string fCalculaSubTot(TextBox fTxtTotal, double fPorcentIva)\r\n{\r\ndouble fSubtot;\r\ndouble fTotal;\r\ntry\r\n{\r\nfTotal = double.Parse(fTxtTotal.Text);\r\nfSubtot = (100 * fTotal) / (fPorcentIva + 100);\r\nfSubtot = Math.Round(fSubtot, 2);\r\nreturn CDouble.obtener_moneda_esp(fSubtot);\r\n}\r\ncatch\r\n{\r\nfSubtot = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fSubtot);\r\n}\r\n}\r\n\r\n///\r\n/// HACE:A APLICA a un DOUBLE el porcentaje para obtener su \"IVA\"\r\n/// SE USA: En el evento txtSUBTOT_TextChanged\r\n///\r\n///\r\n///\r\nEs el que se aplicara al subtotal             ///\r\npublic static string fCalculaIva(TextBox fTxtSubtot, double fPorcentIva)\r\n{\r\ndouble fSubtot;\r\ndouble fIva;\r\n\r\ntry\r\n{\r\nfSubtot = double.Parse(fTxtSubtot.Text);\r\nfIva = fSubtot * (fPorcentIva / 100);\r\nfIva = Math.Round(fIva, 2);\r\n//return double_sin_decimales(fIva);\r\nreturn CDouble.obtener_moneda_esp(fIva);\r\n}\r\ncatch\r\n{\r\nfIva = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fIva);\r\n}\r\n}\r\n\r\n///\r\n/// HACE: SUMA dos cantidades DOUBLE y devuelve el resultado\r\n/// SE USA: En el evento txtSUBTOT_TextChanged\r\n///\r\n///\r\n///\r\n///\r\npublic static string fCalculaTotal(TextBox fTxtSubtot, TextBox fTxtIva)\r\n{\r\ndouble fSubtot;\r\ndouble fIva;\r\ndouble fTotal;\r\ntry\r\n{\r\nfSubtot = double.Parse(fTxtSubtot.Text);\r\nfIva = double.Parse(fTxtIva.Text);\r\nfTotal = fSubtot + fIva;\r\nreturn CDouble.obtener_moneda_esp(fTotal);\r\n}\r\ncatch\r\n{\r\nfTotal = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fTotal);\r\n}\r\n}\r\n\r\npublic static string fCalculaMonto(TextBox fTxtUnidad, TextBox fTxtPreund)\r\n{\r\ndouble fUnidad;\r\ndouble fPreund;\r\ndouble fMonto;\r\ntry\r\n{\r\nfUnidad = double.Parse(fTxtUnidad.Text);\r\nfPreund = double.Parse(fTxtPreund.Text);\r\nfMonto = fUnidad * fPreund;\r\nreturn CDouble.obtener_moneda_esp(fMonto);\r\n}\r\ncatch\r\n{\r\nfMonto = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fMonto);\r\n}\r\n}\r\n\r\npublic static string fCalculaCambio(TextBox fTxtTotal, TextBox fTxtPago)\r\n{\r\ndouble fTotal;\r\ndouble fPago;\r\ndouble fCambio;\r\ntry\r\n{\r\nfTotal = double.Parse(fTxtTotal.Text);\r\nfPago = double.Parse(fTxtPago.Text);\r\nfCambio = fPago - fTotal;\r\nreturn CDouble.obtener_moneda_esp(fCambio);\r\n}\r\ncatch\r\n{\r\nfCambio = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fCambio);\r\n}\r\n}\r\n///\r\n/// HACE: DEVUELVE en Dolares americanos una cantidad en florines\r\n/// ( cambio 1$=1.80 )\r\n/// SE USA:\r\n///\r\n///\r\n///\r\n///\r\npublic static string fDolares(TextBox fTxtFlorin, double fTasCambio)\r\n{\r\ndouble fFlorines;\r\ndouble fUsDolares;\r\n\r\ntry\r\n{\r\nfFlorines = double.Parse(fTxtFlorin.Text);\r\nfUsDolares = fFlorines / fTasCambio;\r\nfUsDolares = Math.Round(fUsDolares, 2);\r\n//return double_sin_decimales(fIva);\r\nreturn CDouble.obtener_moneda_esp(fUsDolares);\r\n}\r\ncatch\r\n{\r\nfUsDolares = 0.00;\r\nreturn CDouble.obtener_moneda_esp(fUsDolares);\r\n}\r\n}\r\n\r\n//public static void cAver()\r\n//{\r\n//    //CultureInfo nfi = new CultureInfo(\"es-ES\", false);\r\n//    //NumberFormatInfo nfi = new CultureInfo(\"es-ES\", false).NumberFormat;\r\n//    //NumberFormatInfo nfi = new NumberFormatInfo();\r\n\r\n//    //CREO EL OBJETO \"INFORMACION DE CULTURA\" para obtener los datos de cultura\r\n//    //española\r\n//    CultureInfo pCultNfo = new CultureInfo(\"es-ES\", false);\r\n//    //CREO EL OBJETO \"FORMATO DE NUMERO\" para poder modificar la representacion\r\n//    //de los numeros.\r\n//    //NumberFormatInfo oNumberFormatInfo = (NumberFormatInfo)pCultNfo.Clone(); //NO SE PUEDE CASTEAR\r\n//    NumberFormatInfo oNumberFormatInfo = new NumberFormatInfo();\r\n//    //FORMATO DE LA MONEDA\r\n//    oNumberFormatInfo.CurrencyDecimalDigits = 2;\r\n//    oNumberFormatInfo.CurrencyDecimalSeparator = \",\";\r\n//    oNumberFormatInfo.CurrencySymbol = \"€ \";\r\n\r\n//    double IVA;\r\n\r\n//    //IVA= 3.0;\r\n\r\n//    //MessageBox.Show(IVA.ToString(\"C\", oNumberFormatInfo));\r\n//    ////=&gt; € 3,00\r\n//    //MessageBox.Show(IVA.ToString(\"C\", pCultNfo));\r\n//    ////=&gt; 3,00 €\r\n\r\n//    //if (Double.IsNaN(0 / zero))\r\n//    //{\r\n//    //    Console.WriteLine(\"Double.IsNan() can determine whether a value is not-a-number.\");\r\n//    //}\r\n\r\n//}\r\n}//FIN CLASE clsMatematicas\r\n\r\n}//Fin nsBase\r\n#endregion NSBase\r\n\r\n#region NSDatagrid\r\nnamespace NSDatagrid\r\n{\r\n///\r\n/// Estos metodos sirven para tratar con controles DataGridViews\r\n///\r\npublic static class CDgvAccion\r\n{\r\n\r\n///\r\n/// HACE: LLENA con un DATAGRIDVIEW segun el una sentencia SQL\r\n///\r\n///\r\nCualquier sentencia SELECT             ///\r\nEl DATAGRIDVIEW donde se mostraran los datos             ///\r\nLa conexion a la BD             public static void llenar_dgv(string sSQL, ref DataGridView oDgv, OleDbConnection oConx)\r\n{\r\nBindingSource oBinder = new BindingSource();\r\nOleDbDataAdapter oAdaptador = new OleDbDataAdapter(sSQL, oConx);\r\nDataSet oDataset = new DataSet();\r\n\r\ntry\r\n{\r\noAdaptador.Fill(oDataset, \"tabla\");\r\n\r\n//Al binder general le digo su fuente de datos\r\noBinder.DataSource = oDataset;\r\n//La fuente de datos del dg sera el binder\r\noDgv.DataSource = oBinder.DataSource;\r\noDgv.DataMember = \"tabla\";\r\n}\r\ncatch\r\n{\r\nMessageBox.Show(\"SENTENCIA SQL INVALIDO\", \"ERROR\", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);\r\n}\r\n}\r\n\r\n///\r\n/// HACE: LLENA con un DATAGRIDVIEW segun el una sentencia SQL\r\n///\r\n///\r\nCualquier sentencia SELECT             ///\r\nEl DATAGRIDVIEW donde se mostraran los datos             ///\r\nLa conexion a la BD             public static void llenar_dgv(string sSQL, ref DataGridView oDgv, CBaseDatos oBD)\r\n{\r\nBindingSource oBinder = new BindingSource();\r\nMySqlDataAdapter oAdaptador = new MySqlDataAdapter(sSQL, oBD.oConn);\r\nDataSet oDataset = new DataSet();\r\ntry\r\n{\r\noAdaptador.Fill(oDataset, \"tabla\");\r\n\r\n//Al binder general le digo su fuente de datos\r\noBinder.DataSource = oDataset;\r\n//La fuente de datos del dg sera el binder\r\noDgv.DataSource = oBinder.DataSource;\r\noDgv.DataMember = \"tabla\";\r\n}\r\ncatch\r\n{\r\nMessageBox.Show(\"SENTENCIA SQL INVALIDA\", \"ERROR\", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);\r\n}\r\n}\r\n\r\n///\r\n/// HACE: LLENA un DATAGRIDVIEW desde un dataset previamente con al menos una tabla\r\n/// SE USA:\r\n///\r\n///\r\nDATASET ya creado con datos             ///\r\n///\r\npublic static void llenar_dgv(DataSet oDataset, ref DataGridView oDgv)\r\n{\r\nDataTable oDataTable = new DataTable();\r\noDataTable = oDataset.Tables[0];\r\n//La fuente de datos del dg sera el binder\r\noDgv.DataSource = oDataTable;\r\n}\r\n\r\n///\r\n/// HACE:  ASIGNA true a un CHECKBOXCELL si esta vacio o si esta en falso pero\r\n/// si esta en true le asigna false.\r\n/// SE USA:Al hacer click sobre una celda\r\n///\r\n///\r\npublic static void conmutar_valor_checkbox(ref DataGridView oDgv)\r\n{\r\n//En esta comprobacion hay un problema y es que el headercell\r\n//es detectado como el checkboxcell[0,0]\r\nif (oDgv.CurrentCell is DataGridViewCheckBoxCell)\r\n{\r\nDataGridViewCheckBoxCell oChkCell = new DataGridViewCheckBoxCell();\r\n\r\noChkCell.Value = oDgv.CurrentCell.Value;\r\n\r\nif ((oChkCell.Value == null) || (bool.Parse(oChkCell.Value.ToString()) == false))\r\n{\r\noChkCell.Value = true;\r\n}\r\nelse\r\n{\r\noChkCell.Value = false;\r\n}\r\noDgv.CurrentCell.Value = oChkCell.Value;\r\n}\r\n\r\n}\r\n\r\n///\r\n/// HACE: LLENA un array con todos los IDS a borrar\r\n/// SE USA: Al ejecutar ACEPTAR ELIMINAR\r\n///\r\n///\r\nDGV con columna de ChecBox             ///\r\nArray para guardar los IDS             public static void llenar_array_con_ids(DataGridView oDgv, ref string[] sAriIds)\r\n{\r\nint[] iArIndice;\r\nint iNumRegs = 0;\r\n\r\niNumRegs = oDgv.Rows.Count;\r\n\r\n//Array para guardar indices de filas con Checkbox=True\r\niArIndice = new int[iNumRegs];\r\n\r\n//Tamaño del array igual al numero de filas con Checkbox=True\r\nsAriIds = new string[CDgvFuncion.get_numero_celdas_marcadas(oDgv)];\r\n\r\n//Asigno el indice si esta activado el checkbox\r\n//sino asign un -1\r\nfor (int i = 0; i &lt; iNumRegs; i++)\r\n{\r\nif (oDgv.Rows[i].Cells[0].Value == null)\r\n{\r\niArIndice[i] = -1;\r\n}\r\nelse if (bool.Parse(oDgv.Rows[i].Cells[0].Value.ToString()))\r\n{\r\niArIndice[i] = i;\r\n}\r\nelse\r\n{\r\n//En caso que este checkcell=false le agrego -1 como marca\r\niArIndice[i] = -1;\r\n}\r\n}\r\n\r\nint j = 0; //Indice para ArIds\r\n\r\n//Recorro todas las filas\r\nfor (int i = 0; i &lt; iNumRegs; i++)\r\n{\r\nif (iArIndice[i] != -1)\r\n{\r\nsAriIds[j] = oDgv.Rows[i].Cells[1].Value.ToString();\r\nj++;\r\n}\r\n}\r\n}\r\n\r\n///\r\n/// HACE: ASIGNA un TRUE/FALSE a todas las celdas de la columna 0 de un control\r\n/// DataGridView\r\n/// SE USA:Al hacer Doble click sobre la cabecera de una columna CHECKBOX\r\n///\r\n///\r\n///\r\npublic static void asigna_valor_columnacheckbox(bool bValor, ref DataGridView oDgv)\r\n{\r\nfor (int i = 0; i &lt; oDgv.RowCount; i++)\r\n{\r\noDgv.Rows[i].Cells[0].Value = bValor;\r\n}\r\n}\r\n\r\n///\r\n/// HACE: MARCA Y DESMARCA las celdas de la columna 0 de un control DataGridView\r\n/// esa columna tiene la obligacion de ser CHECKBOX\r\n/// SE USA:Al hacer doble click en el HEADER de una columna CHECBOX\r\n///\r\n///\r\npublic static void marca_checkboxes_columna(ref DataGridView oDgv)\r\n{\r\nif (CDgvFuncion.isCheckbox(oDgv, false))\r\n{\r\nasigna_valor_columnacheckbox(true, ref oDgv);\r\n}\r\nelse\r\n{\r\nasigna_valor_columnacheckbox(false, ref oDgv);\r\n}\r\n}\r\n\r\npublic static void set_estilo(ref DataGridView oDgv)\r\n{\r\nif (oDgv != null &amp;&amp; oDgv.ColumnCount &gt; 1)\r\n{\r\n//LE CAMBIO EL ASPECTO AL GRID\r\n//http://pyme.net.uy/desarrolladores/herramientas/colores2.htm#16colores\r\n//http://msdn.microsoft.com/en-us/library/74b2wakt.aspx\r\n\r\n//Seleccion\r\noDgv.MultiSelect = false;\r\noDgv.SelectionMode = DataGridViewSelectionMode.FullRowSelect;\r\n\r\n//Celda cabecera ezquina arriba izquierda\r\noDgv.TopLeftHeaderCell.Style.BackColor = Color.Black;\r\n\r\n//ROWHEADERS\r\noDgv.RowHeadersWidthSizeMode = DataGridViewRowHeadersWidthSizeMode.DisableResizing;\r\noDgv.RowHeadersDefaultCellStyle.SelectionBackColor = Color.Crimson;\r\noDgv.RowHeadersDefaultCellStyle.SelectionForeColor = Color.Black;\r\n\r\n//Bloquear edit en determinadas columnas\r\nfor (int i = 1; i &lt; oDgv.ColumnCount - 1; i++)\r\n{\r\noDgv.Columns[i].ReadOnly = true;\r\n}\r\n\r\n//Cabeceras\r\n//COLUMNAS\r\n\r\n//PARA QUE NO SE DESORDENE EL TITULO DEL HEADER\r\noDgv.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.DisableResizing;\r\noDgv.ColumnHeadersBorderStyle = DataGridViewHeaderBorderStyle.Single;\r\n\r\nfor (int i = 0; i &lt; oDgv.ColumnCount; i++)\r\n{   //Alineacion texto\r\noDgv.Columns[i].HeaderCell.Style.Alignment = DataGridViewContentAlignment.MiddleCenter;\r\n//Color fondo\r\noDgv.Columns[i].HeaderCell.Style.BackColor = Color.Black;\r\n//Color texto\r\noDgv.Columns[i].HeaderCell.Style.ForeColor = Color.White;\r\n}\r\n\r\n//Cabeceras\r\n//FILAS\r\noDgv.AllowUserToResizeRows = false;\r\noDgv.RowHeadersBorderStyle = DataGridViewHeaderBorderStyle.Single;\r\n\r\n//color\r\noDgv.RowHeadersDefaultCellStyle.BackColor = Color.Black;\r\n\r\n//GRILLA Lineas divisoras\r\noDgv.GridColor = Color.Gray;\r\n\r\n//Filas con colores alternos\r\noDgv.RowsDefaultCellStyle.BackColor = Color.Pink;\r\noDgv.AlternatingRowsDefaultCellStyle.BackColor = Color.Linen;\r\n\r\n//COLUMNAS\r\n//Formato de datos\r\n//oDgv.Columns[5].DefaultCellStyle.Format = \"c\";\r\n//oDgv.Columns[6].DefaultCellStyle.Format = \"c\";\r\n\r\n//Alineacion\r\noDgv.Columns[5].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;\r\noDgv.Columns[6].DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight;\r\n\r\n//Fuentes (tipografia)\r\noDgv.DefaultCellStyle.Font = new Font(\"Tahoma\", 9);\r\noDgv.DefaultCellStyle.ForeColor = Color.Black;\r\noDgv.DefaultCellStyle.BackColor = Color.LavenderBlush;\r\n}\r\n}\r\n\r\n}//Fin de CDgvAccion\r\n\r\npublic static class CDgvFuncion\r\n{\r\n///\r\n/// HACE: Devuelve el indice de la fila del checkbox en True\r\n/// SE USA: Al borrar necesito almacenar los indices\r\n///\r\n///\r\n///\r\npublic static int get_numero_celdas_marcadas(DataGridView oDgv)\r\n{\r\nint iCeldasMarcadas = 0;\r\n\r\nfor (int i = 0; i &lt; oDgv.RowCount; i++)\r\n{\r\nif (oDgv.Rows[i].Cells[0].Value != null)\r\n{\r\nif (bool.Parse(oDgv.Rows[i].Cells[0].Value.ToString()))\r\n{\r\niCeldasMarcadas++;\r\n}\r\n}\r\n}\r\n\r\nreturn iCeldasMarcadas;\r\n}\r\n\r\n///\r\n/// HACE: Devuelve si existe o no un CheckBoxCell con valor igual a TRUE o FALSE\r\n/// SE USA: Al maracar o desmarcar todos los CheckBoxCell tenemos que saber si existe\r\n/// al menos uno marcado\r\n///\r\n///\r\n///\r\n///\r\npublic static bool isCheckbox(DataGridView oDgv, bool bValor)\r\n{\r\ntry\r\n{\r\nfor (int i = 0; i &lt; oDgv.RowCount; i++)\r\n{\r\nif (oDgv.Rows[i].Cells[0].Value == null)\r\n{\r\nreturn true;\r\n}\r\nelse if (bool.Parse(oDgv.Rows[i].Cells[0].Value.ToString()) == bValor)\r\n{\r\nreturn true;\r\n}\r\n}\r\n//Si acaba el bucle es que no hay checkboxes con valor=bValor\r\nreturn false;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" ERROR: isCheckbox() \" + e.ToString());\r\nreturn false;\r\n}\r\n}\r\n\r\n///\r\n/// HACE:  Obtiene el valor de una celda de la columna sNomColumna y la fila\r\n/// es la que esta seleccionada\r\n/// SE USA: Cuando se va a pasar una determinada fila a una estructura se pide el ID\r\n///\r\n///\r\n///\r\n/// Si existe ese valor lo devuelve sino devuelve \"NO EXISTE ID\"\r\npublic static string get_sId(DataGridView oDgv, string sNomColumnaId)\r\n{\r\nDataGridViewRow oFila = new DataGridViewRow();\r\nstring sId;\r\ntry\r\n{\r\noFila = oDgv.CurrentRow;\r\nif (oFila != null)\r\n{\r\nsId = oFila.Cells[sNomColumnaId].Value.ToString();\r\n}\r\nelse\r\n{\r\nsId = \"NO EXISTE ID\";\r\n\r\n}\r\nreturn sId;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" ERROR: id_fila_marcada() \" + e.ToString());\r\nreturn sId = \"NO EXISTE ID\";\r\n}\r\n}\r\n\r\n///\r\n/// HACE:  Obtiene el valor de una celda de la columna sNomColumna y la fila\r\n/// es la que esta seleccionada\r\n/// SE USA: Cuando se va a pasar una determinada fila a una estructura se pide el ID\r\n///\r\n///\r\n///\r\n/// Si existe ese valor lo devuelve sino devuelve -1\r\npublic static int get_iId(DataGridView oDgv, string sNomColumnaId)\r\n{\r\nDataGridViewRow oFila = new DataGridViewRow();\r\nint iId;\r\ntry\r\n{\r\noFila = oDgv.CurrentRow;\r\nif (oFila != null)\r\n{\r\niId = int.Parse(oFila.Cells[sNomColumnaId].Value.ToString());\r\n}\r\nelse\r\n{\r\niId = -1;\r\n\r\n}\r\nreturn iId;\r\n}\r\ncatch (Exception e)\r\n{\r\nMessageBox.Show(\" ERROR: get_id() \" + e.ToString());\r\nreturn iId = -1;\r\n}\r\n}\r\n\r\npublic static double get_sumatorio(DataGridView oDgv, int iColIndex)\r\n{\r\ndouble fResultado = 0.00;\r\ntry\r\n{\r\nfor (int i = 0; i &lt; oDgv.RowCount; i++)\r\n{\r\nfResultado = fResultado + double.Parse(oDgv.Rows[i].Cells[iColIndex].Value.ToString());\r\n}\r\nreturn fResultado;\r\n}\r\ncatch\r\n{\r\nreturn fResultado;\r\n}\r\n}\r\n}//Fin de CFuncionDgv\r\n\r\npublic struct SParametrosColumna\r\n{\r\ninternal string sHeader;\r\ninternal int iPosicion;\r\ninternal string sNombreCol;\r\ninternal string sTexto;\r\n//El numero total de columnas que tendra este grid\r\n//dependera del select que se meta en parametrosgrid\r\ninternal int iNumColumnas;\r\n\r\npublic SParametrosColumna(string sHeader, int iPosicion, string sNombreColumna, int iNumColumnas)\r\n{\r\nthis.sHeader = sHeader;// \" X \";\r\nthis.iPosicion = iPosicion; // 0;\r\nthis.sNombreCol = sNombreColumna; //\"BORRAR\";\r\nthis.iNumColumnas = iNumColumnas;// 7;\r\nthis.sTexto = \"\";\r\n}\r\npublic SParametrosColumna(string sHeader, int iPosicion, string sNombreColumna, int iNumColumnas, string sTexto)\r\n{\r\nthis.sHeader = sHeader;// \" X \";\r\nthis.iPosicion = iPosicion; // 0;\r\nthis.sNombreCol = sNombreColumna; //\"BORRAR\";\r\nthis.iNumColumnas = iNumColumnas;// 7;\r\nthis.sTexto = sTexto;\r\n}\r\n\r\n}\r\n\r\n///\r\n/// Tiene los parametros y los metodos para crear los distintos tipos\r\n/// de columnas en un DataGridView\r\n///\r\npublic static class CColumnas\r\n{\r\n//CheckBox\r\npublic static void crear_columna_checkbox(SParametrosColumna stParametros, ref DataGridView oDgv)\r\n{\r\nif (oDgv.ColumnCount &lt;= stParametros.iNumColumnas)\r\n{\r\nDataGridViewCheckBoxColumn oCheckboxColumn = new DataGridViewCheckBoxColumn();\r\n//DataGridViewCheckBoxCell oCheckboxHeader = new DataGridViewCheckBoxCell();\r\n\r\noCheckboxColumn.HeaderText = stParametros.sHeader;\r\noCheckboxColumn.Name = stParametros.sNombreCol;\r\noCheckboxColumn.DisplayIndex = stParametros.iPosicion;\r\n\r\noCheckboxColumn.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;\r\noCheckboxColumn.FlatStyle = FlatStyle.Standard;\r\n\r\n//Para que no exista el valor null\r\noCheckboxColumn.ThreeState = false;\r\n\r\n//Al ser checbox es mejor readonly=true\r\noCheckboxColumn.ReadOnly = true;\r\n\r\n//AGREGO LA COLUMNA\r\noDgv.Columns.Add(oCheckboxColumn);\r\n}\r\n}\r\n//Boton\r\npublic static void crear_columna_boton(SParametrosColumna stParametros, ref DataGridView oDgv)\r\n{\r\nif (oDgv.ColumnCount &lt;= stParametros.iNumColumnas)\r\n{\r\n//CREO LA COLUMNA\r\nDataGridViewButtonColumn pColumnaBoton = new DataGridViewButtonColumn();\r\npColumnaBoton.Text = stParametros.sTexto;\r\npColumnaBoton.HeaderText = stParametros.sHeader;\r\npColumnaBoton.Name = stParametros.sNombreCol;\r\npColumnaBoton.DisplayIndex = stParametros.iPosicion;\r\npColumnaBoton.UseColumnTextForButtonValue = true;\r\npColumnaBoton.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;\r\npColumnaBoton.FlatStyle = FlatStyle.Standard;\r\n\r\npColumnaBoton.ReadOnly = true;\r\noDgv.Columns.Add(pColumnaBoton);\r\n}\r\n}\r\n//Combo\r\npublic static void crear_columna_combobox(SParametrosColumna stParametros, ref DataGridView oDgv)\r\n{\r\nif (oDgv != null)\r\n{\r\nDataGridViewComboBoxColumn pColumnaComboBox = new DataGridViewComboBoxColumn();\r\npColumnaComboBox.HeaderText = stParametros.sHeader;\r\npColumnaComboBox.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;\r\npColumnaComboBox.FlatStyle = FlatStyle.Standard;\r\npColumnaComboBox.CellTemplate.Style.BackColor = Color.AliceBlue;\r\npColumnaComboBox.DisplayIndex = stParametros.iPosicion;\r\noDgv.Columns.Add(pColumnaComboBox);\r\n}\r\n}\r\n//Imagen\r\npublic static void crear_columna_image(SParametrosColumna stParametros, ref DataGridView oDgv)\r\n{\r\nif (oDgv != null)\r\n{\r\n\r\nDataGridViewImageColumn pColumnaImageColum = new DataGridViewImageColumn();\r\npColumnaImageColum.HeaderText = stParametros.sHeader;\r\npColumnaImageColum.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;\r\n//pColumnaImageColum.FlatStyle = FlatStyle.Standard;\r\npColumnaImageColum.CellTemplate.Style.BackColor = Color.AliceBlue;\r\npColumnaImageColum.DisplayIndex = stParametros.iPosicion;\r\noDgv.Columns.Add(pColumnaImageColum);\r\n}\r\n}\r\n\r\n}//Fin de CColumnas\r\n\r\n}//Fin nsDatagrid\r\n#endregion NSDatagrid\r\n\r\n#region NSBusqueda\r\nnamespace NSBusqueda\r\n{\r\npublic class CAccion\r\n{\r\n//TODO A ELIMINAR\r\npublic static void pAgregaColumna(DataGridView oDgv, int pNumCols)\r\n{\r\nif (oDgv != null)\r\n{\r\n//refresca para evitar que repita 2 veces la col de botones\r\noDgv.Refresh();\r\nif (oDgv.ColumnCount &lt; pNumCols)\r\n{\r\nDataGridViewButtonColumn pColumnaBotones = new DataGridViewButtonColumn();\r\npColumnaBotones.HeaderText = \"FORMULARIO\";\r\npColumnaBotones.Text = \"DETALLE\";\r\npColumnaBotones.UseColumnTextForButtonValue = true;\r\npColumnaBotones.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;\r\npColumnaBotones.FlatStyle = FlatStyle.Standard;\r\npColumnaBotones.CellTemplate.Style.BackColor = Color.AliceBlue;\r\npColumnaBotones.DisplayIndex = 0;  //Posicion boton\r\n\r\noDgv.Columns.Add(pColumnaBotones);\r\n}\r\n}\r\n}\r\n\r\n}//FIN CLASE CAccion\r\n\r\n//Clase que solo tiene exclusivamente Funciones Globales\r\npublic class CFuncion\r\n{\r\n///\r\n///HACE: DEVUELVE el ID completo dependiendo del IDGENERICO y un num entero.\r\n///SE USA: Al buscar por ID sin necesidad de insertar el prefijo solo\r\n///utilizando el numero relacionado.\r\n///\r\n///\r\nEjemplo:HOT00000             ///\r\nEjemplo:17             /// Ejemplo:HOT000017\r\npublic static string fDeNumAID(string fIDgenerico, int fNumAtratar)\r\n{\r\nint fNum_Ceros, fContDig, fContPref, fDiv;\r\nstring fPrefijo, sId;\r\n\r\nfContDig = 0; fDiv = fNumAtratar;\r\n//Cuento los digitos de los que consta el numero entero fNumAtratar\r\nwhile (fDiv != 0)\r\n{\r\nfDiv = fDiv / 10;\r\nfContDig++;\r\n}\r\nfPrefijo = \"\"; fContPref = 0;\r\n//Obtengo el prefijo y su longitud\r\nforeach (char cChar in fIDgenerico)\r\n{\r\n//Si el caracter no es numerico en HOT000000\r\n//es decir en HOT\r\nif (!Char.IsNumber(cChar))\r\n{\r\n//Guardo el caracter\r\nfPrefijo = fPrefijo + cChar;\r\n//Y cuento su cantidad\r\nfContPref++;\r\n}\r\n}\r\n//fNum_ceros=(HOT000000)=9-(HOT)=3\r\nfNum_Ceros = fIDgenerico.Length - fContPref; //Cantidad de 0\'s del id generico\r\n//Cantidad de 0\'s a faltantes para crear el HOT0..0fNumTratar\r\n//fNum_Ceros=(000000)=6 - (cantidad de digitos en fNumTratar)=x\r\nfNum_Ceros = fNum_Ceros - fContDig;\r\n\r\n//fNumeroAtratar el valor numerico pasado como argumento\r\nsId = fNumAtratar.ToString();\r\nif (fNum_Ceros &gt; 0)\r\n{\r\nfor (int i = 0; i &lt; fNum_Ceros; i++)\r\n{\r\nsId = \"0\" + sId;\r\n}\r\n}\r\nsId = fPrefijo + sId;\r\n\r\nreturn sId;\r\n}\r\n\r\n///\r\n///HACE: DEVUELVE el equivalente del numero de fila en que se posiciona un registro\r\n///en un dataset que se llenara con un SELECT * by idn\r\n///SE USA:Al actualizar el valor de cRegAct por ejemplo desde boton DETALLES de un DGV\r\n///\r\n///\r\nID que se buscara             ///\r\nEl SELECT * FROM cNomTabla ORDER BY idn             ///\r\n/// El numero de la fila\r\nprivate static int fIDaPosicion(string fIDaBuscar, string fSQL, OleDbConnection oConx)\r\n{\r\nif (fIDaBuscar != null)\r\n{\r\nOleDbDataAdapter oAdaptador;\r\nDataSet oDataset;\r\nint iNumRegs;\r\nstring fContenido;\r\n\r\noAdaptador = new OleDbDataAdapter(fSQL, oConx);\r\noDataset = new DataSet();\r\noAdaptador.Fill(oDataset, \"ListaIDS\");\r\n//Crea tabla con una sola columna, la columna 0\r\niNumRegs = oDataset.Tables[\"ListaIDS\"].Rows.Count;\r\n\r\nfor (int i = 0; i &lt; iNumRegs; i++)\r\n{\r\nfContenido = oDataset.Tables[\"ListaIDS\"].Rows[i][0].ToString();\r\nif (fIDaBuscar == fContenido)\r\n{\r\nreturn i;\r\n}\r\n}\r\n\r\n//Devuelve cuando no se encuentra ese registro\r\nreturn -1;\r\n}\r\nelse\r\n{\r\nreturn -2;  //Si el valor a buscar era null\r\n}\r\n}\r\n\r\n///\r\n/// HACE: PASA a un formato moneda con dos decimales un número double\r\n/// SE USA: Al transferir datos de tipo moneda en una sentencia SQL\r\n///\r\n///\r\n///\r\npublic static string fAMonedaAME(double fDouble)\r\n{\r\nNumberFormatInfo oNumberFormatInfo = new NumberFormatInfo();\r\nstring sResultado;\r\n\r\n//FORMATO DE LA MONEDA\r\noNumberFormatInfo.CurrencySymbol = \"€\";\r\noNumberFormatInfo.CurrencyGroupSeparator = \"\";\r\noNumberFormatInfo.CurrencyDecimalSeparator = \".\";\r\n\r\nsResultado = fDouble.ToString(\"c\", oNumberFormatInfo);\r\nsResultado = sResultado.Remove(0, 1);\r\nreturn sResultado;\r\n}\r\n\r\n///\r\n/// SE USA: Al realizar un cambio en un control DATETIMEPICKER y\r\n/// seguidamente pasar este valor a una sentencia SQL\r\n///\r\n///\r\n///\r\npublic static string fFechaENG(DateTimePicker Dtp)\r\n{\r\nstring fDia;\r\nstring fMes;\r\nstring fAno;\r\nstring fFecha;\r\n\r\nfDia = Dtp.Value.Day.ToString();\r\nfMes = Dtp.Value.Month.ToString();\r\nfAno = Dtp.Value.Year.ToString();\r\n\r\nfFecha = fMes + \"/\" + fDia + \"/\" + fAno;\r\n\r\nreturn fFecha;\r\n}\r\n\r\n///\r\n/// SE USA: Al pasar de una estructura a una sentencia SQL\r\n///\r\n///\r\n///\r\npublic static string fFechaENG(DateTime Dt)\r\n{\r\nstring fDia;\r\nstring fMes;\r\nstring fAno;\r\nstring fFecha;\r\n\r\nfDia = Dt.Day.ToString();\r\nfMes = Dt.Month.ToString();\r\nfAno = Dt.Year.ToString();\r\n\r\nfFecha = fMes + \"/\" + fDia + \"/\" + fAno;\r\n\r\nreturn fFecha;\r\n}\r\n}//FIN CLASE CFuncion\r\n\r\n}//Fin nsBusqueda\r\n#endregion NSBusqueda\r\n\r\n#region NSGestoresEventos\r\nnamespace NSGestoresEventos\r\n{\r\n//http://www.programacion.com/tutorial/csharp/13/#_Toc521045067\r\n//Delegado: declaracion donde se asigna un nombre a ese tipo y se facilita\r\n//la lista de prametros\r\n\r\n//2- Creo el public delegate\r\npublic delegate void gesToCaps(TextBox evCajaTexto); //Defino el evento\r\n//public event gesToCaps evAmayus;\r\n}//Fin nsGestoresEventos\r\n#endregion NSGestoresEventos\r\n}\r\n\r\n</pre>','Normalmente en todos los proyectos se suele contar con una clase o archivo personalizado con multiples funciones sencillas que se utilizan frecuentemente.  Todos estos metodos y funciones imprescindibles los he agrupado obteniendo la clase \"CUtils\"','publish','clase-con-funciones-sencillas-e-imprescindibles-cutils'),(6,'2010-09-03 20:10:45','2010-10-31 20:10:40','Arquitectura en 3 capas. Arquitectura MVC y la POO I','<h2><span style=\"color: #99cc00;\"><strong>Parte 1:  Aclarando conceptos.</strong></span></h2>\r\nLa arquitectura en 3 capas tambien conocida como MVC Modelo Vista Controlador (yo prefiero llamarle Modelo Controlador Vista).  Es la técnica más ordenada para crear una aplicación independientemente del lenguaje de programación que se utilice.\r\n\r\nÉsta metodologia simplifica mucho la escalabilidad (Scaffolding) y el mantenimiento.\r\n\r\nHector.  Mi profesor de Java hacia analogia con la ingenieria civil.  El ponia el ejemplo que un albañil te puede levantar un tabique o construir un baño.   Pero para construir un edificio se necesitan planos que te digan por donde van los conductos de agua, de electricidad, ventilacion etc etc.\r\n\r\nLa equivalencia de lo anterior seria lo siguiente:\r\n<ul>\r\n	<li>Albañil  -  Programador.</li>\r\n	<li>Los conductos, tabiques, columnas, etc. - Objetos.</li>\r\n	<li>Los planos - Diagrama de modelos.</li>\r\n</ul>\r\n<strong>¿Qué es un modelo?</strong>\r\n\r\nEs una clase, pero está situada en la capa mas baja de la arquitectura.  Un objeto modelo es un tipo abstracto de datos  (TAD para los que conocen MODULA-2) que represeta a una tabla en nuestra BD y por ende tiene relacion directa con los datos guardados.  Por esto debe contar con metodos de lectura y escritura.   Puede que dicho así no explique mucho de que se trata.  Pero mas adelante con los ejemplos se vera mejor.\r\n\r\n<strong>¿Qué es una Vista?</strong>\r\n\r\nEs la clase de capa 3.  La mas cercana al usuario final, comunmente conocida como formulario, tabla, informe.  Esta se encarga de presetar los datos obtenidos o que se van a enviar al servidor.\r\n\r\n<strong>¿Qué es un Controlador?</strong>\r\n\r\nEsta es una clase intermedia, capa 2, tambien llamada \"business layer\" que utiliza los datos tanto de la capa de presentacion (o Vista) como los del o los modelos que necesite.  Ésta deberia contar con la logica de negocio.\r\n\r\nPor ejemplo:\r\n\r\nSupongamos que tenemos nuestro modelo  Usuario y un formulario para agregar usuarios.   La logica que recuperaria los datos de los campos del formulario y los pasaria a nuestro modelo para que este con su metodo de insersion escriba en la BD deberia ir en el controlador.','Parte 1:Estos seran un conjuto de articulos que explicaran con ejemplos como planificar la solucion de una aplicacion utilizando el modelo entidad relacion, modelado de clases y la programación orientada a objetos.\r\nBreve introducción a la aquitectura MVC.','publish','arquitectura-en-3-capas-arquitectura-mvc-y-la-poo-1'),(7,'2010-09-03 20:30:48','2010-10-31 20:06:35','Arquitectura en 3 capas. Arquitectura MVC y la POO II','<h2><span style=\"color: #99cc00;\"><strong><strong>Parte 2:  El problema:</strong></strong></span></h2>\r\nSupongamos que necesitamos un programa que nos permita guardar usuarios y las ciudades donde han vivido.\r\n\r\nNo lo voy hacer muy complejo porque sino no acabo nunca.  Pues ese es el problema a tratar.\r\n\r\nAntes de picar código.  (poner ladrillos) Necesitamos crear nuestros planos.\r\n\r\nEmpezamos con nuestro modelo E/R.\r\n\r\n...continuará.','Parte 2: Se plantea un problema y partiendo desde este generamos un esquema E/R (entidad/relacion).','publish','arquitectura-en-3-capas-arquitectura-mvc-y-la-poo-2'),(8,'2010-09-03 20:45:57','2010-10-31 17:41:14','CCNA1','<h2><span style=\"color: #0000ff;\">Módulo 1: Introducción a networking</span></h2>\r\nLa Internet es la red de datos más importante del mundo. La Internet se compone de una gran cantidad de redes grandes y pequeñas interconectadas. Computadores individuales son las fuentes y los destinos de la información a través de la Internet. La conexión a Internet se puede dividir en conexión física, conexión lógica y aplicaciones.\r\n\r\nLos requisitos minimos para la conexión a una red:\r\n<ul>\r\n	<li><strong>Conexión fisica</strong></li>\r\n	<li><strong>Conexión logica</strong></li>\r\n	<li><strong>Aplicaciones que interpretan los datos y muestran la información.</strong></li>\r\n</ul>\r\nConexión fisica:<em> NIC (Network interface card) la tarjeta de red, Modem</em>.\r\n\r\nConexión logica: <em>Protocolos. Convenciones de como se transportara la informacion.  Por ejemplo TCP/IP.</em>\r\n\r\nAplicacion:<em> Navegadores web, programas clientes FTP, Reproductores de peliculas embebidos.</em>\r\n<ul>\r\n	<li>La velocidad de conexión era muy lenta, 300 bits por segundo (bps), lo que significaba aproximadamente 30 caracteres por segundo.</li>\r\n	<li>BBS permitieron que los usuarios se conectaran y enviaran o leyeran mensajes en un tablero de discusiones La velocidad de 300 bps era aceptable</li>\r\n	<li>1998. Línea de suscriptor digital (DSL) y el acceso de módem por cable, se trasladaron al mercado del consumidor.</li>\r\n</ul>\r\n<strong>Ping</strong>\r\n\r\nEl acrónimo computacional ping es la sigla para <span style=\"color: #333399;\"><em>Packet Internet or Inter-Network Groper</em></span>.\r\n\r\nEl comando ping funciona enviando paquetes IP especiales, llamados datagramas de petición de eco <strong>ICMP (<span style=\"color: #333399;\">Internet Control Message Protocol</span></strong>/<strong><em><span style=\"color: #888888;\">Protocolo de mensajes de control de Internet</span>) </em></strong>a un destino específico. <span style=\"color: #333399;\">Cada paquete que se envía es una petición de respuesta</span>. La pantalla de respuesta de un ping contiene la proporción de éxito y el tiempo de ida y vuelta del envío hacia llegar a su destino. A partir de esta información, es posible determinar si existe conectividad a un destino. <strong>El comando ping</strong> <em><span style=\"color: #333399;\">se utiliza para probar la función de transmisión/recepción de la NIC, la configuración TCP/IP y la conectividad de red.</span></em>\r\n\r\nSe pueden ejecutar los siguientes <strong>tipos de comando ping:</strong>\r\n\r\n<strong>• ping 127.0.0.1:</strong> Este es un tipo especial de ping que se conoce como prueba interna de <strong>loopback</strong>. Se usa para verificar la configuración de red TCP/IP.al recibir respuesta se puede asumir que el software asociado al  protocolo está bien (el hardware como la tarjeta de red no lo conocemos  con esta prueba, ya que no llega a salir del propio equipo).\r\n\r\n<strong>• ping direcciónc IP del computador host:</strong> Un ping a un PC host verifica la configuración de la dirección TCP/IP para el host local y la conectividad al host.\r\n<strong>• ping dirección IP de gateway por defecto:</strong> Un ping al gateway por defecto verifica si se puede alcanzar el router que conecta la red local a las demás redes.\r\n<strong>• ping dirección IP de destino remoto:</strong> Un ping a un destino remoto verifica la conectividad a un host remoto.\r\n\r\nLos ordenadores manejan la informacion en 2 estados (binario) 1 y 0.  El <span style=\"color: #333399;\">código americano normalizado para el intercambio de información</span><strong> (ASCII </strong><span style=\"color: #808080;\">American Standard Code for Information Interchange</span><strong>) </strong>es el código que se usa más a menudo para representar los datos alfanuméricos de un computador.  ASCII, se basa en el código de caracteres del <strong>alfabeto latino. </strong> <strong>ASCII utiliza 7 bits</strong> para representar los caracteres, aunque inicialmente empleaba <strong>un bit adicional (bit de paridad)</strong> que se usaba para detectar errores en la transmisión.\r\n\r\nCuando los computadores envían estados de  On/Off a través de una red, se usan ondas eléctricas, de luz o de radio para representar los unos y los ceros.  A veces, los números <strong>binarios </strong>se deben convertir en números <strong>Hexadecimales (hex)</strong>,<span style=\"color: #333399;\"> lo que reduce una larga cadena de dígitos binarios a unos pocos caracteres hexadecimales. Esto hace que sea más fácil recordar y</span> <span style=\"color: #333399;\">trabajar con los números.</span>\r\n\r\n<span style=\"color: #333399;\">\r\n</span>','Resumen del capitulo 1 del CCNA 1','publish','ccna1'),(9,'2010-09-04 14:04:42','2010-11-17 14:24:04','Carteleria y papeleria – Discoteca Samba Karamba.','<a rel=\"prettyPhoto[samba]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_tarjeta-de-visita-samba-karamba_lg-w700xh700.png\"><img class=\"alignnone size-thumbnail wp-image-519\" title=\"portfolio_tarjeta-de-visita-samba-karamba_lg-w700xh700\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_tarjeta-de-visita-samba-karamba_lg-w700xh700-150x150.png\" alt=\"\" width=\"150\" height=\"150\" /></a><a rel=\"prettyPhoto[samba]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_cartel-vertical-samba-karamba_lg-w567xh567.png\"><img class=\"alignnone size-thumbnail wp-image-518\" title=\"portfolio_cartel-vertical-samba-karamba_lg-w567xh567\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_cartel-vertical-samba-karamba_lg-w567xh567-150x150.png\" alt=\"\" width=\"150\" height=\"150\" /></a><a rel=\"prettyPhoto[samba]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_logotipo-samba-karamba_lg-w539xh539.png\"><img class=\"alignnone size-thumbnail wp-image-511\" title=\"portfolio_logotipo-samba-karamba_lg-w539xh539\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_logotipo-samba-karamba_lg-w539xh539-150x150.png\" alt=\"\" width=\"150\" height=\"150\" /></a><a rel=\"prettyPhoto[samba]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_cartel-horizontal-samba-karamba_lg-w836xh836.png\"><img class=\"alignnone size-thumbnail wp-image-516\" title=\"portfolio_cartel-horizontal-samba-karamba_lg-w836xh836\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_cartel-horizontal-samba-karamba_lg-w836xh836-150x150.png\" alt=\"\" width=\"150\" height=\"150\" /></a><a rel=\"prettyPhoto[samba]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_tarjeta-invitacion-samba-karamba_lg-w709xh709.png\"><img class=\"alignnone size-thumbnail wp-image-520\" title=\"portfolio_tarjeta-invitacion-samba-karamba_lg-w709xh709\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_tarjeta-invitacion-samba-karamba_lg-w709xh709-150x150.png\" alt=\"\" width=\"150\" height=\"150\" /></a>','Trabajos de diseño grafico.','publish','carteleria-y-papeleria-para-una-discoteca'),(10,'2010-09-04 19:06:27','2010-11-17 14:23:54','Flyers todaytours.es','<table>\r\n<tbody>\r\n<tr>\r\n<td><a rel=\"prettyPhoto[pp_gal]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_flyer-todaytours-especial-estudiantes_lg-w593xh842.png\"><img class=\"aligncenter\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_flyer-todaytours-especial-estudiantes_th-w113xh160.png\" alt=\"\" width=\"113\" height=\"160\" /></a></td>\r\n<td><a rel=\"prettyPhoto[pp_gal]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_flyer-todaytours-egypto-fantastico_lg-w595xh840.png\">\r\n<img class=\"aligncenter\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/portfolio_flyer-todaytours-egypto-fantastico_th-w113xh160.png\" alt=\"\" width=\"113\" height=\"160\" />\r\n</a></td>\r\n</tr>\r\n</tbody>\r\n</table>','Flyers promocionales ','publish','flyers-todaytours-es'),(11,'2010-09-10 20:49:40','2010-12-02 21:50:54','Mis links','<table class=\"stlTablaLinks\">\r\n<thead>\r\n<tr>\r\n<th>Vinculos</th>\r\n<th>Url</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr>\r\n<td>WP - Api wordpress</td>\r\n<td><a class=\"aligncenter\" title=\"WP Api de wordpress\" rel=\"nofollow\" href=\"http://wpdocs.labs.thedextrousweb.com/\" target=\"_blank\">http://wpdocs.labs.thedextrousweb.com/</a></td>\r\n</tr>\r\n<tr>\r\n<td>WP - Carpetas y archivos de wordpress</td>\r\n<td><a class=\"aligncenter\" title=\"WP Archivos de wordpress\" rel=\"nofollow\" href=\"http://phpxref.ftwr.co.uk/wordpress/nav.html\" target=\"_blank\">http://phpxref.ftwr.co.uk/wordpress/nav.html</a></td>\r\n</tr>\r\n<tr>\r\n<td>WP - links relevantes para wordpress</td>\r\n<td><a class=\"aligncenter\" title=\"WP Aprender wordpress\" rel=\"nofollow\" href=\"http://blog.ikhuerta.com/aprender-a-programar-en-wordpress\" target=\"_blank\">http://blog.ikhuerta.com/aprender-a-programar-en-wordpress</a></td>\r\n</tr>\r\n<tr>\r\n<td>Java - Definicion de una interfaz</td>\r\n<td><a class=\"aligncenter\" title=\"Java Ejemplo implementar interface en Java\" rel=\"nofollow\" href=\"http://www.java2s.com/Code/Php/Class/Interface.htm\" target=\"_blank\">http://www.java2s.com/Code/Php/Class/Interface.htm</a></td>\r\n</tr>\r\n<tr>\r\n<td>Maquetacion - Plantillas para blog</td>\r\n<td><a class=\"aligncenter\" title=\"Maquetacion Plantillas gratuitas para blogs\" rel=\"nofollow\" href=\"http://www.oswd.org/designs/browse/\" target=\"_blank\">http://www.oswd.org/designs/browse/</a></td>\r\n</tr>\r\n<tr>\r\n<td>CSS - Pseudo clases</td>\r\n<td><a class=\"aligncenter\" title=\"CSS Pseudo clases\" rel=\"nofollow\" href=\"http://www.sidar.org/recur/desdi/mcss/manual/pseudo.php\" target=\"_blank\">http://www.sidar.org/recur/desdi/mcss/manual/pseudo.php</a></td>\r\n</tr>\r\n<tr>\r\n<td>Php - Distintas formas de recorrer un array</td>\r\n<td><a class=\"aligncenter\" title=\"PHP Formas de recorrer un array\" rel=\"nofollow\" href=\"http://foro.undersecurity.net/read.php?11,674\" target=\"_blank\">http://foro.undersecurity.net/read.php?11,674</a></td>\r\n</tr>\r\n<tr>\r\n<td>Java - Free hosting</td>\r\n<td><a class=\"aligncenter\" title=\"Java Alojamiento gratuito\" rel=\"nofollow\" href=\"http://www.eatj.com/\" target=\"_blank\">http://www.eatj.com/</a></td>\r\n</tr>\r\n<tr>\r\n<td>Silverlight - Video tutoriales</td>\r\n<td><a class=\"aligncenter\" title=\"Silverlight Video tutoriales\" rel=\"nofollow\" href=\"http://www.silverlight.net/learn/videos/silverlight-videos/#HDI1Events\" target=\"_blank\">http://www.silverlight.net/learn/videos/silverlight-videos/#HDI1Events</a></td>\r\n</tr>\r\n<tr>\r\n<td>VoIP - Usar telefono para llamadas gratuitas</td>\r\n<td><a class=\"aligncenter\" title=\"VoIP tutorial\" rel=\"nofollow\" href=\"http://www.clubnseries.com/tutoriales/30-tutorial-llamadas-gratis-via-wi-fi-voip-con-n80-y-gizmo.html\" target=\"_blank\">http://www.clubnseries.com/tutoriales/30-tutorial-llamadas-gratis-via-wi-fi-voip-con-n80-y-gizmo.html</a></td>\r\n</tr>\r\n<tr>\r\n<td>Counter Strike - Lista de servidores no steam</td>\r\n<td><a class=\"aligncenter\" title=\"Counter Strike Servidores no steam\" rel=\"nofollow\" href=\"http://css.setti.info/servers/full/\" target=\"_blank\">http://css.setti.info/servers/full/</a></td>\r\n</tr>\r\n<tr>\r\n<td>Wordpress - Desarrollando un plugin</td>\r\n<td><a class=\"aligncenter\" rel=\"nofollow\" href=\"http://dougal.gunters.org/blog/2009/09/26/wordpress-plugin-development-presentation\" target=\"_blank\">http://dougal.gunters.org/blog/2009/09/26/wordpress-plugin-development-presentation</a></td>\r\n</tr>\r\n<tr>\r\n<td>Wordpress hooks - API Acciones</td>\r\n<td><a class=\"aligncenter\" rel=\"nofollow\" href=\"http://codex.wordpress.org/Plugin_API/Action_Reference\" target=\"_blank\">http://codex.wordpress.org/Plugin_API/Action_Reference</a></td>\r\n</tr>\r\n<tr>\r\n<td>Wordpress hooks - API Filtros</td>\r\n<td><a class=\"aligncenter\" rel=\"nofollow\" href=\"http://codex.wordpress.org/Plugin_API/Filter_Reference\" target=\"_blank\">http://codex.wordpress.org/Plugin_API/Filter_Reference</a></td>\r\n</tr>\r\n<tr>\r\n<td></td>\r\n<td><a class=\"aligncenter\" rel=\"nofollow\" target=\"_blank\"></a></td>\r\n</tr>\r\n</tbody>\r\n</table>','','publish','mis-links'),(12,'2010-10-11 23:35:23','2010-12-02 22:33:44','Herramienta de gestión de base de datos SQLyog','Sobre SQLyog.','SQLyog es un excelente gestor de base de datos.  Te permite llevar el control de varias BBDD local y remotamente.  Esta ultima opcion es muy potente ya que puede forzar la gestion de un servidor remoto asi este tenga los puertos bloqueados.','publish','herramienta-gestion-base-de-datos-sqlyog'),(13,'2010-10-12 14:38:16','2010-11-17 14:23:16','Folleto Today tours 2008','','Folleto en formato PDF','publish','folleto-todaytours-200'),(14,'2010-11-06 12:21:30','2010-12-15 23:05:51','Depuración en php de forma oculta','Cuando se trabaja en producción (sobre los archivos de la aplicación \"trunk\"), práctica poco aconsejable en programación.   Muchas veces es necesario hacer una depuración, el tipico <span style=\"color: #3366ff;\">var_dump(</span><span style=\"color: #993300;\">$Variable</span><span style=\"color: #3366ff;\">)</span><strong> </strong>de una variable.\r\n\r\nNo está bien por seguridad y por estética renderizar el contenido para cualquier usuario.\r\n\r\nCon esto quiero decir que si tenemos una aplicación web en php que está siendo utilizada y debemos hacer la traza de algunos datos, por ejemplo un arreglo con distintos campos privados, como el nombre de una tabla, el nombre del servidor,  el email de un usuario etc.   Si ejecutamos: var_dump($arArreglo), escribiremos en pantalla y todos los usuarios que esten haciendo uso de la misma veran el contenido.\r\n\r\nPor eso me he creado mi función personalizada.  Esta llamada \"<strong>mibug</strong>\" la describo a continuacion.  Logicamente esta solo servira si se cuenta con más de una ip pública.  Ejemplo: El dpto. de software de una empresa sale a internet por un router y el resto de departamentos por otro.   ...continuamos.\r\n\r\nUna idea de donde la puedes colocar es en:\r\n\r\n<strong>CakePHP</strong>:  archivo <strong><em>bootstrap</em></strong>\r\n\r\n<strong>Wordpress</strong>:  archivo<strong> <em>functions.php</em></strong>\r\n\r\no en un archivo tipo configuracion p.e. <strong><em>configure.php</em></strong>, que este disponible en todo tu proyecto\r\n<pre class=\"brush: php\">//$Variable: mixed. La variable de cualquier tipo a visualizar\r\n//$sNombreVariable: String. Opcional. Muestra el nombre de la variable que se va\r\n//a visualizar.\r\n//$isDie: boolean. Opcional. Se indica si despues del var_dump se acabara la ejecucion\r\n//del script.\r\nfunction mibug($Variable, $sNombreVariable=\'\', $isDie=false)\r\n{\r\n    //MIIP: Constante global definida en un archivo con alcance desde\r\n    //cualquier parte de tu proyecto.\r\n    if($_SERVER[\'REMOTE_ADDR\']==MIIP)\r\n    {\r\n        echo \"&lt;br /&gt;&lt;br /&gt;====MI BUG ====\";\r\n        echo \"&lt;br /&gt;Variable: \" . $sNombreVariable . \"&lt;br /&gt;&lt;br /&gt;\";\r\n        var_dump($Variable);\r\n        echo \"&lt;br /&gt;&lt;br /&gt;====FIN $sNombreVariable =====\";\r\n        if($isDie)\r\n        {\r\n            die;\r\n        }\r\n    }\r\n}\r\n</pre>\r\nPreviamente a esto habria que definir una \"CONSTANTE\" global.  La creariamos al igual que la funcion anterior.  En algun archivo de caracter global.  Un link que te puede ayudar a descubrir cual es tu ip pública es: \"http://www.cualesmiip.com\"\r\n<pre class=\"brush: php\">//En CakePHP: archivo bootstrap\r\n//En Wordpress: archivo functions.php\r\n//o en un archivo tipo configuracion p.e. configure.php, que este\r\n//disponible en todo tu proyecto\r\n\r\ndefine(\'MIIP\',\'89.129.241.143\');\r\n</pre>\r\n<h4>Ejemplo:</h4>\r\n<pre class=\"brush: php\">//Trozo de codigo en wordpress.\r\n//get_post_meta. Funcion que devuelve el contenido de tus campos personalizados, en este tengo uno llamado \'imagen-thumb-lista\'\r\n$sUrlThumb = get_post_meta($post-&gt;ID, \"imagen-thumb-lista\", true);\r\n//llamo a mi funcion definida en functions.php\r\nmibug($sUrlThumb,\'$sUrlThumb\');\r\n</pre>\r\n<h4>Resultado:</h4>\r\n<pre><span style=\"color: #0000ff;\">========MI BUG ======\r\nVariable: $sUrlThumb\r\n\r\nstring(98) \"http://www.eduardoaf.com/thumbs/articulos/mi-thumb-01.jpg\"\r\n\r\n======FIN $sUrlThumb ====</span></pre>','Hay trozos de codigo tan simples pero al mismo tiempo tan útiles que su continua reutilización nos lleva a transformalo en una función o metodo. En mi caso:  if ( $_SERVER[\'REMOTE_ADDR\']==MIIP ) junto a var_dump( ).  Por eso personalice mi propio \"var_dump()\"  en una función llamada \"mibug\".','publish','depuracion-en-php-de-forma-oculta'),(15,'2010-11-16 21:09:26','2012-06-10 17:19:48','Visual Basic – Aplicación para escanear version 1.0.0 ','<strong>DEFINICION</strong>:\r\n<em>Qué hace?</em>\r\n\r\nAl dar de alta un usuario se debe llenar un campo obligatorio que es el número de pasaporte.  Seguidamente con este numero se crea una pequeña galeria con las paginas que se van escaneando del pasaporte en cuestion.\r\n\r\nLos datos del usuario y de sus imágenes escaneadas se guardan en una Base de datos de MS Access.\r\n\r\n<strong>ESPECIFICACION</strong>:\r\n<em>Cómo lo hace?</em>\r\n\r\nLa aplicacion utiliza unos controles ocx especiales que venian en Windows 98 y 2000.  (Imaging).  Una vez guardado el usuario en la BD se deja a modo temporal su nº de pasaporte.  Con el control image manager se gestiona el resto de controles y se guarda en el disco la imagen escaneada aplicando al nombre el número.\r\n\r\n<span style=\"color: #ff9900;\"><strong>Descarga el código fuente <a title=\"Descargar el proyecto en formato .rar\" href=\"http://downloads.eduardoaf.com/packages/app-escanear-v1.0.0.rar\" target=\"_blank\">aqui</a>.</strong></span>\r\n\r\n<strong>Imagenes</strong>:\r\n\r\n<a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-001_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-001_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-002_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-002_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-003_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-003_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-004_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-004_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-005_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-005_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-006_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-006_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-007_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-007_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-008_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-008_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-010_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-010_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a><a rel=\"prettyPhoto[app]\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-011_lg.jpg\"><img class=\"alignnone\" style=\"margin: 2px; border: 1px solid grey;\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/app-scan-v1-011_th.jpg\" alt=\"\" width=\"113\" height=\"160\" /></a>\r\n\r\nNota:  Si deseas ver la programación (codigo fuente) lo puedes hacer en las últimas páginas.\r\n\r\n<!--nextpage-->\r\n\r\n<strong>Código fuente de:</strong><strong> frmClientes.frm</strong>\r\n<pre class=\"brush: vb\">Option Explicit\r\n\'Mi objeto de conexion\r\nPublic oConx As ADODB.Connection\r\n\'Mi objeto tabla con conexion persistente\r\nPublic WithEvents oRsCliente As ADODB.Recordset\r\n\'Las imagenes y el id de los clientes tendran el formato CLIxxx siendo xxx un entero\r\nPrivate Const sCPrefijo As String = \"CLI\"\r\n\r\nDim sRutaFoto As String\r\nDim sExiste As String\r\nDim sNombreArchivo As String\r\nDim dFechaDemo As Date\r\nDim vAuxiliar As Variant\r\nDim iTotalRegistros, i, j, iZoom As Long\r\n\r\n\'Lee la variable globla sNombreArchivo, con esta crea la sRutaArchivo completa\r\n\'e intenta recuperarla.  Si lo consigue la muestra sino desactiva los controles\r\nPrivate Sub cargar_imagen()\r\n\r\n    On Error GoTo isError:\r\n        \'activo la barra horizontal de zoom\r\n        hsbZoom.Enabled = True\r\n        \'Creo la sRutaArchivo completa hasta la foto\r\n        sRutaFoto = CStr(App.Path &amp; \"\\fotos\\\" &amp; sNombreArchivo &amp; \".jpg\")\r\n        \'Intento obtener el nombre de la foto\r\n        sExiste = Dir(sRutaFoto) \'devuelve nomarchivo.jpg si existe en sRutaFoto\r\n\r\n        iZoom = 33\r\n\r\n        If sExiste = \"\" Then  \'si no existe la imagen\r\n            \'imePantalla es el control imageEdit que se usa para ir mostrando las imagenes\r\n            \'segun se posiciona en el cliente\r\n            imePantalla.Visible = False \'Escondemos la pantalla\r\n            hsbZoom.Enabled = False     \'Escondemos la barra de zoom\r\n        Else  \'si existe la imagen\r\n            imePantalla.Visible = True\r\n            lblValorZoom.Caption = iZoom\r\n            imePantalla.Image = sRutaFoto\r\n            imePantalla.Display\r\n            imePantalla.Zoom = iZoom\r\n            imePantalla.Refresh\r\n        End If\r\n\r\n        Exit Sub\r\nisError:\r\n    MsgBox \"Ocurrio error al cargar imagen\", vbCritical, \"Clientes UC\"\r\n\r\nEnd Sub\r\nPublic Function Buscar(oRecordSet As ADODB.Recordset, sIdCliente As String)\r\n\r\n    oRecordSet.MoveFirst\r\n\r\n    If oRecordSet.EOF Then\r\n        oRecordSet.MoveFirst\r\n    End If\r\n\r\n    While Not oRecordSet(\"IDCLI\") = sIdCliente\r\n        oRecordSet.MoveNext\r\n    Wend\r\n    \'Actualizo la posicion del puntero en el txt\r\n    txtRegActual.Text = oRecordSet.AbsolutePosition\r\n    \'Actualizo la variable global sNombreArchivo con el id\r\n    sNombreArchivo = sIdCliente\r\n    \'Intenta cargar la imagen en el control imePantalla\r\n    cargar_imagen\r\n\r\nEnd Function\r\n\r\nPublic Function Primero(oRecordSet As ADODB.Recordset, txtRegActual As TextBox)\r\n\r\n    If oRecordSet.RecordCount = 0 Then\r\n        MsgBox \"NO HAY REGISTROS PARA HACER RECORRIDO\", vbExclamation, _\r\n        \"INFORMACION DE RECORRIDO\"\r\n        txtRegActual.Text = 0\r\n    ElseIf oRecordSet.RecordCount &gt; 0 Then\r\n        If oRecordSet.AbsolutePosition = 1 Then\r\n            MsgBox \"YA ESTA EN EL PRIMER REGISTRO\", vbExclamation, _\r\n            \"INFORMACION DE RECORRIDO\"\r\n        End If\r\n        oRecordSet.MoveFirst\r\n        txtRegActual.Text = oRecordSet.AbsolutePosition\r\n    End If\r\n\r\nEnd Function\r\nPublic Function Ultimo(oRecordSet As ADODB.Recordset, txtRegActual As TextBox)\r\n\r\n    If oRecordSet.RecordCount = 0 Then\r\n        MsgBox \"NO HAY REGISTROS PARA HACER RECORRIDO\", vbExclamation, _\r\n        \"INFORMACION DE RECORRIDO\"\r\n        txtRegActual.Text = 0\r\n    ElseIf oRecordSet.RecordCount &gt; 0 Then\r\n        If oRecordSet.AbsolutePosition = oRecordSet.RecordCount Then\r\n            MsgBox \"YA ESTA EN EL ULTIMO REGISTRO\", vbExclamation, _\r\n            \"INFORMACION DE RECORRIDO\"\r\n        End If\r\n        oRecordSet.MoveLast\r\n        txtRegActual.Text = oRecordSet.AbsolutePosition\r\n    End If\r\n\r\nEnd Function\r\nPublic Function Siguiente(oRecordSet As ADODB.Recordset, txtRegActual As TextBox)\r\n\r\n    If oRecordSet.RecordCount &gt; 0 Then\r\n        oRecordSet.MoveNext\r\n        If oRecordSet.EOF Then\r\n            MsgBox \"YA ESTA EN EL ULTIMO REGISTRO\", vbExclamation, _\r\n            \"INFORMACION DE RECORRIDO\"\r\n            oRecordSet.MoveLast\r\n        End If\r\n        txtRegActual.Text = oRecordSet.AbsolutePosition\r\n    ElseIf oRecordSet.RecordCount = 0 Then\r\n        txtRegActual.Text = 0\r\n    End If\r\n\r\nEnd Function\r\nPublic Function Anterior(oRecordSet As ADODB.Recordset, txtRegActual As TextBox)\r\n\r\n    If oRecordSet.RecordCount &gt; 0 Then\r\n        oRecordSet.MovePrevious\r\n       If oRecordSet.BOF Then\r\n            MsgBox \"YA ESTA EN EL PRIMER REGISTRO\", vbExclamation, _\r\n            \"INFORMACION DE RECORRIDO\"\r\n            oRecordSet.MoveFirst\r\n        End If\r\n        txtRegActual.Text = oRecordSet.AbsolutePosition\r\n    ElseIf oRecordSet.RecordCount = 0 Then\r\n        txtRegActual.Text = 0\r\n    End If\r\n\r\nEnd Function\r\nPrivate Sub cmdAceptar_Click()\r\n\r\n    If txtNombre.Text = \"\" Then\r\n        MsgBox \"This field can\'t be empty\", vbExclamation, \"EMPTY FIELD!!\"\r\n        txtNombre.SetFocus\r\n        GoTo isError\r\n    End If\r\n\r\n    If txtApellidos.Text = \"\" Then\r\n        MsgBox \"This field can\'t be empty\", vbExclamation, \"EMPTY FIELD!!\"\r\n        txtApellidos.SetFocus\r\n        GoTo isError\r\n    End If\r\n\r\n    If txtNPasaporte.Text = \"\" Then\r\n        MsgBox \"This field can\'t be empty\", vbExclamation, \"EMPTY FIELD!!\"\r\n        txtNPasaporte.SetFocus\r\n        GoTo isError\r\n    End If\r\n\r\n    Select Case lblAC.Caption\r\n        Case \"AGREGAR\"\r\n            MsgBox \"Usuario Añadido\", vbInformation + vbOKOnly, \"AGREGAR\"\r\n            fraRec.Visible = True\r\n            txtRegActual.Text = oRsCliente.AbsolutePosition\r\n            txtTotalRegistros.Text = oRsCliente.RecordCount\r\n            oRsCliente.Update\r\n        Case \"MODIFICAR\"\r\n            MsgBox \"Usuario Modificado\", vbInformation + vbOKOnly, \"MODIFICAR\"\r\n            fraRec.Visible = True\r\n            oRsCliente.Update\r\n        Case Else\r\n    End Select\r\n\r\n    \'se pasa todo como si se estuviera recorriendo\r\n    lblAC.Visible = False\r\n    fraAC.Visible = False\r\n    fraOpc.Visible = True\r\n\r\n    txtNombre.Enabled = False\r\n    txtApellidos.Enabled = False\r\n    txtNPasaporte.Enabled = False\r\n\r\nisError:\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdAgregar_Click()\r\n\'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\r\n    iTotalRegistros = oRsCliente.RecordCount\r\n    If iTotalRegistros = 0 Then\r\n        i = 1\r\n    Else\r\n        ReDim matid(1 To iTotalRegistros) As Long\r\n        oRsCliente.MoveFirst\r\n        For i = 1 To iTotalRegistros\r\n            matid(i) = CLng(Replace(oRsCliente.Fields(0), sCPrefijo, \"\"))\r\n            oRsCliente.MoveNext\r\n        Next\r\n        For i = 1 To iTotalRegistros\r\n            For j = 1 To iTotalRegistros\r\n                If i = matid(j) Then\r\n                    \'i no disponible porque esta en el arreglo\r\n                    Exit For\r\n                End If\r\n            Next\r\n            If j - 1 = iTotalRegistros And i &lt;&gt; matid(iTotalRegistros) Then \'si i!= hasta del ultimo elemento (j=tregs)\r\n                    \'i disponible\r\n                    Exit For\r\n            End If\r\n        Next\r\n    End If\r\n\'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\r\n\r\n    \'por defecto se hace esto con AGREGAR,MODIFICAR,baja ..\r\n    fraOpc.Visible = False\r\n    fraRec.Visible = False\r\n    fraAC.Visible = True\r\n    lblAC.Visible = True\r\n    lblAC.BackColor = &amp;H0&amp;\r\n    lblAC.ForeColor = &amp;HFFFFFF\r\n    lblAC.Caption = \"AGREGAR\"\r\n    Caption = \"USUARIOS [AGREGAR]\"\r\n    \'...hasta aqui\r\n\r\n    \'activamos campos\r\n    txtNombre.Enabled = True\r\n    txtApellidos.Enabled = True\r\n    txtNPasaporte.Enabled = True\r\n    cmdDigitalizar.Visible = True\r\n\r\n    \'Preparamos la tabla para agregar un registro\r\n    oRsCliente.AddNew\r\n\r\n    txtIdCliente.Text = \"\"\r\n    txtNombre.Text = \"\"\r\n    txtApellidos.Text = \"\"\r\n    txtNPasaporte.Text = \"\"\r\n    imePantalla.Visible = False\r\n    txtIdCliente.Text = UCase(Trim(sCPrefijo) &amp; Trim(Str(i))) \'getID(sCPrefijo, oRsCliente)\r\n    txtNombre.SetFocus\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdEliminar_Click()\r\n    If oRsCliente.RecordCount &gt; 1 Then\r\n        Dim resp As Integer\r\n        resp = MsgBox(\"¿Eliminar Cliente?\", vbExclamation + vbOKCancel, \"BAJA\")\r\n        If resp = 1 Then\r\n\r\n            oRsCliente.Delete\r\n            oRsCliente.Update\r\n            txtTotalRegistros.Text = oRsCliente.RecordCount\r\n            sExiste = Dir(sRutaFoto)\r\n            If sExiste = \"blanco.jpg\" Then\r\n\r\n            ElseIf sExiste &lt;&gt; \"\" Then\r\n                Kill (sRutaFoto)\r\n            End If\r\n        End If\r\n        cmdAnterior_Click\r\n        If frmBuscar.isCargado Then\r\n            frmBuscar.cmdAceptar_Click\r\n        End If\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Sub cmdBuscar_Click()\r\n    frmBuscar.Show\r\nEnd Sub\r\n\r\nPrivate Sub cmdCancelar_Click()\r\n    Select Case lblAC.Caption\r\n        Case \"AGREGAR\"\r\n            oRsCliente.CancelUpdate\r\n            \'MsgBox \"No se añadio Usuario\", vbInformation + vbOKOnly, \"AGREGAR\"\r\n        Case \"MODIFICAR\"\r\n            oRsCliente.CancelUpdate  \'AQUI DEBERIA VERSE LO NO MODIFICADO\r\n            \'MsgBox \"No se edito Usuario\", vbInformation + vbOKOnly, \"MODIFICAR\"\r\n        Case Else\r\n    End Select\r\n    \'se pasa todo como si se estuviera recorriendo\r\n    lblAC.Visible = False\r\n    fraRec.Visible = True\r\n    fraAC.Visible = False\r\n    fraOpc.Visible = True\r\n\r\n    txtNombre.Enabled = False\r\n    txtApellidos.Enabled = False\r\n    txtNPasaporte.Enabled = False\r\n\r\n    If oRsCliente.RecordCount = 0 Then\r\n\r\n    ElseIf oRsCliente.RecordCount = 1 Then\r\n        oRsCliente.MoveFirst\r\n    ElseIf oRsCliente.RecordCount &gt; 1 Then\r\n        oRsCliente.MoveLast\r\n    End If\r\n\r\nEnd Sub\r\nPrivate Sub cmdEditar_Click()\r\n    \'por defecto se hace esto con AGREGAR,MODIFICAR,baja ..\r\n    fraOpc.Visible = False\r\n    fraRec.Visible = False\r\n    fraAC.Visible = True\r\n    lblAC.Visible = True\r\n    lblAC.BackColor = &amp;H0&amp;\r\n    lblAC.ForeColor = &amp;HFFFFFF\r\n    lblAC.Caption = \"MODIFICAR\"\r\n    Caption = \"USUARIOS [EDITANDO]\"\r\n    \'...hasta aqui\r\n\r\n    \'se activan los campos para poder modificarlos\r\n    txtNombre.Enabled = True\r\n    txtApellidos.Enabled = True\r\n    txtNPasaporte.Enabled = True\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdDigitalizar_Click()\r\n\r\n    frmEscanear.cmdObtenerImagen_Click\r\n    frmEscanear.Show vbModal\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdTab_Click()\r\n\r\nEnd Sub\r\n\r\n\'Al llamar al panel de control\r\nPrivate Sub Form_Initialize()\r\n\r\n    On Error GoTo isError:\r\n        \'Intento crear la carpeta Fotos si no sExiste\r\n        MkDir (App.Path &amp; \"\\\" &amp; \"Fotos\")\r\n        FileCopy App.Path &amp; \"\\blanco.jpg\", App.Path &amp; \"\\Fotos\\blanco.jpg\"\r\n        Kill (App.Path &amp; \"\\blanco.jpg\")\r\n        Exit Sub\r\n\r\nisError:\r\n    \'MsgBox \"err\"\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_KeyPress(KeyAscii As Integer)\r\n    If KeyAscii = vbKeyF1 Then\r\n        cmdBuscar_Click\r\n        KeyAscii = 0\r\n    ElseIf KeyAscii = vbKeyF2 Then\r\n        cmdDigitalizar_Click\r\n        KeyAscii = 0\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n\'    dFechaDemo = Date\r\n\'    If (dFechaDemo &gt;= #12/15/2005#) Then\r\n\'        MsgBox \"TIME FOR DEMO IS UP!!, FOR INFO:eacevedof@yahoo.es\", vbOKOnly + vbExclamation, \"PROGRAMA DEMO\"\r\n\'        Unload Me\r\n\'        Exit Sub\r\n\'    End If\r\n\r\n    \'Creo mi objeto Conexion y lo configuro\r\n    Set oConx = New ADODB.Connection\r\n    oConx.Provider = \"Microsoft.jet.oledb.4.0\"\r\n    oConx.CursorLocation = adUseClient\r\n    oConx.ConnectionString = App.Path &amp; \"\\uc.mdb\"\r\n    oConx.Open\r\n\r\n    \'Creo mi objeto Recorset sobre la tabla que voy a trabajar\r\n    Set oRsCliente = New ADODB.Recordset\r\n    oRsCliente.ActiveConnection = oConx     \'conexion que utilizara\r\n    oRsCliente.Source = \"CLIENTES\"          \'Nombre de la tabla\r\n    oRsCliente.CursorType = adOpenDynamic   \'Como se movera el puntero\r\n    oRsCliente.LockType = adLockOptimistic  \'La recurrencia es de tipo optimista\r\n    oRsCliente.Open                         \'Recupero los datos\r\n\r\n    \'Bindeo mis controles con los campos que le corresponden\r\n    \'El bindeo tiene un efecto de lectura y escritura en tiempo real\r\n    \'dependiendo de sobre que registro esta el cursor (absolutepostion)\r\n\r\n    Set txtIdCliente.DataSource = oRsCliente       \'La fuente de datos (la tabla)\r\n    txtIdCliente.DataField = \"IDCLI\"               \'El nombre del campo en la tabla\r\n    Set txtNombre.DataSource = oRsCliente\r\n    txtNombre.DataField = \"NOMBRE\"\r\n    Set txtApellidos.DataSource = oRsCliente\r\n    txtApellidos.DataField = \"APELLIDO\"\r\n    Set txtNPasaporte.DataSource = oRsCliente\r\n    txtNPasaporte.DataField = \"N_PASAPORTE\"\r\n\r\n    If oRsCliente.RecordCount = 0 Then\r\n        txtRegActual.Text = 0\r\n    Else\r\n        txtRegActual.Text = oRsCliente.AbsolutePosition\r\n    End If\r\n\r\n    \'Configuro la posicion de mi formulario\r\n    Top = 650\r\n    Left = 2100\r\n\r\n    txtTotalRegistros.Text = oRsCliente.RecordCount\r\n    sNombreArchivo = txtIdCliente.Text\r\n\r\n    cargar_imagen\r\n\r\n    hsbZoom.Value = iZoom\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdAnterior_Click()\r\n\r\n    On Error GoTo isError:\r\n        \'llama a la funcion para moverse al anterior registro\r\n        vAuxiliar = Anterior(oRsCliente, txtRegActual)\r\n        txtTotalRegistros.Text = oRsCliente.RecordCount\r\n        cargar_imagen\r\n        hsbZoom.Value = iZoom\r\n        Exit Sub\r\nisError:\r\n    sNombreArchivo = oRsCliente(\"IDCLI\")\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdPrimero_Click()\r\n\r\n    On Error GoTo isError:\r\n        vAuxiliar = Primero(oRsCliente, txtRegActual)\r\n        sNombreArchivo = oRsCliente(\"IDCLI\")\r\n        txtTotalRegistros.Text = oRsCliente.RecordCount\r\n        cargar_imagen\r\n        hsbZoom.Value = iZoom\r\n        Exit Sub\r\nisError:\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdSiguiente_Click()\r\n\r\n    On Error GoTo isError:\r\n        vAuxiliar = Siguiente(oRsCliente, txtRegActual)\r\n        sNombreArchivo = oRsCliente(\"IDCLI\")\r\n        txtTotalRegistros.Text = oRsCliente.RecordCount\r\n        cargar_imagen\r\n        hsbZoom.Value = iZoom\r\n        Exit Sub\r\nisError:\r\n\r\nEnd Sub\r\nPrivate Sub cmdUltimo_Click()\r\n\r\n    On Error GoTo isError:\r\n        vAuxiliar = Ultimo(oRsCliente, txtRegActual)\r\n        sNombreArchivo = oRsCliente(\"IDCLI\")\r\n        txtTotalRegistros.Text = oRsCliente.RecordCount\r\n        cargar_imagen\r\n        hsbZoom.Value = iZoom\r\n        Exit Sub\r\nisError:\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)\r\n\r\n    If frmEscanear.isCargado Then\r\n        Unload frmEscanear\r\n    End If\r\n\r\n    If frmBuscar.isCargado Then\r\n        Unload frmBuscar\r\n    End If\r\n\r\n    Set oRsCliente = Nothing\r\n    Set oConx = Nothing\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    \'Descargo todos mis formularios\r\n    Set frmClientes = Nothing\r\n    Set frmEscanear = Nothing\r\n    Set frmBuscar = Nothing\r\n\r\nEnd Sub\r\n\'Al desplazar la barra de zoom\r\nPrivate Sub hsbZoom_Change()\r\n\r\n    On Error GoTo isError:\r\n        \'Actualizo el label con el zoom\r\n        lblValorZoom.Caption = hsbZoom.Value\r\n        \'Le aplico el zoom al control imageEdit\r\n        imePantalla.Zoom = hsbZoom.Value\r\n        \'Refresco la vista\r\n        imePantalla.Refresh\r\n        Exit Sub\r\nisError:\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Label1_Click()\r\n\r\nEnd Sub\r\n\r\nPrivate Sub txtRegActual_GotFocus()\r\n    cmdSiguiente.SetFocus\r\nEnd Sub\r\n\r\nPrivate Sub txtApellidos_LostFocus()\r\n\r\n    txtApellidos.Text = Trim(txtApellidos.Text)\r\n    txtApellidos.Text = UCase(txtApellidos.Text)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub txtNombre_LostFocus()\r\n\r\n    txtNombre.Text = Trim(txtNombre.Text)\r\n    txtNombre.Text = UCase(txtNombre.Text)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub txtNPasaporte_LostFocus()\r\n\r\n    txtNPasaporte.Text = Trim(txtNPasaporte.Text)\r\n    txtNPasaporte.Text = UCase(txtNPasaporte.Text)\r\n\r\nEnd Sub\r\n\r\nPrivate Sub txtTotalRegistros_GotFocus()\r\n    cmdSiguiente.SetFocus\r\nEnd Sub</pre>\r\n<!--nextpage-->\r\n\r\n<strong>Código fuente de:</strong><strong> frmEscanear.frm</strong>\r\n<pre class=\"brush: vb\">Option Explicit\r\nDim sNombreArchivo As String\r\nPublic isCargado As Boolean\r\nPublic sExiste As String\r\nPublic sCalidadImagen As String\r\nPublic sRutaArchivo As String\r\n\r\nPrivate Sub cmdSalir_Click()\r\n\r\nOn Error GoTo isError\r\n    \'Activo los controles el formulario de clientes\r\n    frmClientes.imePantalla.Visible = True\r\n    frmClientes.imePantalla.Image = txtDestino.Text\r\n    frmClientes.imePantalla.Zoom = 33\r\n    frmClientes.imePantalla.Display\r\n    \'Descargo este formulario (Escanear)\r\n    Unload Me\r\nisError:\r\n    Unload Me\r\n\r\nEnd Sub\r\nPublic Sub cmdGuardar_Click()\r\n\r\nOn Error GoTo isError:\r\n    sRutaArchivo = App.Path &amp; \"\\FOTOS\\\" &amp; sNombreArchivo\r\n    imePrevisualizar.Refresh\r\n\'    imaSca.InitDir = App.Path &amp; \"\\FOTOS\"\r\n\'    imaSca.DialogTitle = \"Guardar como bmp\"\r\n\'    imaSca.Filter = \"BMP files|*.bmp|\"\r\n\'    imaSca.Image = sNombreArchivo\r\n\'    imaSca.ShowFileDialog SaveDlg\r\n\'    imePrevisualizar.SaveAs imaSca.Image &amp; \".bmp\", 3\r\n    \'error al cancelar\r\n    \'Guardo la imagen como bmp que es el formato que permite el control\r\n    \'imageEdit\r\n    imePrevisualizar.SaveAs sRutaArchivo &amp; \".bmp\", 3\r\n    \'Guardo las rutas de origen y destino en los txt\r\n    txtOrigen.Text = sRutaArchivo &amp; \".bmp\"\r\n    txtDestino.Text = sRutaArchivo &amp; \".jpg\"\r\n    \'configuro la compresion del archivo .jpg\r\n    sCalidadImagen = \"75\"\r\n    \'Con el control picformat transformo de bmp a jpg\r\n    \'tienen q ser objetos txt.text sino no funciona picformat\r\n    PicFormat321.SaveBmpToJpeg txtOrigen.Text, txtDestino.Text, sCalidadImagen\r\n    \'Compruebo que existe el .bmp\r\n    sExiste = Dir(txtOrigen.Text)\r\n    \'Si existe lo elimino\r\n    If sExiste &lt;&gt; \"\" Then\r\n        Kill (txtOrigen.Text)\r\n    End If\r\n\r\n    \'activo los controles de frmClientes\r\n    \'descargo este formulario\r\n    cmdSalir_Click\r\n\r\n    Exit Sub\r\n\r\nisError:\r\n    MsgBox \"Ocurrio error al guardar imagen\", vbCritical, \"Clientes UC\"\r\n    imsControlador.CloseScanner\r\n\r\nEnd Sub\r\nPublic Sub cmdObtenerImagen_Click()\r\n\r\nOn Error GoTo isError:\r\n\r\n    If Not imsControlador.ScannerAvailable Then\r\n        MsgBox \"No hay escáner disponible\", vbCritical, \"Interface de Escáner\"\r\n        Exit Sub\r\n    End If\r\n    \'control imgScan: es un intermediario entre el controlador\r\n    \'del scanner y los controles de la aplicacion\r\n    imsControlador.OpenScanner\r\n    imsControlador.FileType = BMP_Bitmap\r\n    imsControlador.ScanTo = DisplayOnly\r\n    imsControlador.StartScan\r\n    imePrevisualizar.Zoom = 45\r\n    imsControlador.CloseScanner\r\n\r\n    Exit Sub\r\n\r\nisError:\r\n    imsControlador.StopScan\r\n    imsControlador.CloseScanner\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n    \'Indico que este formulario esta cargado\r\n    isCargado = True\r\n\r\n    Top = 650\r\n    Left = 2000\r\n\r\n    sNombreArchivo = frmClientes.txtIdCliente.Text\r\n\r\n    imePrevisualizar.DisplayBlankImage 4850, 3450\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)\r\n    \'Indico que este formulario esta descargado\r\n    isCargado = False\r\nEnd Sub\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n\r\n    imsControlador.CloseScanner\r\n    Set frmEscanear = Nothing\r\n\r\nEnd Sub</pre>\r\n<!--nextpage-->\r\n\r\n<strong>Código fuente de: frmBuscar.frm</strong>\r\n<pre class=\"brush: vb\">Option Explicit\r\n\r\nPublic WithEvents oRsBuscar As ADODB.Recordset\r\nDim oCommand As ADODB.Command   \'Objeto que nos permitira la ejecucion de sentencias SQL\r\nDim sSQL, sIdCliente As String\r\nPublic isCargado As Boolean  \'Para detectar si este formulario está cargado\r\nDim vAuxiliar As Variant\r\n\r\nPublic Sub cmdAceptar_Click()\r\n\r\n    If txtNombre.Text &lt;&gt; \"\" And txtApellidos.Text &lt;&gt; \"\" Then\r\n        sSQL = \"SELECT nombre AS NOMBRE, apellido AS APELLIDO, idcli AS IDCLIENTE,n_pasaporte AS NoPASAPORTE FROM clientes\" &amp; _\r\n          \" WHERE nombre LIKE \" &amp; \"\'\" &amp; txtNombre.Text &amp; \"%\" &amp; \"\'\" _\r\n          &amp; \" AND \" &amp; _\r\n          \"apellido LIKE \" &amp; \"\'\" &amp; txtApellidos.Text &amp; \"%\" &amp; \"\'\" _\r\n          &amp; \" ORDER BY nombre,apellido\"\r\n    ElseIf txtNombre.Text = \"\" And txtApellidos.Text &lt;&gt; \"\" Then\r\n        sSQL = \"SELECT nombre AS NOMBRE,apellido AS APELLIDO,idcli AS IDCLIENTE,n_pasaporte AS NoPASAPORTE FROM clientes\" &amp; _\r\n          \" WHERE apellido LIKE \" &amp; \"\'\" &amp; txtApellidos.Text &amp; \"%\" &amp; \"\'\" _\r\n          &amp; \" ORDER BY apellido\"\r\n    ElseIf txtNombre.Text &lt;&gt; \"\" And txtApellidos.Text = \"\" Then\r\n        sSQL = \"SELECT nombre AS NOMBRE,apellido AS APELLIDO,idcli AS IDCLIENTE,n_pasaporte AS NoPASAPORTE FROM clientes\" &amp; _\r\n          \" WHERE nombre LIKE \" &amp; \"\'\" &amp; txtNombre.Text &amp; \"%\" &amp; \"\'\" _\r\n          &amp; \" ORDER BY nombre\"\r\n    Else\r\n        sSQL = \"SELECT nombre AS NOMBRE,apellido AS APELLIDO,idcli AS IDCLIENTE,n_pasaporte AS NoPASAPORTE FROM clientes\" &amp; _\r\n           \" ORDER BY nombre\"\r\n    End If\r\n\r\n    oCommand.CommandText = sSQL\r\n    Set oRsBuscar = oCommand.Execute\r\n\r\n    Set dtgBusqueda.DataSource = oRsBuscar\r\n    dtgBusqueda.Refresh\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdAceptar_KeyPress(KeyAscii As Integer)\r\n\r\n    If KeyAscii = vbKeyEscape Then\r\n        cmdCancelar_Click\r\n        KeyAscii = 0\r\n    End If\r\n\r\nEnd Sub\r\n\r\nPrivate Sub cmdCancelar_Click()\r\n\r\n    Set oRsBuscar = Nothing\r\n    Set dtgBusqueda.DataSource = oRsBuscar\r\n\r\n    dtgBusqueda.Refresh\r\n    txtNombre.Text = \"\"\r\n    txtApellidos.Text = \"\"\r\n    txtNombre.SetFocus\r\n\r\nEnd Sub\r\n\r\nPrivate Sub dtgBusqueda_DblClick()\r\n\r\n    On Error GoTo isError\r\n        sIdCliente = dtgBusqueda.Columns(2).CellValue(dtgBusqueda.Bookmark)\r\n        vAuxiliar = frmClientes.Buscar(frmClientes.oRsCliente, sIdCliente)\r\n        frmClientes.SetFocus\r\n        frmClientes.Refresh\r\n        Exit Sub\r\nisError:\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_KeyPress(KeyAscii As Integer)\r\n    If KeyAscii = vbKeyEscape Then\r\n        cmdCancelar_Click\r\n        KeyAscii = 0\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Sub Form_Load()\r\n    isCargado = True\r\n    Top = 2000\r\n    Left = 2500\r\n\r\n    Set oRsBuscar = New ADODB.Recordset\r\n    oRsBuscar.ActiveConnection = frmClientes.oConx\r\n\r\n    Set oCommand = New ADODB.Command\r\n    oCommand.ActiveConnection = frmClientes.oConx\r\n\r\nEnd Sub\r\n\r\nPrivate Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)\r\n    isCargado = False\r\nEnd Sub\r\n\r\nPrivate Sub Form_Unload(Cancel As Integer)\r\n    Set frmBuscar = Nothing\r\nEnd Sub\r\n\r\nPrivate Sub txtApellidos_KeyPress(KeyAscii As Integer)\r\n    If KeyAscii = 13 Then\r\n        cmdAceptar.SetFocus\r\n        KeyAscii = 0\r\n    ElseIf KeyAscii = vbKeyEscape Then\r\n        cmdCancelar_Click\r\n        KeyAscii = 0\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Sub txtNombre_KeyPress(KeyAscii As Integer)\r\n    If KeyAscii = 13 Then\r\n        txtApellidos.SetFocus\r\n        KeyAscii = 0\r\n    ElseIf KeyAscii = vbKeyEscape Then\r\n        cmdCancelar_Click\r\n        KeyAscii = 0\r\n    End If\r\nEnd Sub\r\n\r\nPrivate Sub txtNombre_LostFocus()\r\n    txtNombre.Text = UCase(txtNombre.Text)\r\nEnd Sub\r\n\r\nPrivate Sub txtApellidos_LostFocus()\r\n    txtApellidos.Text = UCase(txtApellidos.Text)\r\nEnd Sub</pre>','Aplicación desarrollada en Visual Basic 6.0 (VB 6.0) como moduo externo para \"unioncaribe.com\".  Empresa dedicada al envio de giros de dinero en Aruba.  \r\n\r\nSu objetivo principal era guardar en una BBDD en MS Access todos los documentos de identificación y los datos del cliente que utilizaba el servicio.  \r\n\r\nPara posteriormente enviarlos al departamento de investigacion de blanqueo de capital.','publish','visual-basicaplicacion-para-escanear-version-1-0-0'),(16,'2010-11-16 21:15:11','2010-12-15 22:24:44','Visual Basic - Aplicación para escanear version 2.0.0','Requisitos:\r\n\r\nSistema Operativo:  Windows 2000\r\n\r\nMicrosoft Excel Instalado.\r\n\r\nLa diferencia es sustancial en el diseño y la forma de recepcion de datos.  Se utiliza como un modulo que recibe desde la linea de comandos los parametros del cliente del cual se escaneara el documento.  En este caso ya no el nº del pasaporte sino el \"id\" y con este se generara las imagenes.  Ya no se guardan los datos del cliente en la BD de MS Access sino solamente las imagenes que estan relacionadas con él.','Desarrollada en Visual Basic 6.0 (VB 6.0).  Es un modulo externo que sirve de apoyo a una aplicacion principal de gestión.\r\n\r\nEl fin inicial fue de herramienta auxiliar mientras el programador continuaba con el desarrollo de su equivalente en la aplicación padre.  \r\n\r\nLa version 2.0.0 difiere de la version 1.0.0 en que no utiliza una BD externa para guardar los datos del cliente.','publish','visual-basic-aplicacion-para-escanear-versio-2-0-0'),(17,'2011-01-27 19:43:50','2011-04-18 21:40:06','Comprobar compatibilidad de HTML5 con navegadores antiguos','Antes de nada hay que entender <em><span style=\"color: #ff0000;\"><strong>HTML5</strong></span></em> como un conjunto de elementos independientes.  Es decir, no es un todo, sino piezas sueltas que se pueden utilizar por separado.\r\n\r\nPartiendo de esta base, no es posible determinar si un navegador antiguo soporta por completo HTML5.\r\n\r\nLo que si se puede hacer es comprobar si es compatible con determinados elementos de HTML5.\r\n\r\nPor ejemplo: el \"<span style=\"color: #339966;\">canvas</span>\", \"<span style=\"color: #339966;\">video</span>\" o \"<span style=\"color: #339966;\">geolocation</span>\".\r\n<h3>¿Como descubrir si un navegador soporta estos elementos?</h3>\r\n<strong>Existen cuatro formas:</strong>\r\n<strong></strong>\r\n\r\n<strong>1.</strong> Comprobar si existen determinadas propiedades para algun objeto global como \"window\" o \"navigator\".\r\n<pre class=\"brush: js\">//Ejemplo la propiedad gelocation para el elemento navigator\r\nfunction supports_geolocation()\r\n{\r\n     //Si el objeto navigator soporta esta propiedad de HTML5 devolvera true\r\n     return !!navigator.geolocation;\r\n}\r\n</pre>\r\n<strong>2.</strong>Creando un elemento y comprobando si determinada propiedad existe para el mismo.\r\n<pre class=\"brush: js\">//Se crea un elemento \"canvas\" y se instancia su propiedad getContext\r\nfunction supports_canvas()\r\n{\r\n     return !!document.createElement(\'canvas\').getContext;\r\n}\r\n</pre>\r\n<strong>3.</strong> Creando un elemento y comprobando si determinado metodo existe para este y si es asi ejecutarlo y ver que devuelve.\r\n<pre class=\"brush: js\">//Se crea un elemento \"video\" y se instancia su metodo canPlayType\r\n//con los distintos formatos\r\nvar eVideo = document.createElement(\"video\");\r\n//Si el navegador es compatible con todos estos codecs devolvera true\r\nreturn eVideo.canPlayType(\'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"\');\r\n</pre>\r\n<strong>4.</strong> Creando un elemento y asignarle un valor a una de sus propiedades y comprobar que se ha guardado correctamente.\r\n<pre class=\"brush: js\">//Creamos el elemento input\r\nvar eInput = document.createElement(\"input\");\r\n//Le asignamos el valor color a la propiedad type\r\neInput.setAttribute(\"type\", \"color\");\r\n//Si el navegador es compatible con este valor entonces type\r\n//guardara \"color\" sino es compatible devolvera \"text\"\r\nreturn eInput.type !== \"text\";\r\n</pre>','Determinar si HTML5 es compatible con navegadores antiguos no es una cuestion trivial ya que HTML5 puede ser interpretado por casi todos la diferencia recae en que los objetos poseeran una variedad mas amplia de propiedades y metodos conforme el navegador en que se visualice sea mas actual.\r\nAqui describo algunas técnicas que verifican hasta que punto son estos metodos y propiedades soportados.','publish','comprobar-compatibilidad-de-html5-con-navegadores-antiguos'),(18,'2011-02-26 11:56:56','2012-02-05 18:43:55','Como instalar android en mac','<p>\r\nAntes de programar y/o instalar un framework me gusta preparar todos los \"ingredientes\".\r\nPor esto, para Android voy a crear una carpeta llamada \"<strong><em>android_ingredientes</em></strong>\".\r\n</p>\r\n\r\n<p>\r\nDescargo el entorno de desarrollo (IDE) con el que programaré en java, que es el lenguaje de programación de android.\r\nEsta vez me he decidido por eclipse para mac.  Tambien se puede hacer con Netbeans.  De hecho lo tengo asi en windows.\r\n</p>\r\n\r\n<strong>Guardando los requisitos en nuestra carpeta android_ingredientes:</strong>\r\n<p>\r\nEl IDE: Eclipse 3.4 (version Ganymede).  Tambien se puede usar Eclipse 3.5 (Galileo) o 3.6 (Helios), pero como estos últmos no funcionan con el plugin de Adobe Flex instalare la revision 4.\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #ff9900;\">http://www.eclipse.org/downloads/download.php?file=/technology/\r\nepp/downloads/release/ganymede/SR2/eclipse-jee-ganymede-SR2-li\r\nnux-gtk.tar.gz</span></strong></pre>\r\n\r\n<strong>El sdk (el framework de android para mac):</strong>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #ff9900;\">http://dl.google.com/android/android-sdk_r10-mac_x86.zip</span></strong></pre>\r\nhasta aqui hemos descargado todo lo necesario para empezar.\r\n\r\n<strong>La descarga del plguin se hace directamente con eclipse ya instalado.</strong>\r\nEl plugin ADT (Android Development tools) herramientas de desarrollo de android para eclipse.  El plguin hace de intermediario entre tu entorno y el sdk ademas de añadir herramientas exlcusivas para el trabajo sobre el framework.\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #ff9900;\">https://dl-ssl.google.com/android/eclipse/</span></strong></pre>\r\n<h3>Instalamos el sdk de eclipse.</h3>\r\n<p>\r\nSe descomprime el archivo con el sdk en una ruta accesible desde cualquier lado.  Por ejemplo yo lo he hecho en:\r\n</p>\r\n<pre class=\"stlNoespacios\"><span style=\"color: #00ff00;\"><strong><span style=\"color: #339966;\">/volumes/hd_mac/android_sdk</span></strong></span></pre>\r\n<p>\r\nAhora hay que indicar al sistema operativo que los comandos para compilar el proyecto se encuentran en esta ruta.  Para ello si no lo tienes el archivo .bash_profile en tu carpeta de usuario.  Lo puedes comprobar con:\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">mac_01:~ eduardo$ vi .bash_profile</span></strong></pre>\r\n<p>\r\nEste archivo deberia estar en:\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">/Users/eduardo</span></strong></pre>\r\n<p>\r\nEste archivo no es más que un script bash que ejecutaremos para que incluya en la variable de entorno PATH del sistema la nueva ruta con todos los comandos que el framework necesita.\r\nPara crearlo escribir desde el terminal\r\n</p>\r\n<pre class=\"stlNoespacios\"><span style=\"color: #339966;\"><strong>touch .bash_profile</strong></span></pre>\r\n<p>\r\nEl comando touch cambia las fechas de un archivo. Usado sin opciones crearía un fichero con la fecha actual.\r\nComo ya tenemos el archivo .bash_profile vacio, insertamos la siguiente sentencia:\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">export PATH=$PATH:/volumes/hd_mac/android_sdk/tools</span></strong></pre>\r\n<p>\r\nBreve explicación del script, la única linea indica que se ejecute el comando <span style=\"color: #339966;\">export</span>- el cual se utiliza para definir variables de entorno - este, va acompañado de la variable de entorno del sistema \"$PATH\" que guarda las rutas generadas por defecto, a continuacion se le concatena la nueva ruta, cada nueva ruta debe ir separada por \":\", finalmente se exporta la variable $PATH a la del sistema PATH. \r\n<br />\r\nVolviendo al asunto, la sinserción se puede hacer de dos formas: desde el terminal (pantalla negra), usando vi o lanzando el textedit con:\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">open -t .bash_profile </span></strong></pre>\r\n<p>\r\nOtra aplicación interesante como editor de texto para mac es Editra.\r\n</p>\r\n<p>Con vi:</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">mac_01:~ eduardo$ vi .bash_profile</span></strong></pre>\r\npresionamos <pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">\"i\"</span></strong></pre> \r\n<p>Este es el comando de inserion de contenido en vi.  ..si, el que te deja meter contenido)</p>\r\nescribimos la ruta:<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">export PATH=$PATH:/volumes/hd_mac/android_sdk/tools</span></strong></pre>\r\npresionamos <pre class=\"stlNoespacios\"><span style=\"color: #339966;\"><strong>esc</strong></span></pre>\r\nescribimos <pre class=\"stlNoespacios\"><span style=\"color: #339966;\"><strong>:w </strong></span></pre>\r\n<p>para guardar los datos, y </p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">:q</span></strong></pre>\r\n<p>para salir del editor vi.  En este punto ya tenemos nuestro archivo creado y preparado para que lo use el sdk de android.\r\nAhora tenemos que reiniciar el shell para que se añada esta ruta a la variable de entorno principal PATH.  Para eso ejecutamos:\r\n<p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">source ~/.bash_profile</span></strong></pre>\r\n<p>source es un ejecutor de bash. Para comprobar que se ha actualizado el shell escribimos:</p> \r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">env </span></strong></pre>\r\n<p>y mostrara algo como:</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">USER=eduardo</span></strong>\r\n<strong><span style=\"color: #339966;\">COMMAND_MODE=unix2003</span></strong>\r\n<strong><span style=\"color: #339966;\">SSH_AUTH_SOCK=/tmp/launch-r97o3L/Listeners</span></strong>\r\n<strong><span style=\"color: #339966;\">__CF_USER_TEXT_ENCODING=0x1F5:0:86\r\nPATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:\r\n/volumes/hd_mac/android_sdk/tools</span></strong>\r\n<strong><span style=\"color: #339966;\">PWD=/Users/eduardo</span></strong>\r\n<strong><span style=\"color: #339966;\">LANG=es_ES.UTF-8</span></strong>\r\n<strong><span style=\"color: #339966;\">SHLVL=1</span></strong>\r\n<strong><span style=\"color: #339966;\">HOME=/Users/eduardo</span></strong></pre>\r\n<p>\r\nTenemos parte de nuestro sdk configurado e instalado.\r\n</p>\r\n<p>\r\nInstalamos eclipse.  Yo concretamente lo tengo en:\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #339966;\">/hd_mac/Aplicaciones/Eclipse 3.4.</span></strong></pre>\r\n<p>Lo ejecutamos.</p>\r\n<h3>Instalacion del plugin de android para eclipse:</h3>\r\nCon nuestro IDE abierto: <pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">En Help &gt; softwre updates &gt;add site</span></strong></pre>\r\nañadimos la url anterior <pre class=\"stlNoespacios\"><strong><span style=\"color: #ff9900;\">https://dl-ssl.google.com/android/eclipse/</span></strong></pre>\r\n<p>\r\n...aceptamos. &nbsp;&nbsp;Eclipse empezara a descargar el plugin junto a las dependencias seleccionadas y las instalará.\r\n</p>\r\n<p>\r\nCerramos nuestro IDE y lo volvemos abrir.  Tenemos el plugin instalado, debemos actualizar el ADT. Volvemos a \r\n</p>\r\n<pre class=\"stlNoespacios\"><span style=\"color: #993366;\"><strong>software updates &gt;  Installed software &gt; </strong></span></pre>\r\n<p>\r\nseleccionamos todo lo que tenga que ver con android y actualizamos.\r\n</p>\r\n<p>\r\nLo que hemos hecho hasta este momento:\r\n</p>\r\n<ul>\r\n<li>Nuestro SDK (software development kit) instalado y configurado.</li>\r\n<li>El IDE de Eclipse instalado con su respectivo plugin ADT y todo ello actualizado.</li>\r\n</ul>\r\n<h3>¿Cómo verifica android el tipo de dispositivo movil en el que se ejeuctará nuestra aplicación en desarrollo?</h3>\r\nA eso responde el término AVD. <strong><em>Android Virtual Device,</em></strong> dispositivo virtual de android.  Esto es un emulador del sistema operativo Android.  Se comporta como una maquina virtual de un terminal movil con android instalado.  Aqui se puede definir las caracteristicas de hardware del dispositvo sobre el que trabajará.  Por ejemplo si es un terminal con teclado tipo QWERTY, si tiene camara, el ancho de la pantalla etc etc.\r\n<p>Con eclipse abierto nos vamos a </p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">Window &gt; Android SDK and AVD Manager &gt; new.</span></strong></pre>\r\n<p>Creamos uno:  pe.</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">mi_avd_camara_3.0</span></strong></pre>\r\n<p>En mi caso seleccionaré la última version del sistema operativo:</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">Android 3.0</span></strong></pre>\r\n<p>\r\ny bueno para la primera aplicación con esto me basta.  Puedes ingresar el tamaño de memoria de pantalla y extras si lo deseas.\r\n</p>\r\n<p>\r\nHemos preparado las herramientas minimas para empezar a programar en Android con java.\r\n</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">En Eclipse &gt;  nuevo proyecto.</span></strong></pre>\r\n<p>Asignamos cualquier nombre. Por ejemplo:</p>\r\n<pre class=\"stlNoespacios\"><span style=\"color: #993366;\"><strong>andr_hola_mundo</strong></span></pre>\r\n<p>En</p>\r\n<pre class=\"stlNoespacios\"><span style=\"color: #993366;\">build target </span></pre>\r\n<p>definimos el s.o y/o apis con las que desarrollaremos, logicamente el emulador creado (paso anterior) debe cumplir estas caracteristicas.   Sino cuando se desee compilar dará un error.</p>\r\n<p>En este caso</p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">Android 3.0</span></strong></pre>\r\n<p>Para</p><pre class=\"stlNoespacios\"><span style=\"color: #993366;\">package name:</span><strong><span style=\"color: #993366;\">proy.holamundo</span></strong></pre>\r\n<p>(puedes poner el que desees pero tiene que ser algo como parte_1.parte_2.[parte_i].parte_n y minimo de 2 partes.</p>\r\n<p>\r\nDespues el nombre de la <strong><em>\"Activity\"</em></strong>, una activity a groso modo es el equivalente a un controlador siguiendo el patron MVC.  Luego, estariamos definiendo el nombre de nuestro controlador puesto que Android se basa en esta arquitectura.\r\n</p>\r\n<p>Finalmente definimos la version minima del SDK que debera tener el emulador y/o terminal para poder ejecutar nuestra aplicacion.   Esto tambien depende  de como hayamos definido nuestro AVD.  En este caso es </p>\r\n<pre class=\"stlNoespacios\"><strong><span style=\"color: #993366;\">11</span></strong></pre>\r\n<p>Bueno ya tenemos el proyecto creado... ahora queda el </p>\r\n<pre class=\"stlNoespacios\"><em><strong><span style=\"color: #339966;\">hola mundo</span></strong></em></pre>\r\n<p>en el próximo post y un camino interesante por recorrer :0)</p>\r\nUn saludo.','Pequeño manual que indica paso a paso como se debe instalar Android en mac utilizando Eclipse y su plugin ADT (Android Development tools).  Se explica los comandos unix utilizados para la configuración.','publish','como-instalar-android-en-mac'),(19,'2011-02-27 17:35:56','2011-02-27 21:55:06','The framework','<h3>¿Qué es \"The framework\"?</h3>\r\nEs un framework de desarrollo basado en el patrón MVC. Su lenguaje de programación es PHP.\r\n<h3>¿Cómo surge \"The framework\"?</h3>\r\nDespues de programar en php puro, cakephp, wordpress, c# y java, llegue a la conclusión que con todos estos conocimientos podria crear mi propio framework.  Una mezcla de la arquitectura de cake y wp intentando emular la sintaxis de c# y java.  El resultado es un framework muy liviano con funciones en su nucleo tan simples que se pueden modificar a gusto del consumidor.\r\n<h3>¿Por qué \"The framework\" y no otros?</h3>\r\nCreo que no existe el framework ideal.  Si esperabas que este lo fuera siento decepcionarte. Su gran ventaja es que es un entorno muy simple. Su core consta de mas o menos unas 30 funciones.  Estas no son nada complejas como cake e incluso mas simples que las de wordpress.  Asi que puedes customizarlo.  Es como un lienzo en blanco preparado para plasmar tu arte.\r\n<h3>¿Podrias explicar su funcionamiento?</h3>\r\nA grandes razgos este es su comportamiento:\r\nEl usuario pide una url a un sitio con \"the framework\"\r\nEl archivo .htaccess redirige la peticion al archivo index.php\r\nEn el archivo index.php se incluye todo los archivos del boot\r\n<ul>\r\n	<li>eaf_constants.php</li>\r\n	<li>eaf_paths.php</li>\r\n	<li>eaf_global_vars.php</li>\r\n	<li>eaf_functions.php</li>\r\n	<li>eaf_boot.php</li>\r\n	<li>eaf_router.php</li>\r\n	<li>config_it.php</li>\r\n	<li>your_constants.php</li>\r\n	<li>your_vars.php</li>\r\n	<li>your_functions.php</li>\r\n</ul>\r\nSe lee la url, se comprueba que esta ruta case o exista en eaf_router.php si esto se cumple en eaf_router se determina el controlador  y la funcion del mismo que se debe ejecutar.  En esta funcion se indica la vista que recibira las variables del resultado de este proceso.\r\n\r\nFinalmente en la vista se mostrara el contenido de estas variables.\r\nEn caso que no exista la url se envia al controlador 404.php que va asociado a una vista con el mensaje \"contenido no encontrado\".\r\n<h3>¿Permite programar con clases?</h3>\r\nEste es su otro punto fuerte, esta totalmente orientado a la programación con objetos.\r\n<pre class=\"brush: php\">//Ejemplo de modelo. modelo_usuario.php\r\nclass MUsuario implements IAccionBaseDatos\r\n{\r\n    private $_id;\r\n    private $_sLogin;\r\n    private $_sClave;\r\n    private $_sEmail;\r\n    private $_sNombres;\r\n    public function __construct($id=0,$sLogin=\'\',$sClave=\'\',$sEmail=\'\',$sNombres=\"\")\r\n	{\r\n		$this-&gt;_id = $id;\r\n		$this-&gt;_sLogin = $sLogin;\r\n		$this-&gt;_sClave = $sClave;\r\n		$this-&gt;_sEmail = $sEmail;\r\n		$this-&gt;_sNombres = $sNombres;\r\n	}\r\n\r\n//Ejemplo de controlador, controlador_usuario.php\r\nfunction crear_usuario()\r\n{\r\n	$oUsuario = new MUsuario(0,\"nano\",\"ab1234\",\"nano@mimail.com\",\"Fernando Trueba\");\r\n	$oUsuario-&gt;agregar();\r\n	set_params(\'oUsuario\',$oUsuario);\r\n	set_view(\"/usuarios/vista_crear_usuario\");\r\n}\r\n\r\n//En la vista vista_crear_usuario.php\r\n&lt;?php\r\n$oUsuario = get_params(\'oUsuario\');\r\n?&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;?php\r\n//Muestra el mensaje resultado de la creacion\r\n$oUsuario-&gt;show_mensaje();\r\n?&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\r\n//Resultado\r\nSe ha creado el usuario: Frenando Trueba\r\n</pre>\r\n<h2>Para ver un ejemplo en funcionamiento sigue el enlace:\r\n<a href=\"http://the-framework.eduardoaf.com/\"><span style=\"color: #ff9900;\">Ver ejemplo</span></a>\r\n</h2>','Descripción en forma de FAQ de todo lo que rodea a \"the framework\" un entorno (desarrollado por mi) muy sencillo y liviano para programar con PHP.  Intenta fusionar lo mejor cakephp y wordpress.  Pensado para desarrollar utilizando la programación orientada a objetos.','publish','the-framework'),(20,'2011-02-27 22:11:39','2012-06-10 17:55:58','Eaf lightbox. Lightbox que se ajusta al tamaño de la ventana','Hay muchos lightbox en internet. Uno muy bueno y que utilizo es prettyPhoto.\r\n\r\nEl problema y creo que único defecto de este es que las imagenes de dimensiones mayores al tamaño de la ventana del browser, ya sea firefox, internet explorer (IE), opera, chrome etc.  Esta se presenta en un tamaño muy pequeño y si la redimensionas a su tamaño real se sale de la ventana.\r\n\r\nEs por esto y porque no consegui ninguno que se autoajustara de forma proporcionada en la pantalla.  Decidí crear mi propio lightbox. (eaf_lightbox)\r\n<p>\r\n    <span style=\"color: #ff9900;\">\r\n        <strong>Para ver eaf_lightbox en ejecución haz click<a href=\"http://ver-en-ejecucion.eduardoaf.com/eaf_lightbox.php\" title=\"eaf_lightbox en ejecución\" target=\"_blank\" > aquí</a>.\r\n        </strong>\r\n        <strong>Para descargar eaf_lightbox haz click<a href=\"http://downloads.eduardoaf.com/packages/eaf_lightbox_v1.tgz\" title=\"descarga eaf_lightbox\" target=\"_blank\"> aquí</a>.\r\n        </strong>\r\n    </span>\r\n</p>\r\nEl código:\r\n<pre class=\"brush: js\">\r\n//VARIABLES GLOBALES\r\nvar G_isLightboxCreado = false;\r\nvar G_arImagenCargada = new Array();\r\nvar G_eArAnchors = new Array();\r\n\r\n//Esta variable se encarga de guardar la url de la imagen que se esta viendo\r\n//y sus dimensiones, porque cuando se reedimensione la ventana se usaran estos datos\r\n//para recalcularla\r\nG_arImagenCargada.url = \"\";\r\nG_arImagenCargada.ancho = 0;\r\nG_arImagenCargada.alto = 0;\r\n\r\n//Seleccionar o deseleccionar todo\r\n$(document).ready\r\n(\r\n    function()\r\n    {  \r\n        //Asigno onclick a los anchors\r\n        crear_evento_hrefs();\r\n    }//fin argumento function()\r\n);//Fin .ready()\r\n\r\n\r\nwindow.onresize = function ()\r\n{\r\n    if(G_isLightboxCreado)\r\n    {\r\n        redimensionar_ventana();\r\n    }\r\n}\r\n\r\nfunction redimensionar_ventana()\r\n{\r\n    //Elimino el fondo\r\n    oDivFondo = $(&rsquo;#divFondo&rsquo;); \r\n    oDivFondo.remove();\r\n    //Lo creo nuevamente segun los calculos\r\n    crear_div_fondo();\r\n    \r\n    oVentana = $(window);\r\n    iAnchoVentana = oVentana.width();\r\n    iAltoVentana = oVentana.height();  \r\n    //Obtengo el tamaño real de la imagen cargada\r\n    iAnchoImagen = G_arImagenCargada.ancho;\r\n    iAltoImagen = G_arImagenCargada.alto;\r\n\r\n    iProporcion = get_porcentaje(iAnchoImagen,iAltoImagen,iAnchoVentana,iAltoVentana);\r\n    iAnchoImagen = (iAnchoImagen * iProporcion);\r\n    iAltoImagen = (iAltoImagen * iProporcion);\r\n    //Fix para la altura, siempre se sale y crea scroll\r\n    iAltoImagen --;\r\n    arCoord = get_centrado(iAnchoVentana,iAltoVentana,iAnchoImagen, iAltoImagen);\r\n    \r\n    oImagen = $(&rsquo;#imgImagen&rsquo;);\r\n    oImagen.width(iAnchoImagen);\r\n    oImagen.height(iAltoImagen);\r\n    \r\n    //Actualizo las coordenadas del div    \r\n    oDivImagen = $(&rsquo;#divImagen&rsquo;);\r\n    iScrollTop = oVentana.scrollTop();   \r\n    oDivImagen.css(&rsquo;top&rsquo;,arCoord[&rsquo;y&rsquo;] + iScrollTop);\r\n    oDivImagen.css(&rsquo;left&rsquo;,arCoord[&rsquo;x&rsquo;]);\r\n}\r\n\r\nfunction get_porcentaje(iAnchoImagen, iAltoImagen, iAnchoVentana, iAltoVentana)\r\n{\r\n    //alert(\"get_porcentaje\");\r\n    iProporcion = 1;\r\n    \r\n    if(iAltoImagen > iAltoVentana && iAnchoImagen <= iAnchoVentana)\r\n    {\r\n        iProporcion = iAltoVentana / iAltoImagen;\r\n    }\r\n    else if(iAltoImagen <= iAltoVentana && iAnchoImagen > iAnchoVentana)\r\n    {\r\n        iProporcion = iAnchoVentana / iAnchoImagen;\r\n    }\r\n    else if(iAltoImagen > iAltoVentana && iAnchoImagen > iAnchoVentana)\r\n    {\r\n        iProporcionAlto = iAltoVentana / iAltoImagen;\r\n        iProporcionAncho = iAnchoVentana / iAnchoImagen;\r\n        \r\n        if(iProporcionAlto < iProporcionAncho)\r\n        {\r\n            iProporcion = iProporcionAlto;\r\n        }\r\n        else\r\n        {\r\n            iProporcion = iProporcionAncho;  \r\n        }\r\n    }\r\n    \r\n    return iProporcion;\r\n}\r\n\r\nfunction crear_evento_hrefs()\r\n{\r\n    //Bug con jquery en IE con .attr(&rsquo;rel&rsquo;);\r\n    G_eArAnchors = get_anchors_by_rel(\"eafbox\");\r\n    \r\n    $.each\r\n    (\r\n        G_eArAnchors,\r\n        function(index, anchor)\r\n        {\r\n            //alert(eAnchor);\r\n            oAnchor = $(anchor);\r\n            oAnchor.bind\r\n            (  \r\n                \"click\", \r\n                function(e) \r\n                {\r\n                    \r\n                    sUrlImagen = $(this).attr(&rsquo;href&rsquo;);\r\n                    crear_eaf_lightbox(sUrlImagen);\r\n                    e.stopPropagation();\r\n                    return false;\r\n                }\r\n            );\r\n        }\r\n    );\r\n\r\n}\r\n\r\n\r\nfunction crear_eaf_lightbox(sUrlImg)\r\n{\r\n    //Tamaño de la imagen\r\n    var arImagen = new Array();\r\n    var arCoord = new Array();\r\n    //Se actualiza la global por si se redimensiona despues\r\n    G_arImagenCargada.url = sUrlImg;\r\n\r\n    //Creamos el contenedor mas grande #divLightbox\r\n    crear_div_lightbox(); \r\n\r\n    //Creamos el fondo negro con opacidad #divFondo  \r\n    crear_div_fondo(); \r\n    \r\n    oVentana = $(window);\r\n    iAnchoVentana = oVentana.width();\r\n    iAltoVentana = oVentana.height();\r\n\r\n    //Crea el div ocntenedor para la imagen #divImagen\r\n    crear_div_imagen();\r\n    \r\n    //24 tamaño del gif en el loader\r\n    arCoord = get_centrado(iAnchoVentana, iAltoVentana, 24, 24);\r\n    //alert(arCoord[&rsquo;x&rsquo;]+\" \"+arCoord[&rsquo;y&rsquo;]);\r\n    crear_div_preload(arCoord[&rsquo;x&rsquo;],arCoord[&rsquo;y&rsquo;]);\r\n    \r\n    eImg = new Image();\r\n    oImagen = $(eImg);\r\n    oImagen.attr(&rsquo;id&rsquo;,&rsquo;imgImagen&rsquo;);\r\n    oImagen\r\n    // once the image has loaded, execute this code\r\n\r\n      .hide() //Hide it\r\n      //call makes sure .load() only fires once\r\n	  .one  \r\n      (\r\n        &rsquo;load&rsquo;,\r\n        function() \r\n        {\r\n            //Set something to run when it finishes loading\r\n            iAnchoImagen = G_arImagenCargada.ancho = this.width;\r\n            iAltoImagen = G_arImagenCargada.alto = this.height;\r\n            //alert(iAnchoVentana);\r\n            iProporcion = get_porcentaje(iAnchoImagen,iAltoImagen,iAnchoVentana,iAltoVentana);\r\n            iAnchoImagen = (iAnchoImagen * iProporcion);\r\n            iAltoImagen = (iAltoImagen * iProporcion);\r\n            //Fix para la altura, siempre se sale y crea scroll\r\n            iAltoImagen --;\r\n            arCoord = get_centrado(iAnchoVentana,iAltoVentana,iAnchoImagen, iAltoImagen);\r\n            \r\n            oImagen.width(iAnchoImagen);\r\n            oImagen.height(iAltoImagen);\r\n\r\n            oDivImagen = $(&rsquo;#divImagen&rsquo;);\r\n            iScrollTop = oVentana.scrollTop();\r\n            oDivImagen.css(&rsquo;top&rsquo;,arCoord[&rsquo;y&rsquo;] + iScrollTop );\r\n            oDivImagen.css(&rsquo;left&rsquo;,arCoord[&rsquo;x&rsquo;]);\r\n\r\n            oDivPreload.remove();\r\n            oDivImagen.append(oImagen);\r\n            oImagen.fadeIn();\r\n            //Indico que se ha creado el lightbox\r\n            G_isLightboxCreado = true;\r\n        }\r\n      )\r\n      .attr(&rsquo;src&rsquo;, sUrlImg) //Set the source so it begins fetching\r\n      .each\r\n      (\r\n        function()\r\n        {\r\n            //Cache fix for browsers that don&rsquo;t trigger .load()\r\n            if(this.complete)\r\n            {\r\n                $(this).trigger(\"load\");\r\n            }\r\n        }\r\n      )\r\n      //Elimino el lightbox cuando hago click en la imagen\r\n      .bind\r\n      (\r\n        &rsquo;click&rsquo;,\r\n        function()\r\n        {\r\n            eliminar_lightbox();\r\n        }\r\n      );\r\n}\r\n\r\nfunction crear_div_fondo() \r\n{\r\n    oVentana = $(window);\r\n    oBody = $(&rsquo;body&rsquo;);\r\n    \r\n    iAnchoBody = oBody.width();\r\n    iAltoBody = oBody.height();\r\n\r\n    iAnchoDiv = oVentana.width();\r\n    iAltoDiv = oVentana.height();\r\n    \r\n    if(iAnchoBody > iAnchoDiv)\r\n    {\r\n        iAnchoDiv = iAnchoBody;\r\n    }\r\n    \r\n    if(iAltoBody > iAltoDiv)\r\n    {\r\n        iAltoDiv = iAltoBody;\r\n    }\r\n        \r\n    eDivFondo = document.createElement(\"div\");\r\n    oDivFondo = $(eDivFondo);\r\n    oDivFondo.attr(&rsquo;id&rsquo;,&rsquo;divFondo&rsquo;);\r\n    oDivFondo.width(iAnchoDiv);\r\n    //iY = oVentana.scrollTop(); \r\n    oDivFondo.height(iAltoDiv);\r\n    \r\n    //Contenedor principal\r\n    oDivLigthbox = $(&rsquo;#divLightbox&rsquo;);    \r\n    oDivLigthbox.append(oDivFondo);\r\n    \r\n    oDivFondo.fadeIn();\r\n    oDivFondo.bind\r\n    (\r\n        &rsquo;click&rsquo;,\r\n        function()\r\n        {\r\n            eliminar_lightbox();\r\n        }\r\n    );\r\n}  \r\n\r\nfunction crear_div_preload(iPosX,iPosY) \r\n{\r\n\r\n    eDivPreload = document.createElement(\"div\");\r\n    oDivPreload = $(eDivPreload);\r\n    oDivPreload.attr(&rsquo;id&rsquo;,&rsquo;divPreload&rsquo;);\r\n    \r\n    oVentana = $(window);\r\n    iScrollTop = oVentana.scrollTop();      \r\n    oDivPreload.css(&rsquo;top&rsquo;,iPosY + iScrollTop);\r\n    oDivPreload.css(&rsquo;left&rsquo;,iPosX);\r\n    //Contenedor principal\r\n    oDivLigthbox = $(&rsquo;#divLightbox&rsquo;);    \r\n    oDivLigthbox.append(oDivPreload);\r\n} \r\n\r\nfunction crear_div_imagen() \r\n{\r\n    eDivImagen = document.createElement(\"div\");\r\n    oDivImagen = $(eDivImagen);\r\n    oDivImagen.attr(&rsquo;id&rsquo;,&rsquo;divImagen&rsquo;);\r\n    oDivImagen.css(&rsquo;display&rsquo;,&rsquo;hidden&rsquo;);\r\n    //Contenedor principal\r\n    oDivLigthbox = $(&rsquo;#divLightbox&rsquo;);    \r\n    oDivLigthbox.append(oDivImagen); \r\n} \r\n\r\n\r\nfunction get_centrado(iContAncho, iContAlto, iAncho, iAlto)\r\n{\r\n    arCoord = new Array();\r\n    arCoord[&rsquo;x&rsquo;] = 0;\r\n    arCoord[&rsquo;y&rsquo;] = 0;\r\n    \r\n    arCoord[&rsquo;x&rsquo;] = ((iContAncho - iAncho)/2);\r\n    arCoord[&rsquo;y&rsquo;] = ((iContAlto - iAlto)/2);\r\n    \r\n    return arCoord;\r\n}\r\n\r\nfunction describir_objeto(eObjeto)\r\n{\r\n    sObjeto = &rsquo;&rsquo;; \r\n    for (sPropiedad in eObjeto)\r\n    {\r\n        sObjeto += \"oAnchor[\"+sPropiedad +\"] = \"+this[sPropiedad];\r\n        sObjeto += \"\\n<br/>\"; \r\n    }\r\n    //alert(sObjeto);  \r\n    document.write(sObjeto);    \r\n}\r\n\r\n//Hecho con javascript puro porque no funciona \r\n//con jQuery\r\nfunction get_anchors_by_rel(sReltext)\r\n{\r\n    G_eArAnchors = document.getElementsByTagName(\"a\");\r\n    eArAnchorFound = [];\r\n    for (i = 0; i < G_eArAnchors.length; i++) \r\n    {\r\n        if( G_eArAnchors[i].hasAttribute(\"rel\") && G_eArAnchors[i].rel == sReltext ) \r\n        {\r\n            eArAnchorFound.push(G_eArAnchors[i]);\r\n        }\r\n    }\r\n    return eArAnchorFound;\r\n}\r\n\r\nfunction crear_div_lightbox()\r\n{\r\n    eBody = document.body;\r\n    oBody = $(eBody);\r\n    oBody.append(&rsquo;<div id=\"divLightbox\"></div>&rsquo;);\r\n}\r\n\r\nfunction eliminar_lightbox()\r\n{\r\n    $(&rsquo;#omgImagen&rsquo;).remove();\r\n    $(&rsquo;#divImagen&rsquo;).remove();\r\n    $(&rsquo;#divFondo&rsquo;).remove();\r\n    $(&rsquo;#divLightbox&rsquo;).remove();             \r\n    G_isLightboxCreado = false;\r\n}\r\n</pre>','\"eaf_lightbox\" es un nuevo mostrador de imagenes construido con jquery.  Ajusta automaticamente y de forma proporcionada la imagen en pantalla.','publish','eaf-lightbox-lightbox-que-se-ajusta-al-tamano-de-la-ventana'),(21,'2011-02-27 22:53:24','2011-04-16 18:28:38','Recuperar el atributo \"rel\" de un elemento anchor','Al intentar crear un plugin en Jquery de un lightbox me encontré con el siguiente bug de Jquery.\r\n\r\nCon estas lineas en teoria deberia devolver el valor que esta asociado al atributo rel.\r\n<pre class=\"brush: js\">\r\nsAtributoRel = $(\'#idElementAnchor\').attr(\'rel\');\r\nalert(sAtributoRel);\r\n</pre>\r\nEsto no funciona. Quizas esta pendiente de revision para la proxima version de este framework.\r\n\r\nAsí que no me quedaba otra que programar a la vieja escuela.  En javascript nativo.\r\n\r\n<pre class=\"brush: js\">\r\n//Hecho con javascript nativo porque no funciona\r\n//en jquery\r\nfunction get_anchors_by_rel(sReltext)\r\n{\r\n    //Array con todos los elementos anchor\r\n    eArAnchors = document.getElementsByTagName(\"a\");\r\n    eArAnchorFound = [];\r\n    for (i = 0; i < eArAnchors .length; i++) \r\n    {\r\n        if( eArAnchors[i].hasAttribute(\"rel\") && eArAnchors[i].rel == sReltext ) \r\n        {\r\n            eArAnchorFound.push(eArAnchors[i]);\r\n        }\r\n    }\r\n    return eArAnchorFound;\r\n}\r\n</pre>\r\n\r\nPara ver el lightbox en ejecución haz click <a href=\"http://ver-en-ejecucion.eduardoaf.com/eaf_lightbox.php\" >aquí</a>\r\n\r\nPara saber mas sobre eaf_lightbox haz click <a href=\"http://www.eduardoaf.com/blog-frameworks/frameworks-jquery/eaf-lightbox-lightbox-que-se-ajusta-al-tamano-de-la-ventana/\" >aquí</a>','En jquery el metodo .attr(\'rel\') no funciona correctamente cuando se trata de anchors.  Asi que la funcion que muestro es una alternativa para recuperar este atributo.  Funcion \"get_anchors_by_rel()\"','publish','recuperar-el-atributo-rel-de-un-elemento-anchor'),(22,'2011-04-17 19:14:13','2011-07-02 16:17:51','Optimizando find y paginate en cakephp','Hay un dicho para programación en ingles, \"do it simple\" que es en lo que se basan los frameworks o al menos lo intentan.\r\n\r\nLa gran ventaja de cake (como framework) es que agiliza mucho el proceso de codificación mientras se trabaja con vistas, componentes y controladores.  \r\n\r\nPero creo que hay algunas carencias en los modelos. Una de ellas\r\nes el metodo \"find\".\r\n\r\nAlgo tan simple como crear una variable string con una SQL del tipo:\r\n<pre class=\"brush: php\">\r\n$sSQL=\"SELECT Company.id, Company.name, \r\nCompany.description, Company.location, \r\nCompany.created, Company.status, Company.size\r\nFROM companies AS Company\r\nWHERE\r\n(\r\n	(Company.name = \'Future Holdings\')\r\n	OR\r\n	(Company.name = \'Steel Mega Works\')\r\n)\r\nAND\r\n(\r\n	(Company.status = \'active\')\r\n	OR(NOT (Company.\'status\' IN (\'inactive\', \'suspended\')))\r\n)\";\r\n</pre>\r\npara despues ser utilizada como argumento en el metodo \"query()\" y asi obtener un array ($arResultado) con estas condiciones\r\n<pre class=\"brush: php\">\r\n$arResutlado = $this->query($sSQL);\r\n...\r\n//aqui tratas $arResultado como desees\r\n...\r\n</pre>\r\nSe convierte en un proceso un poco complejo (si se desea recuperar con find()) como el siguiente:\r\n<pre class=\"brush: php\">\r\n//Se genera un array anidado de 5 niveles\r\n$arCondicion = array(\r\n   \'OR\' => array(\r\n      array(\'Company.name\' => \'Future Holdings\'),\r\n      array(\'Company.name\' => \'Steel Mega Works\')\r\n   ),\r\n   \'AND\' => array(\r\n      array(\r\n         \'OR\'=>array(\r\n            array(\'Company.status\' => \'active\'),\r\n            \'NOT\'=>array(\r\n               array(\'Company.status\'=> array(\'inactive\', \'suspended\'))\r\n            )\r\n         )\r\n     )\r\n   )\r\n);\r\n\r\n$arResultado = $this->ModelName->find(\'all\',$arCondicion);\r\n</pre>\r\n\r\nSi lo que deseamos es paginar entonces ya no podemos recurrir a \"query()\" porque obligatoriamente se tiene que utilizar el metodo de controlador \"paginate()\"\r\n\r\n<pre class=\"brush: php\">\r\n$arItemsEnPagina=$this->paginate(\'ModelName\',$arCondicion);\r\n$this->set(\'arItemsEnPagina\',$arItemsEnPagina);\r\n</pre>\r\n\r\n<h3>En la vista </h3>\r\n<pre class=\"brush: php\">\r\n//Mostramos el listado\r\nforeach($arItemsEnPagina as $arItem)\r\n{\r\n     echo $arItem[\'ModelName\'][\'ModelField\'];\r\n}\r\n//Mostramos los botones de navegación\r\n if($paginator->numbers())\r\n{\r\n    echo $paginator->first(\'|<\');\r\n    echo $paginator->prev(\'<<\');\r\n    echo \'<span> | </span>\' ;\r\n    echo $paginator->numbers();\r\n    echo \'<span> | </span>\' ; \r\n    echo $paginator->next(\'>>\');\r\n    echo $paginator->last(\'>|\');\r\n}\r\n</pre>\r\n\r\nEn el caso que el paginado se haga con datos devueltos por un único modelo (es decir, no relacionado) el proceso dentro de su complejidad es más simple.\r\n\r\nPero si intervienen otros modelos (relaciones con otras tablas) habria que crear todas las relaciones (binds) previamente, de lo contrario devolvera \"cakeError\" el codigo de los binds dependiendo de la cantidad de niveles relacionados (JOINS) puede hacer el codigo más dificil de entender.\r\n\r\nLo mejor para el paginado seria una clase tipo componente en cuyo constructor se le pase cualquier array cuyo primer nivel siempre sea un indice númerico y el numero de items por pagina a mostrar.\r\n\r\nAlgo como:\r\n<pre class=\"brush: php\">\r\n//Recupero cualquier tipo de dato indexado en primer nivel\r\n//por un entero\r\n$arDatosAPaginar = $this->ModelName->get_datos_x();\r\n$oPaginator = new CPaginator($arDatosAPaginar,8);\r\n$arItemsPorPagina = $oPaginator->get_items();\r\n$arBotones = $oPaginator->get_botones();\r\n$this->set(\'arItemsPorPagina\',$arItemsPorPagina);\r\n$this->set(\'arBotones\',$arBotones);\r\n</pre>\r\n\r\n\r\n','Las queries o SQLs que se crean para recuperar datos en cakephp dejan de ser simples para convertirse en arrays anidados haciendo menos legible el código programado.  En este articulo se muestra una deficiencia de cakephp en el metodo find y paginate.','publish','optimizando-find-y-paginate-en-cakephp'),(23,'2011-04-17 19:27:51','2011-07-02 15:47:33','Clase para paginar un array','He creado la siguiente clase (CPaginas) ya que no he encontrado una equivalente y generica para mostrar por paginas el contenido de cualquier array.\r\n\r\nLa clase <strong>CPaginas</strong> sirve para paginar cualquier array.\r\nEl pseudo algoritmo seria el siguiente:\r\n<ul>\r\n	<li>Obtener array indexado en enteros</li>\r\n	<li>Construir un objeto pagina con el array obtenido</li>\r\n	<li>Recuperar el array reducido</li>\r\n</ul>\r\nEl array a paginar debe estar indexado con las \"keys\" de primer nivel en enteros.\r\n\r\nEs decir:\r\n<pre class=\"brush: php\">$arItems[0]=array(...);\r\n$arItems[1]=array(...);\r\n$arItems[.]=array(...);\r\n$arItems[i]=array(...);\r\n$arItems[.]=array(...);\r\n$arItems[n]=array(...);\r\n</pre>\r\n<h3>La forma de usar la clase CPaginas</h3>\r\n<pre class=\"brush: php\">//Cualquier modelo\r\n$oModelo = new MModelo();\r\n//Obtenemos un listado desde el modelo\r\n$arTabla = $oModelo-&gt;get_tabla();\r\n//Pagina pedida $arUriParams[3]=$_GET[\'page\']; \r\n$iPagina = $arUriParams[3];\r\n//El listado es un array indexado por enteros\r\n//$sUrl = \'www.midomino.com/coches/?page=\' el link con el que se generaran los botones de navegacion\r\n$oPagina = new CPaginas($arTabla, $iPagina, $sUrl, 8);\r\n//Reutilizamos el array dejando solo los items que le corresponde\r\n//a la pagina $iPagina\r\n$arTabla = $oPagina-&gt;get_items_to_show();\r\n$sBotones = $oPagina-&gt;get_botones_in_html();\r\n//Ahora solo queda recorrer $arTabla e ir imprimiendo su\r\n//contenido en pantalla y hacer un echo $sBotones;\r\n</pre>\r\n<h3>El código de la clase CPaginas:</h3>\r\n<pre class=\"brush: php\">class CPaginas\r\n{\r\n    private $_arItems;\r\n    /**\r\n    * Los items por pagina que se deberan mostrar\r\n    * \r\n    * @var mixed\r\n    */\r\n    private $_iItemsPagina;\r\n    private $_iPagina;\r\n    private $_iNumPaginas;\r\n    private $_isExacto = true;\r\n    \r\n    private $_sUrl;\r\n    \r\n    //$arItems: El array que se troceara en paginas\r\n    //$iPagina: La pagina a mostrar\r\n    //$sUrl: Es la url con la que se crearan los botones ejemplo: www.midominio.com/coches/electricos?page=\r\n    //$iItemsPagina: La cantidad de items por pagina a mostrar\r\n    public function __construct($arItems, $iPagina=1, $sUrl=\"\", $iItemsPagina=15)\r\n    {\r\n        $this-&gt;_arItems = $arItems;\r\n        $this-&gt;_iItemsPagina = $iItemsPagina;    \r\n        $this-&gt;_iPagina = $this-&gt;avoid_not_number($iPagina);\r\n        $this-&gt;_iNumPaginas = $this-&gt;num_paginas_resultantes();\r\n        $this-&gt;_sUrl = $sUrl;\r\n    }\r\n\r\n    private function avoid_not_number($string)\r\n    {\r\n        $iEntero = $string;\r\n        if(!is_numeric($iEntero))\r\n        {\r\n            $iEntero = 1;\r\n        }\r\n        return $iEntero;\r\n    }\r\n    \r\n    private function get_array_items()\r\n    {\r\n        $arResultado = array();\r\n        \r\n        $arItems = $this-&gt;_arItems;\r\n        $iItemsPagina = $this-&gt;_iItemsPagina;\r\n        $iPagina = $this-&gt;_iPagina;\r\n        $iNumPaginas = $this-&gt;_iNumPaginas;\r\n\r\n        //Si la pagina recibida esta en el rango\r\n        if($iPagina &gt; 0 &amp;&amp; $iPagina &lt;= $iNumPaginas)         {             //iKeyInicio = 8 x (4-1) = 24             $iKeyInicio = $iItemsPagina * ($iPagina - 1);             //iKeyFinal = 24 + (8 - 1) = 24 + 7 = 31             //En caso de resto == 0 y que la pagina actual no sea             //la ultima se puede aplicar el key Final asi             $iKeyFinal = $iKeyInicio + ($iItemsPagina - 1);             //Si la pagina actual es la ultima             if($iPagina == $iNumPaginas &amp;&amp; !$this-&gt;_isExacto)\r\n            {\r\n                //Las paginas que respetan los items/pagina \r\n                $iPaginasCompletas = $iNumPaginas - 1;\r\n                //El numero de items distribuidos en estas paginas\r\n                $iItemsDistribuidos = $iPaginasCompletas * $iItemsPagina;\r\n                $iItemsUltimaPagina = count($arItems) - $iItemsDistribuidos;\r\n                \r\n                $iKeyFinal = $iKeyInicio + ($iItemsUltimaPagina - 1);  \r\n            }\r\n\r\n            $k = 0;\r\n            for($i=$iKeyInicio; $i&lt;=$iKeyFinal; $i++)             {                 $arResultado[$k] = $arItems[$i];                 $k++;             }             //bug($arResultado, \'get_array_items\');         }         else //La pagina pedida no esta en el rango         {             $arResultado = null;         }         return $arResultado;     }          private function num_paginas_resultantes()     {         $arItems = $this-&gt;_arItems;\r\n        $iItemsPagina = $this-&gt;_iItemsPagina;  \r\n        $iTotalItems = count($arItems);\r\n         \r\n        $iNumPaginas = intval( $iTotalItems / $iItemsPagina);\r\n        $iResto = $iTotalItems % $iItemsPagina;\r\n        //Si el resto es mayor que cero es porque se necesita\r\n        //una pagina mas\r\n        if($iResto &gt; 0)\r\n        {\r\n            //Con esto indico que la ultima pagina no tendra\r\n            //un listado respetando \"itemps/pagina\" sino que sera menor\r\n            $this-&gt;_isExacto = false;\r\n            $iNumPaginas++;\r\n        }\r\n\r\n               // bug($iNumPaginas);\r\n        return $iNumPaginas;        \r\n    }\r\n    \r\n    private function get_array_navegacion()\r\n    {\r\n        $arBotones = array();\r\n        $iNumPaginas = $this-&gt;_iNumPaginas;\r\n        $iPaginaActual = $this-&gt;_iPagina;\r\n        \r\n        //Hay al menos una pagina\r\n        if($iNumPaginas &gt; 0)\r\n        {\r\n            switch($iPaginaActual)\r\n            {\r\n                //En caso que se pase una pagina 0 o negativa (Fuera de rango)\r\n                case($iPaginaActual &lt; 1):                     $arBotones = \"Error: pagina fuera de rango\";                     break;                  //Si solo existe una unica pagina                 case ($iPaginaActual==1 &amp;&amp; $iNumPaginas==1):                     //No hay botones de ningun tipo                     $arBotones = null;                     break;                 //Si estamos en la primera y hay mas de una                 case ($iPaginaActual==1 &amp;&amp; $iNumPaginas&gt;1):\r\n                    $arBotones[\'nav_numeros\'] = $this-&gt;get_botones_numero();\r\n                    $arBotones[\'nav_siguiente\'] = $this-&gt;get_botones_siguiente();\r\n                    break;\r\n                //Si no es ni la primera ni la ultima                        \r\n                case ($iPaginaActual&gt;1 &amp;&amp; $iPaginaActual&lt;$iNumPaginas):                     $arBotones[\'nav_anterior\'] = $this-&gt;get_botones_anterior();\r\n                    $arBotones[\'nav_numeros\'] = $this-&gt;get_botones_numero();\r\n                    $arBotones[\'nav_siguiente\'] = $this-&gt;get_botones_siguiente();                \r\n                    break;\r\n                //Si es la ultima                        \r\n                case ($iPaginaActual&gt;1 &amp;&amp; $iPaginaActual==$iNumPaginas):\r\n                    $arBotones[\'nav_anterior\'] = $this-&gt;get_botones_anterior();\r\n                    $arBotones[\'nav_numeros\'] = $this-&gt;get_botones_numero(); \r\n                    break; \r\n                //Si es mayor a la ultima (fuera de rango)                        \r\n                case ($iPaginaActual&gt;$iNumPaginas):\r\n                    $arBotones = \"Error: pagina fuera de rango pagina actual:$iPaginaActual, total paginas:$iNumPaginas\";\r\n                default:                               \r\n            }\r\n        }\r\n        return $arBotones;         \r\n    }\r\n    \r\n    private function get_botones_numero()\r\n    {\r\n        $arBoton = array();\r\n        $iPaginaNoBoton = $this-&gt;_iPagina; \r\n        $iNumPaginas = $this-&gt;_iNumPaginas;\r\n        $sUrl = $this-&gt;_sUrl;\r\n        \r\n        for($i=1; $i&lt;=$iNumPaginas; $i++)\r\n        {\r\n            if($i != $iPaginaNoBoton)\r\n            {\r\n                //bug($sUrl,\'url en get_botones numero\');\r\n                $sTmpUrl = $sUrl . $i .\"/\"; ;\r\n                $sBotonAnchor = \"<span> <a href=\"\\&quot;$sTmpUrl\\&quot;\">$i</a> </span>\"; \r\n            }\r\n            else\r\n            {\r\n                $sBotonAnchor = \"<span class=\"\\&quot;stlPaginaActual\\&quot;\">$iPaginaNoBoton</span>\"; \r\n            }\r\n            $arBoton[$i] = $sBotonAnchor;\r\n        } \r\n        \r\n        return $arBoton;        \r\n    }\r\n   \r\n    private function get_botones_anterior()\r\n    {\r\n        $arBoton = array(\'inicio\'=&gt;\"\",\'final\'=&gt;\"\");\r\n        $iPaginaActual = $this-&gt;_iPagina; \r\n        $iNumPaginas = $this-&gt;_iNumPaginas;\r\n        $sUrl = $this-&gt;_sUrl;\r\n \r\n        //Pagina 1\r\n        $sTmpUrl = $sUrl . 1 . \"/\";\r\n        $arBoton[\'inicio\'] = \"<span> <a href=\"\\&quot;$sTmpUrl\\&quot;\">|&lt;</a> </span>\"; \r\n        \r\n        //Pagina anterior a la actual si la actual es &gt; 1\r\n        $sTmpUrl = $sUrl . ($iPaginaActual-1). \"/\";\r\n        $arBoton[\'anterior\'] = \"<span> <a href=\"\\&quot;$sTmpUrl\\&quot;\">&lt;&lt;</a> </span>\"; \r\n        \r\n        return $arBoton;  \r\n    }\r\n    \r\n    private function get_botones_siguiente()\r\n    {\r\n        $arBoton = array(\'siguiente\'=&gt;\"\",\'final\'=&gt;\"\");\r\n        $iPaginaActual = $this-&gt;_iPagina;\r\n        $iUltimaPagina = $this-&gt;_iNumPaginas; \r\n        $sUrl = $this-&gt;_sUrl;\r\n\r\n        //Solo hay siguiente si la pagina_actual es menor a la ultima pagina (o total de paginas)\r\n        if($iPaginaActual&lt;$iUltimaPagina)\r\n        {\r\n            $sTmpUrl = $sUrl . ($iPaginaActual+1). \"/\"; \r\n            $arBoton[\'siguiente\'] = \"<span> <a href=\"\\&quot;$sTmpUrl\\&quot;\">&gt;&gt;</a> </span>\";         \r\n        }\r\n        \r\n        $sTmpUrl = $sUrl . $iUltimaPagina . \"/\"; \r\n        $arBoton[\'final\'] = \"<span> <a href=\"\\&quot;$sTmpUrl\\&quot;\">&gt;|</a> </span>\"; \r\n       \r\n        return $arBoton;          \r\n    }\r\n    \r\n    public function get_items_to_show()\r\n    {\r\n        return $this-&gt;get_array_items();            \r\n    }\r\n\r\n    public function get_botones_to_show()\r\n    {\r\n        return $this-&gt;get_array_navegacion();\r\n    }\r\n    \r\n    public function get_botones_in_html()\r\n    {\r\n        $sBotonesHtml = \"\";\r\n        $arBotones = $this-&gt;get_array_navegacion();\r\n        //bug($arBotones,\'arbotones en get_botones_in_html\');\r\n        \r\n        //Navegacion inicio anterior\r\n        if(!empty($arBotones[\'nav_anterior\']))\r\n        {\r\n            $sBotonesHtml .= $arBotones[\'nav_anterior\'][\'inicio\'];\r\n            $sBotonesHtml .= $arBotones[\'nav_anterior\'][\'anterior\'];\r\n        }\r\n        //Navegacion numeros paginas\r\n        if(!empty($arBotones[\'nav_numeros\']))\r\n        {\r\n            foreach($arBotones[\'nav_numeros\'] as $sBoton)\r\n            {\r\n                $sBotonesHtml .= $sBoton;    \r\n            }\r\n        }        \r\n        //Navegacion siguiente final\r\n        if(!empty($arBotones[\'nav_siguiente\']))\r\n        {\r\n            $sBotonesHtml.= $arBotones[\'nav_siguiente\'][\'siguiente\'];\r\n            $sBotonesHtml.= $arBotones[\'nav_siguiente\'][\'final\'];\r\n        }        \r\n        \r\n        return $sBotonesHtml;\r\n    }\r\n}\r\n</pre>','Hay muchos recursos para realizar el paginado de mucha información.  Por lo que he visto en wordpress y cakephp estos metodos son complejos y dificiles de reutilizar en cualquier proyecto.\r\nPor esto he desarrollado la clase \"CPaginas\"','publish','clase-para-paginar-un-array'),(24,'2011-04-18 21:54:02','2011-07-02 15:43:50','UNED - Practica 2 - Calendario','Universidad Nacional de Educación a Distancia\r\nIngenieria Tecnica Informática de Sistemas\r\nAsignatura: Programacion I\r\nPráctica Nº: 2\r\nTitulo: Calendario \r\n\r\n<pre class=\"brush: pascal\">\r\n(*********************************************\r\n* NOMBRE          : #Eduardo        #\r\n* PRIMER APELLIDO : #Acevedo        #\r\n* SEGUNDO APELLIDO: #Farje          #\r\n* DNI  : # #\r\n* CLAVE: # #\r\n*********************************************)\r\n\r\nMODULE calenda;\r\n\r\n    FROM InOut IMPORT WriteString,Write,WriteInt,WriteLn,Read,ReadInt;\r\n\r\n    CONST\r\n        tam=27; (*longitud en caracteres a mostrar al imprimir*)\r\n        diass=7; (*los dias que componen una semana*)\r\n    TYPE\r\n        Diasemana=(Lunes,Martes,Miercoles,Jueves,Viernes,Sabado,Domingo);\r\n	RgoDia=INTEGER[1..31];\r\n        RgoMes=INTEGER[1..12];\r\n        RgoAno=INTEGER[1601..3000];\r\n\r\n    VAR\r\n	cDias,Dia1E,Dia1D,D1mesf,DUmesf:Diasemana;	\r\n	DiaF:RgoDia;		(*contiene los dias totales q trae el mes introducido*)\r\n	anoi,anof,mesi,mesf:INTEGER;\r\n	Diasdesf:INTEGER;	(*Los dias de desfase ene=0,feb=3... etc*)\r\n	cPos:INTEGER;		(*Contador para la posicion q se esta imprimiendo*)\r\n	espacios:INTEGER;	(*Espacios a dejar desde el nombre del mes impreso*)\r\n	ano,ndia,c:INTEGER;	(*contadores para for*)\r\n	tocapunto:BOOLEAN;\r\n\r\n\r\n    PROCEDURE Bis(ano:RgoAno):BOOLEAN;\r\n        VAR res:BOOLEAN;\r\n    BEGIN\r\n        IF (ano MOD 4)=0 THEN\r\n            res:=TRUE;\r\n            IF (ano MOD 400)=0 THEN\r\n                res:=TRUE;\r\n            ELSIF (ano MOD 100)=0 THEN\r\n                res:=FALSE;\r\n            ELSE\r\n                res:=TRUE;\r\n            END;\r\n        ELSE\r\n            res:=FALSE;\r\n        END;\r\n            RETURN res;\r\n    END Bis;\r\n\r\n    (* Dia de la semana obtenido ciclicamente *)\r\n    PROCEDURE DesfaseDiaSem(dia:Diasemana;ndesf:INTEGER):Diasemana;\r\n        VAR posf:INTEGER;\r\n    BEGIN\r\n        posf:=(VAL(INTEGER,ORD(dia))+ndesf) MOD diass;\r\n        RETURN VAL(Diasemana,posf)\r\n    END DesfaseDiaSem;\r\n\r\n    (* Dias que trae cualquier mes *)\r\n    PROCEDURE Diasdelmes(nmes:RgoMes;nano:RgoAno):RgoDia;\r\n\r\n    BEGIN\r\n        CASE nmes OF\r\n            1,3,5,7,8,10,12: RETURN 31  |\r\n            2: IF Bis(nano) THEN\r\n                    RETURN 29\r\n               ELSE\r\n                    RETURN 28\r\n               END                      |\r\n\r\n            ELSE\r\n                RETURN 30\r\n        END\r\n    END Diasdelmes;\r\n\r\n    (* Dias de desfase entre meses *)\r\n    PROCEDURE Desfasexmes(nmes:RgoMes):INTEGER;\r\n        VAR desfase:INTEGER;\r\n    BEGIN\r\n        CASE nmes OF\r\n            1,10:   desfase:=0  |\r\n            5:      desfase:=1  |\r\n            8:      desfase:=2  |\r\n            2,3,11: desfase:=3  |\r\n            6:      desfase:=4  |\r\n            9,12:   desfase:=5  |\r\n            ELSE\r\n                    desfase:=6\r\n        END;\r\n        RETURN desfase\r\n    END Desfasexmes;\r\n\r\n    PROCEDURE Imprimenombremes(nmes:RgoMes;VAR nespacios:INTEGER);\r\n\r\n    BEGIN\r\n        CASE nmes OF\r\n    		1:WriteString(\"ENERO\");\r\n	    	    nespacios:=tam-5	|\r\n		 2:WriteString(\"FEBRERO\");\r\n		    nespacios:=tam-7	|\r\n		 3:WriteString(\"MARZO\");\r\n		    nespacios:=tam-5	|\r\n		    4:WriteString(\"ABRIL\");\r\n		       nespacios:=tam-5	|\r\n		    5:WriteString(\"MAYO\");\r\n		       nespacios:=tam-4	|\r\n		    6:WriteString(\"JUNIO\");\r\n		       nespacios:=tam-5	|\r\n		    7:WriteString(\"JULIO\");\r\n		       nespacios:=tam-5	|\r\n		    8:WriteString(\"AGOSTO\");\r\n		       nespacios:=tam-6	|\r\n		    9:WriteString(\"SEPTIEMBRE\");\r\n		       nespacios:=tam-10	|\r\n		    10:WriteString(\"OCTUBRE\");\r\n		       nespacios:=tam-7	|\r\n		    11:WriteString(\"NOVIEMBRE\");\r\n		       nespacios:=tam-9	|\r\n		    12:WriteString(\"DICIEMBRE\");\r\n		       nespacios:=tam-9	|\r\n		    ELSE\r\n\r\n	    END\r\n    END Imprimenombremes;\r\n\r\n    PROCEDURE ImprimePuntoONumero(VAR ncontpos:INTEGER);\r\n\r\n    BEGIN\r\n	    CASE ncontpos OF\r\n		    1: 	IF tocapunto THEN\r\n			                WriteString(\" .\")\r\n                        		ELSE\r\n                            			WriteInt(ndia,2)\r\n                        		END			        	|\r\n 		    2,3,4,5,8:	IF tocapunto THEN\r\n				            WriteString(\"   .\")\r\n             		  	        	ELSE\r\n                			        WriteInt(ndia,4)\r\n              	        			END     			|\r\n		    6:	IF tocapunto THEN\r\n		              		cDias:=VAL(Diasemana,ORD(cDias)-1)\r\n		            	ELSE\r\n		              		 ndia:=ndia-1\r\n		             	END;\r\n		           	WriteString(\" |\")			|\r\n		    7:	IF tocapunto THEN\r\n		             		WriteString(\"  .\")\r\n                        		ELSE\r\n          	                		WriteInt(ndia,3)\r\n                        END			        	|\r\n            ELSE\r\n			        WriteLn;\r\n			        WriteInt(ndia,2);\r\n			        ncontpos:=1\r\n	    END\r\n    END ImprimePuntoONumero;\r\n\r\n\r\nBEGIN\r\n\r\n    WriteString(\"¨Mes (1..12)?\");\r\n    ReadInt(mesf);\r\n    WriteLn;\r\n    WriteString(\"¨A¤o (1601..3000)?\");\r\n    ReadInt(anof);\r\n    WriteLn; WriteLn;\r\n\r\n    Dia1E:=Lunes;	(* uno de enero de 1601 es lunes ira cambiando con bucle *)\r\n    anoi:=1601;\r\n    IF (anof>=1601) AND (anof<=3000) AND (mesf>=1) AND (mesf<=12) THEN\r\n    	IF anof>anoi THEN\r\n    		FOR ano:=anoi TO anof-1 DO\r\nDiasdesf:=Desfasexmes(12);		    	    Dia1D:=DesfaseDiaSem(Dia1E,Diasdesf);\r\n		        IF Bis(ano) THEN\r\n			        Dia1D:=DesfaseDiaSem(Dia1D,1) \r\n		        END;\r\n		        Dia1E:=DesfaseDiaSem(Dia1D,30+1) \r\n	        END;\r\n	        Diasdesf:=Desfasexmes(mesf);\r\n	        IF Bis(anof) AND (mesf>2) THEN\r\n	            Diasdesf:=Diasdesf+1\r\n	        END;\r\n	        D1mesf:=DesfaseDiaSem(Dia1E,Diasdesf);\r\n        ELSE\r\n	        Diasdesf:=Desfasexmes(mesf);\r\n            	        IF Bis(anof) AND (mesf>2) THEN\r\n		Diasdesf:=Diasdesf+1\r\n	        END;\r\n            	        D1mesf:=DesfaseDiaSem(Dia1E,Diasdesf)\r\n        END;\r\n\r\n        DiaF:=Diasdelmes(mesf,anof); (* se calcula los dias q trae mesf*)\r\n        DUmesf:=DesfaseDiaSem(D1mesf,DiaF-1); \r\n        Imprimenombremes(mesf,espacios); \r\n        WriteInt(anof,espacios);\r\n        WriteLn;\r\n        FOR c:=1 TO tam DO\r\n	        Write(\"=\")\r\n        END;\r\n        WriteLn;\r\n        WriteString(\"LU  MA  MI  JU  VI | SA  DO\");\r\n        WriteLn;\r\n\r\n        FOR c:=1 TO tam DO\r\n            Write(\"=\")\r\n        END;\r\n        WriteLn;\r\n        cPos:=0;\r\n        tocapunto:=FALSE;\r\n\r\n        (* puntos *)\r\n        IF D1mesf<>Lunes THEN\r\n        	    INC(cPos);\r\n    	    tocapunto:=TRUE;\r\n	        FOR cDias:=Lunes TO VAL(Diasemana,ORD(D1mesf)-1) DO\r\n		        ImprimePuntoONumero(cPos);\r\n		        INC(cPos)\r\n	        END;\r\n	        tocapunto:=FALSE;\r\n         ELSE\r\n	        INC(cPos);\r\n        END;\r\n\r\n        (* numeros *)\r\n        FOR ndia:=1 TO DiaF DO\r\n	        ImprimePuntoONumero(cPos);\r\n	        INC(cPos)\r\n        END;\r\n\r\n        (* puntos si hace falta *)\r\n        IF DUmesf<>Domingo THEN\r\n	        tocapunto:=TRUE;\r\n	        FOR cDias:=VAL(Diasemana,ORD(DUmesf)+1) TO Domingo DO\r\n		        ImprimePuntoONumero(cPos);\r\n		        INC(cPos)\r\n	        END\r\n        END;\r\n        WriteLn\r\n    END\r\nEND calenda.\r\n</pre>','Ingenieria Tecnica de Informatica de Sistemas.\r\nAsignatura: Programación I\r\nPractica II - Calendario\r\nCodigo fuente MODULA-2','publish','uned-practica-2-calendario'),(25,'2011-04-22 21:17:00','2011-07-02 15:41:33','Php Patron singleton y la clase para conectar con base de datos CBaseDatos','Se habla mucho sobre el patron de diseño singleton pero se ve pocos ejemplos orientativos sobre su utilización en un proyecto real.\r\n\r\nVoy a poner un ejemplo real.\r\n\r\nEn el proceso de creación de \"The framework\", haciendo una depuracion del codigo vi que se creaba una instancia de la clase de conexion (CBaseDatos) por cada objeto de cualquier modelo que construia.  En muchos casos hasta 16 instancias de conexiones, para una funcion que utilizaba 3 Modelos.\r\n\r\n<pre class=\"brush: php\">\r\n//MPais, MProvincia y MCiudad son clases que extienden de MainModel\r\nfunction lista_detallada_paises()\r\n{\r\n	$oPais = new MPais();\r\n	$oProvincia = new MProvincia();\r\n	$oCiudad = new MCiudad();\r\n        .....\r\n}\r\n</pre>\r\nParte del código del modelo padre MainModel\r\n<pre class=\"brush: php\">\r\nclass MainModel\r\n{\r\n...\r\nprotected $_oBD;\r\nprotected $_sTabla;     \r\nprotected $_id;   \r\n\r\npublic function __construct($sNombreTabla, $id)\r\n{\r\n    //Esta es la linea que creaba una instancia por cada objeto\r\n    //construido ejemplo: MPais(), MProvincia()...\r\n    $this->_oBD = new CBaseDatos();\r\n    $this->_oBD->conectar();\r\n    $this->_sTabla = $sNombreTabla;\r\n    $this->_id = $id;\r\n\r\n    //Funcion equivalente a var_dump\r\n    bug($this->_oBD);\r\n}\r\n...\r\n</pre>\r\n\r\nAl ejecutar la funcion lista_detallada_paises() esta mostraba el numero de recursos oBD creados.\r\n\r\nComo se han dado cuenta esto es ineficiente porque con una instancia de conexion (un objeto CBaseDatos) compartida por el resto era suficiente.\r\n\r\nEs aqui cuando decido pasar la clase CBaseDatos al patrón singleton.\r\n\r\n<pre class=\"brush: php\">\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @web www.eduardoaf.com\r\n*/\r\nclass CBaseDatos //Tipo Singleton\r\n{\r\n    //objeto resource que indicara si se ha conectado\r\n    private $_oLinkId;  \r\n    private $_sServidor;\r\n    private $_sNombreBD;\r\n    private $_sUsuario;\r\n    private $_sClave;\r\n    private $_sMensaje;\r\n    \r\n    //Almacenara un objeto de tipo CBaseDatos    \r\n    private static $_oSelf = null;\r\n    \r\n    private function __construct()\r\n    {\r\n        $this->_sServidor = sServidorBD;\r\n        $this->_sNombreBD = sNombreBD;\r\n        $this->_sUsuario = sUserBD;\r\n        $this->_sClave = sClaveBD;\r\n        $this->_sMensaje = \"\";\r\n    }\r\n    \r\n    /**\r\n    * Este es el pseudo constructor singleton\r\n    * Comprueba si la variable privada $_oSelf tiene un objeto\r\n    * de esta misma clase, sino lo tiene lo crea y lo guarda\r\n    */\r\n    public static function get_instancia()\r\n    {\r\n        //Si no hay instancia de CBaseDatos \r\n        //en la variable estatica $_oSelf\r\n        if( !self::$_oSelf instanceof self ) \r\n        {\r\n            //Se crea un objeto de CBaseDatos guardandolo\r\n            //en la varialbe estatica\r\n            //new self ejecuta __construct()\r\n            self::$_oSelf = new self;\r\n        }\r\n        //Se devuelve el objeto creado\r\n        return self::$_oSelf;\r\n    }\r\n       \r\n    /**\r\n    * Realiza la conexion y devuelve el resultado\r\n    * @return true si hubo exito en la conexion\r\n    */\r\n    public function conectar()\r\n    {\r\n        //VERIFICAMOS LA CONEXION CON MYSQL\r\n        //rCon es tipo resource si tiene exito y guarda un \"link identifier\"\r\n        //sino guarda un false\r\n        $oMysqlConnect = mysql_connect\r\n        (\r\n            $this->_sServidor,\r\n            $this->_sUsuario,\r\n            $this->_sClave\r\n        );\r\n\r\n        //si no es tipo resource es q no ha tenido exito la conexion\r\n        if(!is_resource($oMysqlConnect))\r\n        {\r\n            $this->_sMensaje = \"ERROR: No se puede conectar a la base de datos..! \".$this->_sNombreBD;\r\n            //Lanza la excepcion y se sale del procedimiento\r\n            throw new Exception($this->_sMensaje);\r\n            die;\r\n        }\r\n        \r\n        //Guardamos el id del recurso conectado\r\n        $this->_oLinkId = $oMysqlConnect;\r\n\r\n        //VERIFICAMOS QUE EXISTA LA BASE DE DATOS EN EL MOTOR\r\n        $bExisteBD  =  mysql_select_db($this->_sNombreBD, $oMysqlConnect);\r\n        //si no se pudo encontrar esa BD lanza un error\r\n        if(!$bExisteBD)\r\n        {\r\n            $this->_sMensaje = \"ERROR: No se puede usar la base de datos..! \".$this->_sNombreBD;\r\n            //Lanza la excepcion y se sale del procedimiento\r\n            throw new Exception($this->_sMensaje);\r\n            die;\r\n        }\r\n        else //Si se conectÓ\r\n        {\r\n            $this->_sMensaje = \"SE CONECTO CON EXITO\";  \r\n            mysql_set_charset(\'utf8\',$this->_oLinkId);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private function get_servidor()\r\n    {\r\n        return $this->_sServidor;\r\n    }\r\n\r\n    public function get_usuario()\r\n    {\r\n        return $this->_sUsuario;\r\n    }\r\n\r\n    private function get_clave()\r\n    {\r\n        return $this->_sClave;\r\n    }\r\n\r\n    public function get_mensaje()\r\n    {\r\n        return $this->_sMensaje;\r\n    }\r\n    \r\n    public function get_nombre_bd()\r\n    {\r\n        return $this->_sNombreBD;\r\n    }\r\n\r\n    public function get_link_id()\r\n    {\r\n        return $this->_oLinkId;\r\n    }        \r\n}\r\n</pre>\r\n\r\nDespues de la conversión a singleton, esta es la nueva forma de instanciar un objeto de CBaseDatos.\r\n\r\n<pre class=\"brush: php\">\r\nclass MainModel\r\n{\r\n...\r\nprotected $_oBD;\r\nprotected $_sTabla;     \r\nprotected $_id;   \r\n\r\npublic function __construct($sNombreTabla, $id)\r\n{\r\n    //La linea antigua\r\n    //$this->_oBD = new CBaseDatos();\r\n    //Linea en singleton\r\n    $this->_oBD = CBaseDatos::get_instancia(); \r\n    $this->_oBD->conectar();\r\n    $this->_sTabla = $sNombreTabla;\r\n    $this->_id = $id;\r\n\r\n    //Funcion equivalente a var_dump\r\n    bug($this->_oBD);\r\n}\r\n...\r\n</pre>\r\n\r\nComo se ve ya no creamos un objeto de CBaseDatos con el tipico constructor \"new CBaseDatos()\" sino que lo hacemos utilizando el metodo estatico publico que nos devuelve un objeto de este tipo.\r\n\r\nSi bien cada modelo cuando es construido tiene su atributo propio $_oBD este apunta a la única instancia de conexión.\r\n\r\nTienes algun otro ejemplo real de como utilizar este patrón?','Ejemplo practico del patrón singleton en PHP en un proyecto real.  Se basa en aplicar el patron a una clase que se encarga de realizar la conexion con la base de datos (Mysql)','publish','php-patron-singleton-y-la-clase-para-conectar-con-base-de-datos-cbasedatos'),(26,'2011-05-25 15:33:30','2011-07-02 15:45:14','Equivalencias entre particiones windows y linux','<h3>Las equivalencias sobre las particiones entre sistemas windows y linux:</h3>\r\n<ul>\r\n	<li> <strong>\"/\"  =&gt;  C:\\ </strong>\r\n\r\nPartición de volumen. Esta es la partición principal de donde colgarán el resto de particiones.</li>\r\n	<li> <strong>\"/boot\" =&gt; C:\\Windows\\system </strong>\r\n\r\nPartición de volumen. Contiene casi todo lo necesario para proceso de booteo. Almacena datos que seran usados por el sistema antes de que el nucleo (kernel) ejecute los programas de usuario.</li>\r\n	<li> <strong>\"/user\" =&gt; C:\\Archivos de programa</strong>\r\n\r\nAqui es donde se almacenaran todos los programas instalados</li>\r\n	<li> <strong>\"/home\" =&gt; “C:\\Documents and Settings\\” en Windows\r\nXP/200x o “C:\\Users\\” en vista o w2k8</strong>\r\n\r\nEsta se encargara de almacenar todos los directorios de cada usuario siempre y cuando se configure el servidor para este fin.</li>\r\n	<li> <strong>\"/var\" =&gt; “C:\\windows\\system32\\config\\”</strong>\r\n\r\nEn este espacio se almacenaran los logs de eventos de sistema.  Ya que estos tienden a crecer rapidamente lo mejor es separarlos del resto de particiones para evitar que lleguen a dejar sin espacio al sistema.</li>\r\n\r\n<li> <strong>\"/tmp \" =&gt; “C:\\Temp ”</strong><br />\r\nAlmacenara todos los archivos temporales.  Esta particion tendra permiso de escritura para cualquier usuario del sistema por lo tanto puede tener el mismo problema de crecimiento que los logs.\r\n</li>\r\n\r\n<li> <strong>\"SWAP\" =&gt; “Archivo de paginacion”</strong><br />\r\nParticion donde se almacena el archivo de memoria virtual.  Esta partición es excepcional para el sistema.  Ningun usuario podra acceder a ella (ni siquiera el root).\r\nTanto windows como linux (y derivados) menejan la memoria virtual de forma identica.  Pero siempre es mas optimo separar este archivo en una particion propia.\r\n</li>\r\n</ul>\r\n\r\n<p>\r\nTodas estas particiones se montan en el proceso de booteo.<br>\r\nEl proceso de montaje (mount) hace que se vea cada particion como un directorio mas en el sistema.<br />\r\nPor ejemplo, la particon raiz (/) se visualizara como una carpeta principal con resto de subcarpetas.<br />\r\nTodas las particiones se visualizan como directorios y no unidades fisicas distintas (como en windows).\r\nAsi, cuando se instala un programa, este no diferencia entre un disco u otro, y distribuye sus archivos en las \"carpetas\" que les corresponde.\r\n</p>','Guia para entender las particiones en linux.  Asumo que eres un usuario familiarizado con sistemas windows y deseas empezar a trabajar con linux. Lo primero es entender como se distribuye la informacion.','publish','equivalencias-entre-particiones-windows-y-linux'),(27,'2011-05-25 19:23:20','2011-07-02 15:39:06','El gestor de repositorios de linux Red hat','<h3><strong>RPM</strong> Red Hat Package Manager.</h3>\r\nSi lo queremos llevar a windows seria como un asistente de instalacion y desinstalacion de programas.\r\nNormalmente las instalaciones se hacen con software precompilado (los tipicos .exe o .msi).\r\nUn paquete es un archivo que tiene otros archivos y metadatos extra que se  utilizaran en la instalación.  En otras palabras un paquete es analogo a un archivo .zip con archivos binarios, scripts y de configuracion .conf\r\n<h3>Webs para encontrar paquetes (programas) fiables</h3>\r\n<a rel=\"nofollow\" href=\"http://rpm.pbone.net\">http://rpm.pbone.net</a>\r\n\r\n<a rel=\"nofollow\" href=\"http://mirrors.kernel.org\">http://ftp.redhat.com\r\nhttp://mirrors.kernel.org</a>\r\n\r\n<a rel=\"nofollow\" href=\"http://freshrpms.net\">http://freshrpms.net</a>\r\n\r\n&nbsp;\r\n<h3>Las funciones principales del RPM</h3>\r\nObtener información, instalación y desinstalación de programas.\r\nMantenimiento de la base de datos que guarda información relevante de los paquetes (programas) instalados.\r\nCrear empaquetado de otro software en formato RPM\r\n\r\n&nbsp;\r\n<h3>Opciones del comando RPM</h3>\r\n<table>\r\n<tbody>\r\n<tr>\r\n<td>\r\n<pre><strong>--install</strong></pre>\r\n</td>\r\n<td>Instala un paquete nuevo</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--upgrade</strong></pre>\r\n</td>\r\n<td>Actualiza (o instala si no existiera) un paquete</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--erase</strong></pre>\r\n</td>\r\n<td>Desinstala un paquete</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--query</strong></pre>\r\n</td>\r\n<td>Esta opcion se utiliza para pedir información extra sobre un programa instalado. pe. La fecha de la instalación</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--force</strong></pre>\r\n</td>\r\n<td>Por razones de estabilidad del sistema si deseamos eliminar un programa que es necesario para la ejecucion de otros. Tendriamos que desinstalar primero los \"programas hijos\" con este comando podemos desinstalar a los \"padres\"</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--h</strong></pre>\r\n</td>\r\n<td>Indica que se muestren caracteres \"#\" cuando se utiliza conjuntamente con --v</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>-percent</strong></pre>\r\n</td>\r\n<td>Muestra el porcentaje completado de la instalación</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>-nodeps</strong></pre>\r\n</td>\r\n<td>Cuando se instala una aplicacion esta comprueba si hacen falta otras librerias previamente instaladas, si no estan se aborta la instalación. Con esta opcion se omite esa comprobación.</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>-q</strong></pre>\r\n</td>\r\n<td>Pide determinada información al sistema RPM</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>--test</strong></pre>\r\n</td>\r\n<td>Ejecuta una emulación de instalación. Sirve para comprobar si habria algun tipo de error con el programa a instalar.</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>-V</strong></pre>\r\n</td>\r\n<td>Comprueba paquetes o archivos en el sistema</td>\r\n</tr>\r\n<tr>\r\n<td>\r\n<pre><strong>-v</strong></pre>\r\n</td>\r\n<td>Verbose. Muestra por pantalla las acciones que se estan ejecutando en el proceso de instalación</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n&nbsp;\r\n<h3>Algunos ejemplos</h3>\r\n<pre><strong>[eduardo@localhost ~]# rpm --query --all</strong>\r\nMostrara todos los programas instalados\r\n\r\n<strong>[eduardo@localhost ~]# rpm --query bash</strong>\r\nMuestra:\r\nbash-4.1.7-3.fc14.i686\r\n\r\n<strong>[eduardo@localhost ~]# rpm -qi bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\nName        : bash                         Relocations: (not relocatable)\r\nVersion     : 4.1.7                             Vendor: Fedora Project\r\nRelease     : 3.fc14                        Build Date: Tue 22 Jun 2010 05:17:44 PM CEST\r\nInstall Date: Fri 22 Oct 2010 08:15:51 PM CEST      Build Host: x86-03.phx2.fedoraproject.org\r\nGroup       : System Environment/Shells     Source RPM: bash-4.1.7-3.fc14.src.rpm\r\nSize        : 3107578                          License: GPLv3+\r\nSignature   : RSA/SHA256, Wed 28 Jul 2010 08:46:37 PM CEST, Key ID 421caddb97a1071f\r\nPackager    : Fedora Project\r\nURL         : http://www.gnu.org/software/bash\r\nSummary     : The GNU Bourne Again shell\r\nDescription :\r\nThe GNU Bourne Again shell (Bash) is a shell or command language\r\ninterpreter that is compatible with the Bourne shell (sh). Bash\r\nincorporates useful features from the Korn shell (ksh) and the C shell\r\n(csh). Most sh scripts can be run by bash without modification.\r\n\r\n<strong>[eduardo@localhost ~]# rpm -ql bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\n/bin/bash\r\n/bin/sh\r\n/etc/skel/.bash_logout\r\n/etc/skel/.bash_profile\r\n/etc/skel/.bashrc\r\n/usr/bin/bashbug-32\r\n/usr/share/doc/bash-4.1.7/COPYING\r\n/usr/share/info/bash.info.gz\r\n/usr/share/locale/af/LC_MESSAGES/bash.mo\r\n/usr/share/locale/bg/LC_MESSAGES/bash.mo\r\n/usr/share/locale/ca/LC_MESSAGES/bash.mo\r\n/usr/share/locale/cs/LC_MESSAGES/bash.mo\r\n/usr/share/locale/de/LC_MESSAGES/bash.mo\r\n/usr/share/locale/en@boldquot/LC_MESSAGES/bash.mo\r\n/usr/share/locale/en@quot/LC_MESSAGES/bash.mo\r\n/usr/share/locale/eo/LC_MESSAGES/bash.mo\r\n....\r\n\r\n<strong>[eduardo@localhost ~]# rpm -qc bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\n/etc/skel/.bash_logout\r\n/etc/skel/.bash_profile\r\n/etc/skel/.bashrc\r\n\r\n<strong>[eduardo@localhost ~]# rpm -q --qf \"[ %{INSTALLTIME:date} \\n]\" bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\nFri 22 Oct 2010 08:15:51 PM CEST\r\n\r\n<strong>[eduardo@localhost ~]# rpm -q --qf \"[ %{GROUP} \\n]\" bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\nSystem Environment/Shells \r\n\r\n<strong>[eduardo@localhost ~]# rpm -q --qf \"[%{NAME} - %{GROUP} - %{SUMMARY} \\n]\" bash xterm</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\nbash - System Environment/Shells - The GNU Bourne Again shell\r\npackage xterm is not installed\r\n\r\n<strong>[eduardo@localhost ~]# rpm -q --whatrequires bash</strong>\r\n<span style=\"color: #99cc00;\">Muestra:</span>\r\ninitscripts-9.20.1-1.fc14.i686\r\nrsyslog-4.6.3-1.fc14.i686\r\ncronie-1.4.5-2.fc14.i686\r\nPackageKit-command-not-found-0.6.9-4.fc14.i686\r\nsendmail-8.14.4-9.fc14.i686\r\ndracut-006-3.fc14.noarch</pre>\r\n&nbsp;','Se resume e indica las funciones y opciones del comando rpm de linux.  Con algunas opciones se muestran ejemplos de su ejecución.','publish','el-gestor-de-repositorios-de-linux-red-hat'),(28,'2011-05-26 10:36:56','2011-07-02 15:36:30','Comprimir y descomprimir archivos en linux','<h3>El comando tar</h3>\r\nLa compresion de un archivo/capreta se basa en dos pasos\r\n<ul>\r\n	<li>Empaquetado</li>\r\n	<li>Compresión</li>\r\n</ul>\r\nCuando comprimimos una carpeta en linux con el <strong>comando \"tar\"</strong> primero debemos empaquetar, es decir, juntamos todos los archivos en uno solo, como una especie de concatenacion binaria.(<strong>opción c:crear archivo unico y f:empaquetar</strong>)  En este punto el tamaño no se ha reducido.\r\nSeguidamente hay que especificar al comando tar que reduzca (comprima) el tamaño del archivo unificado <strong>(opción z)</strong>.\r\n\r\nExisten muchas más opciones utilizadas con tar, solo mostraré las que utilizo habitualmente.\r\n\r\nLa sintaxis es la siguiente:\r\n<pre><strong>tar[opciones]\r\n[ruta y nombre del archivo comprimido]\r\n[ruta y nombre del dir/archivo a comprimir]</strong></pre>\r\n<h3>Ejemplos:</h3>\r\n<pre><strong>Comprimir</strong> mi carpeta con clases de php que esta en mi carpeta\r\nhome (home se especifica con ~, alt+126).\r\n<span style=\"color: #339966;\"><strong>tar cfzv ~/compresion_dir_clases_php.tgz ~/dir_clases_php</strong></span>\r\nc: creo el archivo único\r\nf: empaquetar los archivos en el archivo unificado\r\nz: comprimo el archivo unificado\r\nv: (verbose) mostrar el progreso de compresión\r\n\r\nSi desamos <strong>desempaquetar </strong>un archivo llamado \"archivo_unico<strong>.tar</strong>\" podemos\r\nutilizar el siguiente comando:\r\n<span style=\"color: #339966;\"><strong>tar fxv archivo_unico.tar</strong></span>\r\nx: extract\r\nf: archivo empaquetado\r\nv: muestra el progreso de la operación\r\n\r\nSi deseamos <strong>desempaquetar </strong>y al mismo tiempo <strong>descomprimir</strong> un archivo\r\nllamado \"archivo_unico.<strong>tgz</strong>\"\r\n<span style=\"color: #339966;\"><strong>tar fxzv archivo_unico.tgz</strong></span>\r\n\r\n<strong>Listar</strong> los archivos de un empaquetado:\r\n<span style=\"color: #339966;\"><strong>tar -tf mi_archivo.tar</strong></span>\r\n</pre>','Explicación básica del comando tar utilizado para la compresión, empaquetado, desempaquetado y descompresión de archivos en linux.  Este comando esta disponible en todas las distribuciones.','publish','comprimir-y-descomprimir-archivos-en-linux'),(29,'2011-07-02 09:26:31','2011-07-02 15:54:49','PHP - Cómo utilizar la clase CBaseDatos de tipo singleton','<h3>PHP Ejemplo detallado de la utilización de la clase CBaseDatos</h3>\r\n\r\nPrimeramente saludar y pedir disculpas a <em><b>Marco </b></em>y <em><b>Pere</b></em> que comentarón en la entrada: <strong><a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/php-patron-singleton-y-la-clase-para-conectar-con-base-de-datos-cbasedatos/\">Php Patron singleton y la clase para conectar con base de datos CBaseDatos</a></strong> ,  por no haber creado el ejemplo antes.  Cuestion de tiempo.  Espero que aun les sirva el post.\r\n\r\nPartamos sobre la base que estamos trabajando en la arquitectura 3 capas, Modelo Vista Controlador.\r\n\r\nAntes del ejemplo un apunte. <strong>\"CBaseDatos\"</strong> se llama así porque la <strong>\"C\"</strong> indica que es un componente, Que es una clase parecida a un \"helper\" que se puede instanciar en tu Modelo, Controlador y/o Helper. \r\n<strong>\"BaseDatos\"</strong> porque gestiona las conexiones.\r\n\r\n<h3>El ejemplo:</h3>\r\nAsumamos que tenemos una tabla con usuarios con los campos id (como: primary key), nombre, email y clave. llamemosla tbl_usuario.\r\n\r\n<h4>1- La clase componente CBaseDatos:</h4>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @web www.eduardoaf.com\r\n* @Nombre del archivo: component_base_datos.php\r\n*/\r\nclass CBaseDatos //Tipo Singleton\r\n{\r\n    //almacena un objeto resourse que tiene un identificador de\r\n    //conexion \"linkid\" o 0 en caso de error   \r\n    private $_oLinkId;  \r\n    private $_sServidor;\r\n    private $_sNombreBD;\r\n    private $_sUsuario;\r\n    private $_sClave;\r\n    private $_sMensaje;\r\n        \r\n    private static $_oSelf = null;\r\n    \r\n    private function __construct()\r\n    {\r\n		/*\r\n		En el post anterior utilizo constantes, pero si lo deseas\r\n		puedes escribir directamente los valores o incluso pasar \r\n		estos valores en el constructor. Es un poco segun tus necesidades.  \r\n		Si se pasa los valores en constructor daria versatilidad\r\n		en conexiones con bd distintas en un mismo proyecto. \r\n		En alguna ocasion para migraciones lo he implementado por parametros.\r\n		__construct($sServidor,$sNombreBD..);\r\n		*/\r\n        $this->_sServidor = \"192.168.1.231\";\r\n        $this->_sNombreBD = \"bd_tienda_virtual\";\r\n        $this->_sUsuario = \"imthemaster\";\r\n        $this->_sClave = \"ElSeRvIdOr231\";\r\n        $this->_sMensaje = \"\";\r\n    }\r\n    \r\n    /**\r\n    * Este es el pseudo constructor singleton\r\n    * Comprueba si la variable privada $_oSelf tienen un objeto\r\n    * de esta misma clase, sino lo tiene lo crea y lo guarda\r\n    */\r\n    public static function get_instancia()\r\n    {\r\n        //Si no hay instancia de CBaseDatos \r\n        //en la variable estatica $_oSelf\r\n        if( !self::$_oSelf instanceof self ) \r\n        {\r\n            //Se crea un objeto de CBaseDatos guardandolo\r\n            //en la varialbe estatica\r\n            //new self ejecuta __construct()\r\n            self::$_oSelf = new self;\r\n        }\r\n        //Se devuelve el objeto creado\r\n        return self::$_oSelf;\r\n    }\r\n       \r\n    /**\r\n    * Crea un oRecurso de conexion y lo asigna a oLinkId.\r\n    * Si oLinkId es 0. Es porque el recurso no existe\r\n    * Realiza la conexion y devuelve el resultado\r\n    * @return true si hubo exito en la conexion\r\n    */\r\n    public function conectar()\r\n    {\r\n        //Si no existe un recurso previo se intenta crear uno nuevo\r\n        if($this->_oLinkId==0)\r\n        {\r\n            //VERIFICAMOS LA CONEXION AL MOTOR DE BD\r\n            //oMysqlConnect es tipo resource si tiene exito y guarda un \"link identifier\"\r\n			//algo como 5893, vamos un entero.\r\n            //sino guarda un false (0)\r\n            $oMysqlConnect = mysql_connect\r\n            (\r\n                $this->_sServidor,\r\n                $this->_sUsuario,\r\n                $this->_sClave\r\n            );\r\n\r\n            //si no es tipo resource es q no ha tenido exito la conexion;\r\n            if(!is_resource($oMysqlConnect))\r\n            {\r\n                $this->_sMensaje = \"ERROR: No se puede conectar a la base de datos..! \".$this->_sNombreBD;\r\n                //Lanza la excepcion y se sale del procedimiento\r\n                throw new Exception($this->_sMensaje);\r\n                die;\r\n            }\r\n            \r\n            //Guardamos el id del recurso conectado, esta propiedad nos servirá\r\n			//cuando queramos ejecutar una SQL contra la BD deberemos utilizar \r\n			//la propiedad get_link_id(). Lo veremos más abajo en este post\r\n            $this->_oLinkId = $oMysqlConnect;\r\n\r\n            //VERIFICAMOS QUE EXISTA LA BASE DE DATOS EN EL MOTOR\r\n            $bExisteBD  =  mysql_select_db($this->_sNombreBD, $oMysqlConnect);\r\n            //si no se pudo encontrar esa BD lanza un error\r\n            if(!$bExisteBD)\r\n            {\r\n                $this->_sMensaje = \"ERROR: No se puede usar la base de datos..! \".$this->_sNombreBD;\r\n                //Lanza la excepcion y se sale del procedimiento\r\n                throw new Exception($this->_sMensaje);\r\n                die;\r\n            }\r\n            else //Si se conecto\r\n            {\r\n                $this->_sMensaje = \"SE CONECTO CON EXITO\";  \r\n                mysql_set_charset(\'utf8\',$this->_oLinkId);\r\n            }\r\n\r\n        }//fin Ya existe recurso abierto por lo tanto se puede instanciar con get_link_id()\r\n        return true;\r\n    }\r\n\r\n    private function get_servidor()\r\n    {\r\n        return $this->_sServidor;\r\n    }\r\n\r\n    public function get_usuario()\r\n    {\r\n        return $this->_sUsuario;\r\n    }\r\n\r\n    private function get_clave()\r\n    {\r\n        return $this->_sClave;\r\n    }\r\n\r\n    public function get_mensaje()\r\n    {\r\n        return $this->_sMensaje;\r\n    }\r\n    \r\n    public function get_nombre_bd()\r\n    {\r\n        return $this->_sNombreBD;\r\n    }\r\n\r\n	/**\r\n	* Devuelve un entero mayor a 0 si hay conexión. \r\n	* En caso contrario 0\r\n	*/\r\n    public function get_link_id()\r\n    {\r\n        return $this->_oLinkId;\r\n    }        \r\n}\r\n?&gt;\r\n</pre>\r\n\r\n<h4>2- Nuestro Modelo \"MUsuario\"</h4>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @web www.eduardoaf.com\r\n* @Nombre del archivo: model_usuario.php\r\n*/\r\n\r\nclass MUsuario \r\n{\r\n	//Una instancia de\r\n	private $_oBaseDatos;\r\n	private $_sTabla;\r\n	private $_id; //Clave primaria, autonumerico\r\n    private $_nombre; \r\n    private $_email; \r\n    private $_clave;\r\n\r\n    public function __construct($id=0, $sNombre=\"\", $sEmail=\"\", $sClave=\"\")\r\n    {\r\n		//Abrimos un flujo de conexion con nuestro componente\r\n		$this->_oBaseDatos = CBaseDatos::get_instancia();\r\n        $this->_oBaseDatos->conectar();\r\n		//var_dump($this->oBaseDatos); \r\n		$this->_sTabla = \"tbl_usuario\";\r\n		$this->_id = $id;\r\n        $this->_nombre = $sNombre;\r\n        $this->_email = strtolower($sEmail);\r\n        $this->_clave = $sClave;\r\n    } \r\n	\r\n	/**\r\n	* Sobre los 3 metodos: query(), query_object() y execute()\r\n	* Lo ideal seria crear una clase madre con los atributos:\r\n	* oBaseDatos, id, sTabla y estos metodos de modo que todos los\r\n	* modelos hereden (extiendan) estas propiedades.\r\n	* La definicion de esta clase seria: class MUsuario extends ModeloMadre{..}.\r\n	* No lo he puesto\r\n	* aqui porque el post seria demasiado extenso.\r\n	*/\r\n	\r\n	/**\r\n	* Se utiliza para SQLs tipo SELECT, es decir, de lectura y \r\n	* devuelve un array con el resultado\r\n	*/\r\n    private function query($sSQL)\r\n    {\r\n        $arTabla = array();\r\n        try\r\n        {\r\n			/**\r\n			* resource = mysql_query ( string $query [, resource $link_identifier ] )\r\n			* Aqui entra en juego nuestro Componente tipo singleton CBaseDatos\r\n			*/\r\n            $oResult = mysql_query($sSQL, $this->_oBaseDatos->get_link_id());\r\n\r\n			/**\r\n			* array = mysql_fetch_array ( resource $result [, int $result_type = MYSQL_BOTH ] )\r\n			*/\r\n            while($arFila = mysql_fetch_array($oResult, MYSQL_ASSOC))\r\n            {\r\n                $arTabla[$this->_sTabla][] = $arFila; \r\n            }\r\n			\r\n            //Array que tiene como indices los nombres de los campos\r\n			//$arTabla[\'tbl_usuario\'][iNumeroFila] = array(\'id\'=>\'valor\',\'nombre\'=>\'valor\'...);\r\n            return $arTabla;\r\n        }\r\n        catch (Exception $e)\r\n        {\r\n            die(\"Metodo query: Error al ejecutar la sentencia SQL = $sSQL\");\r\n        }\r\n    } \r\n   \r\n	/**\r\n	* Se utiliza para SQLs tipo SELECT, es decir, de lectura y \r\n	* devuelve un array con el resultado parecido al anterior\r\n	* pero este crea un array de pseudo objetos. de modo que puedas\r\n	* recuperar un item del array en forma de $arUsuario[$i]->nombre su equivalente\r\n	* en el metodo anterior seria $arUsuario[$i][\'nombre\'].\r\n	*/	\r\n    private function query_object($sSQL)\r\n    {\r\n        $arTabla = array();\r\n		\r\n        $oResult = mysql_query($sSQL, $this->_oBaseDatos->get_link_id());\r\n\r\n        if($oResult)\r\n        {\r\n            while($arFila = mysql_fetch_object($oResult))\r\n            {\r\n                $arTabla[] = $arFila; \r\n            }\r\n        }\r\n        else\r\n        {\r\n            die(\"Metodo query_object: Error al ejecutar la sentencia SQL = $sSQL\");  \r\n        }\r\n		//$arTabla[$i]->id, $arTabla[$i]->nombre, $arTabla[$i]->clave ...\r\n        return $arTabla;\r\n    }   \r\n    \r\n	/**\r\n	* Este metodo ejecuta una SQL de escritura.\r\n	* estas son INSERT, UPDATE y DELETE\r\n	*/\r\n    private function execute($sSQL)\r\n    {\r\n        try\r\n        {\r\n            //$this->oTfw->set_sql($sSQL);\r\n            $oResult = mysql_query($sSQL);\r\n            //@mysql_query(\"SET NAMES utf8\"); \r\n            \r\n            if (!$oResult)\r\n            {\r\n                $sMensaje  = \"Sentencia SQL con errores: \" . mysql_error() . \"\\n\";\r\n                $sMensaje .= \"SQL =\"  . $sSQL;\r\n                die($sMensaje);\r\n            }\r\n        }\r\n        catch(Exception $e)\r\n        {\r\n\r\n        }        \r\n    }\r\n    \r\n	/**\r\n	* Utilizado para cargar los datos de un registro de la \r\n	* tabla (un usuario) en los atributos privados.\r\n	* Recupera un usuario\r\n	*/\r\n    public function load_atributos()\r\n    {\r\n        $arUsuario = null;\r\n        $sSQL=\"\r\n            SELECT * \r\n            FROM $this->_sTabla \r\n            WHERE id=\'$this->_id\'\r\n            \";\r\n        $arUsuario = $this->query($sSQL);\r\n\r\n        $this->_id = $arUsuario[$this->_sTabla][0][\'id\'];\r\n        $this->_nombre = $arUsuario[$this->_sTabla][0][\'nombre\'];\r\n        $this->_email = $arUsuario[$this->_sTabla][0][\'email\'];\r\n        $this->_clave = $arUsuario[$this->_sTabla][0][\'clave\'];\r\n    }\r\n\r\n    public function agregar()\r\n    {\r\n        $nombre = $this->_nombre;\r\n        $email = $this->_email; \r\n		$clave = $this->_clave;\r\n        \r\n        $sSQL=\"INSERT INTO $this->_sTabla \r\n               (nombre,  email, clave)\r\n               VALUES(\'$nombre\',\'$email\',\'$clave\')\";\r\n        \r\n        $this->execute($sSQL);\r\n    }\r\n\r\n    public function modificar()\r\n    {\r\n        $id_usuario = $this->_id;\r\n        $nombre = $this->_nombre;\r\n        $email = $this->_email; \r\n        $clave = $this->_clave;\r\n        \r\n        $sSQL=\"UPDATE $this->_sTabla \r\n               SET\r\n               nombre = \'$nombre\',\r\n               email = \'$email\',\r\n               clave = \'$clave\'\r\n               WHERE id = $id_usuario\r\n               \";\r\n        \r\n        $this->execute($sSQL);\r\n    }\r\n    \r\n    public function get_tabla()\r\n    {\r\n        $arTabla = array();\r\n        $sSQL = \"\r\n                SELECT * \r\n                FROM $this->_sTabla  \r\n                ORDER BY nombre ASC\r\n                \";\r\n        $arTabla = $this->query_object($sSQL);\r\n        return $arTabla;\r\n    }  \r\n        \r\n	/**\r\n	* GETS Y SETS \r\n	* Siguiendo la norma de encapsulacion de atributos definimos estos metodos\r\n	*/\r\n	public function get_id()\r\n	{\r\n		return $this->_id;\r\n	}\r\n		\r\n    public function get_nombre()\r\n    {\r\n        return $this->_nombre;\r\n    }\r\n\r\n    public function get_email()\r\n    {\r\n        return $this->_email;\r\n    }\r\n    \r\n    public function set_nombre($sValor)\r\n    {\r\n        $this->_nombre = $sValor;\r\n    }\r\n\r\n    public function set_email($sValor)\r\n    {\r\n        $this->_email =  strtolower($sValor);\r\n    } \r\n    \r\n    public function set_clave($sValor)\r\n    {\r\n        $this->_clave = $sValor;\r\n    } \r\n}\r\n?&gt;\r\n</pre>\r\n\r\n<h4>3- El controlador \"ControllerUsuarios\"</h4>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @web www.eduardoaf.com\r\n* @Nombre del archivo: controller_usuarios.php\r\n*/\r\nclass ControllerUsuarios\r\n{\r\n\r\n    public function lista()\r\n    {\r\n		//Construimos nuestro objeto Usuario\r\n		$oUsuario = new MUsuario();\r\n		$arTablaUsuarios = $oUsuario->get_tabla();\r\n		/*\r\n		* Marco con respecto al ejemplo que pedias para la utilización\r\n		* de la \"clase para paginar cualquier array\" seria el siguiente:\r\n		* http://www.eduardoaf.com/blog-programacion/programacion-php/clase-para-paginar-un-array/\r\n		*/\r\n		\r\n		//Comprobamos si nos viene algo en la variable \"page\". Sea cual sea el\r\n		//valor esto lo gestiona el componente CPaginas. Si es nula asume\r\n		//que la pagina pedida es la 1\r\n		$iPagina = $_GET[\'page\'];\r\n		$sUrl = \"protocol//www.tudominio.com/vistas/lista_usuarios.php?page=\";\r\n		$oPagina = new CPaginas($arTablaUsuarios, $iPagina, $sUrl, 8);\r\n		//Reutilizamos el array dejando solo los items que le corresponde\r\n		//a la pagina $iPagina\r\n		$arTablaUsuarios = $oPagina->get_items_to_show();\r\n		$sBotones = $oPagina->get_botones_in_html();\r\n\r\n		$_SESSION[\'arTablaUsuarios\'] = $arTablaUsuarios;\r\n		$_SESSION[\'sBotones\'] = $sBotones;\r\n    }\r\n	\r\n	public function agregar()\r\n	{\r\n		//No voy hacer todo el metodo pero si lo más importante\r\n		$sNombre = $_POST[\'txtNombre\'];\r\n		$sEmail = $_POST[\'txtEmail\'];\r\n		//aqui lo logico es aplicar alguna encriptacion para guardarlo\r\n		//se que ya lo estabas pensando pero sino llueven criticas xD\r\n		$sClave = $_POST[\'txtPassword\'];\r\n		\r\n		//Aqui habria que validar todos estos datos antes de pasarlo\r\n		//al modelo, crear un metodo is_datos_validos(){}\r\n		//Construimos nuestro objeto Usuario\r\n		$oUsuario = new MUsuario(null,$sNombre,$sEmail,$sClave);\r\n		$oUsuario->agregar();\r\n		$_SESSION[\'Mensaje\'] = \"Usuario Agregado\";\r\n	}\r\n\r\n	public function ficha()\r\n	{\r\n		$id_usuario = $_GET[\'id_usuario\'];\r\n		//Construimos nuestro objeto Usuario\r\n		$oUsuario = new MUsuario($id_usuario);\r\n		//Para esto sirve el metodo load atributos, obtiene\r\n		//el registro por su clave principal.\r\n		$oUsuario->load_atributos();\r\n		$_SESSION[\'oUsuario\'] = $oUsuario;\r\n	}\r\n	\r\n	//Los metodos eliminar() y modificar() son similares a los anteriores.\r\n}\r\n?&gt;\r\n</pre>\r\n\r\n<h4>3- La vista \"ViewUsuariosLista\"</h4>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @web www.eduardoaf.com\r\n* @Nombre del archivo: lista_usuarios.php\r\n*/\r\n\r\n//IMPORTAMOS TODOS NUESTROS INGREDIENTES :)\r\ninclude(\"../componentes/component_paginas.php\");\r\ninclude(\"../componentes/component_base_datos.php\");\r\ninclude(\"../modelos/model_usuario.php\");\r\ninclude(\"../controladores/controller_usuarios.php\");\r\nsession_start();\r\n//Suponemos que la llamada a este archivo se hace con \r\n//protocol//www.tudominio.com/vistas/lista_usuarios.php\r\n\r\n$oContolUsuarios = new ControllerUsuarios();\r\n//Esto nos ha guardado los datos en las variables de sesion\r\n$oContolUsuarios->lista();\r\n\r\n$arTablaUsuarios = $_SESSION[\'arTablaUsuarios\']; \r\n//Los links de los botones estaran formados con la url: \r\n//http://www.tudominio.com/vistas/lista_usuarios.php?page=i\r\n$sBotones = $_SESSION[\'sBotones\'];\r\n\r\n?&gt;\r\n&lt;html&gt;\r\n	&lt;head&gt;&lt;/head&gt;\r\n	&lt;body&gt;\r\n&lt;?php\r\n	//Como la tabla la he crado con el metodo query_object me devuelve un array\r\n	//de seudo objetos usuario\r\n	foreach($arTablaUsuarios as $oSeudo)\r\n	{\r\n		echo \"Nombre: \" .$oSeudo-&gt;nombre .\"&lt;br&gt;\";\r\n		echo \"Email: \" .$oSeudo-&gt;email .\"&lt;br&gt;\";\r\n		echo \"Numero: \" .$oSeudo-&gt;id .\"&lt;br&gt;\";\r\n	}\r\n	\r\n	//Imprimo la paginacion\r\n	echo $sBotones;\r\n?&gt;	\r\n	&lt;/body&gt;\r\n&lt;/html&gt;\r\n</pre>\r\n<p>\r\nAl final en la vista he realizado un poco de lógica, es por simplicidad.  De lo contrario habria que meterse con enrutadores (otra clase más) y <strong>.htaccess</strong>.\r\n</p>\r\n<p>\r\nComentar a todo esto que he creado un framework <a href=\"http://www.eduardoaf.com/blog-frameworks/frameworks-the-framework/\" >\r\n<strong><em>\"The Framework\"</em></strong></a> que dentro de poco subiré para que lo puedan descargar. \r\n\r\nLa filosofia será parecida a la que he expuesto aqui, <strong>MVC</strong> pero sin pasar valores a la vista con $_SESSION sino que esto lo llevaria a cabo el framework.\r\n<br />\r\nOtra ventaja es que nos evitará hacer includes y la necesidad de crear una instancia del <strong>Controlador</strong> en la <strong>vista.</strong>\r\n</p>\r\n<p>\r\nPD: UTILIZO protocol porque sino el syntaxhighlighter me crea urls 404. Ustedes cambienlo por http.\r\n</p>\r\n','Si bien en la entrada anterior hago incapie en la utilizacion de esta clase.  En este post explico de forma mas extendida como utilizarla dentro de una arquitectura MVC.','publish','php-como-utilizar-la-clase-cbasedatos-de-tipo-singleton'),(30,'2011-12-10 19:58:48','2011-12-10 21:08:56','Cómo usar FPDF para la creación de pdf\'s en PHP','En el artículo: <a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/la-clase-de-terceros-fpdf/\" target=\"_blank\" >La clase de terceros fpdf</a> indico como solucionar el error de codificación (tildes) en el documento generado.\r\nAhora, hago una demostración mas detallada de como extender la clase FPDF utilizando la metodologia de la programación orientada a objetos (POO ó OOP sus siglas en ingles).\r\n\r\nPara el ejemplo he utilizado mi microframework de pruebas \"proy_anytest\".  Los metodos con texto IMPORT no son mas que simples includes, pero controlados.  Tfw, hace referencia a \"The Framework\" es la clase core de <a href=\"http://the-framework.eduardoaf.com/\"><em>mi framework</em></a>.\r\n\r\nEmpiezo con la definicion de mis clases \"modelos\" si nos basamos en el patrón MVC\r\nLa clase CCliente y CFactura deberian recuperar los datos que se visualizan en el constructor desde una base de datos, para no extenderme mucho los emulo con:\r\n<pre class=\"brush: php\">\r\n//La clase CCliente deberia ser un modelo, aqui estoy emulando el objeto.\r\n$oCliente = new CCliente(\"E.M.P. Cliente S.L\", \"12345678\", \"San Fermin 12\", \"28006\", \"Madrid\");\r\n$oFactura = new CFactura(\"1 de Enero de 2011\", 250.50, 225.25, 25.25, \"FAC0000123\");\r\n</pre>\r\nEsta es su estructura:\r\nClase CCliente: Representa a la tabla clientes\r\n<pre class=\"brush: php\">\r\nclass CCliente\r\n{\r\n    private $_empresa;\r\n    private $_cifnif;\r\n    private $_direccion;\r\n    private $_codigo_postal;\r\n    private $_ciudad;\r\n  \r\n    private $_sMensaje;\r\n\r\n    public function __construct($empresa, $cifnif, $direccion, $codigo_postal, $ciudad) \r\n    {\r\n        $this->_empresa = $empresa;\r\n        $this->_cifnif = $cifnif;\r\n        $this->_direccion = $direccion;\r\n        $this->_codigo_postal = $codigo_postal;\r\n        $this->_ciudad = $ciudad;\r\n    }\r\n    \r\n    //===========================     SETS     ===========================\r\n    public function set_empresa($empresa)\r\n    {\r\n        $this->_empresa = $empresa;\r\n    }\r\n\r\n    public function set_cifnif($cifnif)\r\n    {\r\n        $this->_cifnif = $cifnif;\r\n    }\r\n    \r\n    public function set_direccion($direccion)\r\n    {\r\n        $this->_direccion = $direccion;\r\n    }\r\n    \r\n    public function set_codigo_postal($codigo_postal)\r\n    {\r\n        $this->_codigo_postal = $codigo_postal;\r\n    }\r\n    \r\n    public function set_ciudad($ciudad)\r\n    {\r\n        $this->_ciudad = $ciudad;\r\n    }    \r\n\r\n    /*\r\n    public function set_propiedad($propiedad)\r\n    {\r\n        $this->_propiedad = $propiedad;\r\n    }*/\r\n    \r\n    //===========================     GETS     ===========================\r\n    public function get_empresa()\r\n    {\r\n        return $this->_empresa;\r\n    }\r\n    \r\n    public function get_cifnif()\r\n    {\r\n        return $this->_cifnif;\r\n    }\r\n    public function get_direccion()\r\n    {\r\n        return $this->_direccion;\r\n    }\r\n    public function get_codigo_postal()\r\n    {\r\n        return $this->_codigo_postal;\r\n    }\r\n    public function get_ciudad()\r\n    {\r\n        return $this->_ciudad;\r\n    }\r\n    \r\n    /*\r\n    public function get_propiedad()\r\n    {\r\n        return $this->_propiedad;\r\n    }\r\n    */\r\n    \r\n    //===========================     METODOS     ===========================    \r\n    public function is_error()\r\n    {\r\n        if(!empty($this->_sMensaje))\r\n        {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    \r\n    public function get_mensaje()\r\n    {\r\n        return $this->_sMensaje;\r\n    }\r\n}\r\n</pre>\r\nClase CFactura: Representa a la tabla facturas\r\n<pre class=\"brush: php\">\r\nclass CFactura\r\n{\r\n    private $_fecha;\r\n    private $_total;\r\n    private $_subtotal;\r\n    private $_iva;\r\n    private $_numero;\r\n    \r\n    private $_sMensaje;\r\n\r\n\r\n    public function __construct($fecha, $total, $subtotal, $iva, $numero) \r\n    {\r\n        $this->_sMensaje = \"\";\r\n        \r\n        $this->_fecha = $fecha;\r\n        $this->_total = $total;\r\n        $this->_subtotal = $subtotal;\r\n        $this->_iva = $iva;\r\n        $this->_numero = $numero;\r\n        \r\n    }\r\n    \r\n    //===========================     SETS     ===========================\r\n    public function set_fecha($fecha)\r\n    {\r\n        $this->_fecha = $fecha;\r\n    }\r\n    \r\n    public function set_total($total)\r\n    {\r\n        $this->_total = $total;\r\n    }\r\n\r\n    public function set_subtotal($subtotal)\r\n    {\r\n        $this->_subtotal = $subtotal;\r\n    }\r\n    \r\n    public function set_iva($iva)\r\n    {\r\n        $this->_iva = $iva;\r\n    }\r\n    \r\n    public function set_numero($numero)\r\n    {\r\n        $this->_numero = $numero;\r\n    }\r\n    \r\n    \r\n    /*\r\n    public function set_propiedad($propiedad)\r\n    {\r\n        $this->_propiedad = $propiedad;\r\n    }*/\r\n    \r\n    //===========================     GETS     ===========================\r\n    public function get_fecha()\r\n    {\r\n        return $this->_fecha;\r\n    }\r\n    \r\n    public function get_total()\r\n    {\r\n        return $this->_total;\r\n    }\r\n    \r\n    public function get_subtotal()\r\n    {\r\n        return $this->_subtotal;\r\n    }\r\n    public function get_iva()\r\n    {\r\n        return $this->_iva;\r\n    }\r\n    public function get_numero()\r\n    {\r\n        return $this->_numero;\r\n    }\r\n        \r\n    public function get_detalle()\r\n    {\r\n        $arDetalle = array\r\n        (\r\n            array(\"CONCEPTO\"=>\"Articulo uno \",\"CANTIDAD\"=>55.50),\r\n            array(\"CONCEPTO\"=>\"Concepto dos \",\"CANTIDAD\"=>44.50),\r\n            array(\"CONCEPTO\"=>\"Descripcion tres \",\"CANTIDAD\"=>125.25)\r\n        );\r\n        return $arDetalle;\r\n    }\r\n    \r\n    \r\n    /*\r\n    public function get_propiedad()\r\n    {\r\n        return $this->_propiedad;\r\n    }\r\n    */\r\n    \r\n    //===========================     METODOS     ===========================    \r\n    public function is_error()\r\n    {\r\n        if(!empty($this->_sMensaje))\r\n        {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    \r\n    public function get_mensaje()\r\n    {\r\n        return $this->_sMensaje;\r\n    }\r\n}\r\n</pre>\r\nCon nuestros modelos ya definidos ahora pasamos a extender FPDF.  Sobre el contenido comentar que es un paquete .zip tipo plugin.  Se copia TODA LA CARPETA \"Fpdf17\" en el proyecto y se incluye el archivo \"fpdf.php\", que es donde va el código de la clase, en tu script php.\r\nEjemplo:\r\n<pre class=\"brush: php\">\r\n//Libreria con elementos globales como: funciones, constantes y la clase lite Tfw\r\ninclude(\"../php_boot/boot_main.php\");\r\n//IMPORT_VENDOR lo que hace es un include de la clase \"fpdf\" recuperandolo de la carpeta /proy_anytest/mix_vendors/Fpdf17\r\nTfw::IMPORT_VENDOR(\"Fpdf17\", \"fpdf\");\r\nTfw::IMPORT(FOL_PHP_CLASSES, \"CCliente\");\r\nTfw::IMPORT(FOL_PHP_CLASSES, \"CFactura\");\r\n\r\n//Heredo de la clase FPDF\r\n//Version: 1.7\r\nclass CPdf extends FPDF\r\n{\r\n    \r\n    /*@author: Eduardo Acevedo Farje.\r\n     *www.eduardoaf.com\r\n     */\r\n    //El código ascci del €\r\n    private $_AsciiEuro;\r\n    \r\n    //r: Ruta. La ruta de la imágen a insertar en el PDF\r\n    private $_rImagen;\r\n    private $_sEmpresaEmisora;\r\n    private $_sCif;\r\n    \r\n    private $_oCliente;\r\n    private $_oFactura;\r\n\r\n    \r\n    public function __construct(CCliente $oCliente, CFactura $oFactura, \r\n                                $sEmpresaEmisora=\"\", $sCif=\"\", $rImagen=\"../Images/LogoHoja.jpg\", \r\n                                $cOrientacion=\"P\", $sUnidDistancia=\"mm\", \r\n                                $sTamanoFolio=\"A4\") \r\n    {\r\n        parent::__construct($cOrientacion, $sUnidDistancia, $sTamanoFolio);\r\n        $this->_AsciiEuro = chr(128);\r\n                \r\n        $this->_sEmpresaEmisora = $sEmpresaEmisora;\r\n        $this->_sCif = $sCif;\r\n        $this->_rImagen = $rImagen;\r\n        \r\n        $this->_oCliente = $oCliente;\r\n        $this->_oFactura = $oFactura;\r\n    }\r\n    \r\n    //Cabecera de página, Titulo y Logo\r\n    private function set_config_header()\r\n    {\r\n        //Arial bold 15\r\n        $iTamanoFuente = 15;\r\n        $this->SetFont(\"Arial\",\"B\",$iTamanoFuente);\r\n\r\n        //Configuración del Logo de la empresa\r\n        //ruta a la imágen\r\n        $rImagen = $this->_rImagen;\r\n        $iMargenX = 137;\r\n        $iMargenY = 1;\r\n        $iAnchoImagen = 74;\r\n        $this->Image($rImagen, $iMargenX, $iMargenY, $iAnchoImagen);\r\n        //Movernos a la derecha, 1: dejamos una celda por la izquierda\r\n        $this->Cell(1);\r\n        \r\n        //Configuracion del títutlo de la cabecera:\r\n        $iAncho = 10;\r\n        $iAltura = 10;\r\n        //Los caracteres castellanos hay que pasarlos a ISO-8859-1 que es\r\n        //el juego con el que trabaja FPDF\r\n        $sTitulo = utf8_decode(\"Factura nº: \");\r\n        \r\n        //Sin borde\r\n        $iAnchoBorde = 0;\r\n        //Indico que no haga un salto de linea despues de pintar el título sino haría\r\n        //algo como: Factura nº: (salta una linea)\r\n        // 232 y quiero que sea:  Factura nº: 232 (en una sola linea)\r\n        $iSaltosLinea = 0;\r\n        //Alineado a la izquierda\r\n        $cAlineacion = \"L\";\r\n        $this->Cell($iAncho,$iAltura,$sTitulo,$iAnchoBorde,$iSaltosLinea,$cAlineacion);\r\n    }\r\n \r\n    //Muestra el Nº al lado de \"FACTURA nº:\"\r\n    private function set_numero_factura()\r\n    {\r\n        $oFactura = $this->_oFactura;\r\n        $iNumFactura = $oFactura->get_numero();\r\n        //Arial bold 15\r\n        $this->SetFont(\"Arial\",\"B\",15);\r\n        $this->Cell(20);\r\n        //Título\r\n        $this->Cell(10,10,$iNumFactura,0,0,\"L\");\r\n        //Salto de línea\r\n        $this->Ln(20);\r\n    }\r\n \r\n    private function set_datos_empresa_emisora()\r\n    {\r\n        $sNombreEmpresa = $this->_sEmpresaEmisora;\r\n        $sCif = $this->_sCif;\r\n        \r\n        $oFactura = $this->_oFactura;\r\n        $dFecha = $oFactura->get_fecha();\r\n        //Convierto 2010-01-01 a 1 de Enero de 2010\r\n        //$sFechaLarga = CUtils::fFechaLarga($dFecha);\r\n        \r\n        //Esto me ayudara a dejar un espacio fijo desde el margen izquierdo\r\n        //de modo que se vea tabulado algo como:\r\n        //          Fecha\r\n        //..115..   Empresa (emisora)\r\n        //          Cif (cif empresa emisora)\r\n        $iAnchoTabular = 115;\r\n\r\n        $this->SetFont(\"Arial\",\"B\",12);\r\n        $this->Cell($iAnchoTabular);\r\n        $this->Cell(1,7,\"FECHA:\",20,0,\"L\");\r\n        $this->Ln();\r\n        $this->SetFont(\"Arial\",\"\",12);\r\n        $this->Cell($iAnchoTabular);\r\n        $this->Cell(1,7,$dFecha,20,0,\"L\");\r\n        $this->Ln();\r\n        $this->Cell($iAnchoTabular);\r\n        $this->Cell(1,6,$sNombreEmpresa,20,0,\"L\");\r\n        $this->Ln();\r\n        $this->Cell($iAnchoTabular);\r\n        $this->Cell(1,6,$sCif,20,0,\"L\");\r\n        $this->Ln(20);\r\n    }\r\n \r\n    private function set_datos_cliente()\r\n    {\r\n        $oCliente = $this->_oCliente;\r\n        $sNombreEmpresa = $oCliente->get_empresa();\r\n        $sCif = $oCliente->get_cifnif();\r\n        $sDireccion = $oCliente->get_direccion();\r\n        $sCodigoPostal = $oCliente->get_codigo_postal();\r\n        $sCiudad = $oCliente->get_ciudad();\r\n        \r\n        $this->SetFont(\"Arial\",\"BU\",12);\r\n        $this->Cell(0,7,\"FACTURAR A:\",0,0,\"L\");\r\n        $this->Ln();\r\n        $this->SetFont(\"Arial\",\"B\",12);\r\n        $this->Cell(0,7,$sNombreEmpresa,0,0,\"L\");\r\n        $this->Ln();\r\n        $this->SetFont(\"Arial\",\"\",12);\r\n        $this->Cell(0,7,$sCif,0,0,\"L\");\r\n        $this->Ln();\r\n        $this->Cell(0,7,$sDireccion,0,0,\"L\");\r\n        $this->Ln();\r\n        $this->Cell(0,7,\"$sCodigoPostal - $sCiudad\",0,0,\"L\");\r\n        $this->Ln(20);\r\n    }\r\n \r\n    private function set_datos_detalle()\r\n    {\r\n        //Símbolo del euro\r\n        $cEuro = $this->_AsciiEuro;\r\n        $arDetalles = $this->_oFactura->get_detalle();\r\n        \r\n        $this->SetFont(\"Arial\",\"B\",12);\r\n        \r\n        //Esto formara la cabecera de la tabla de detalle algo como:\r\n        // |            Concepto            |   Cantidad    |\r\n        $arLabelsCabeceras = array(\"Concepto\",\"Cantidad\");\r\n        //Anchuras de las columnas, coindicen con la posición de las cabeceras\r\n        $arAnchoColumna = array(150,35);        \r\n\r\n        $iAltura = 7;\r\n        $iAnchoBorde = 1;\r\n        $iSaltosLinea = 0;\r\n        //Centrado\r\n        $cAlineacion = \"C\";\r\n        \r\n        //Dibujo las cabeceras\r\n        foreach($arLabelsCabeceras as $iIndice => $sTituloCabecera)\r\n        {\r\n            $iAnchoColumna = $arAnchoColumna[$iIndice];\r\n            $this->Cell($iAnchoColumna,$iAltura,$sTituloCabecera,$iAnchoBorde,$iSaltosLinea,$cAlineacion);\r\n        }\r\n        //Despues de dibujar la linea con las cabeceras se hace un salto\r\n        $this->Ln();\r\n\r\n        //Reconfiguro la fuente para que no sea en negrita\r\n        $this->SetFont(\"Arial\",\"\",12);\r\n        \r\n        $iAltura = 6;\r\n        //Dibujo el detalle de la factura $arDetalles es del tipo n x (\"CONCEPTO\"=>\"..\",\"CANTIDAD\"=>\"\")\r\n        foreach($arDetalles as $arDetalle)\r\n        {\r\n            //Columna concepto\r\n            $sConcepto = $arDetalle[\"CONCEPTO\"];\r\n            $iAnchoColumna = $arAnchoColumna[0];\r\n            $this->Cell($iAnchoColumna, $iAltura, $sConcepto,\"LR\");\r\n            //Columna cantidad\r\n            $iAnchoColumna = $arAnchoColumna[1];\r\n            $fCantidad = $arDetalle[\"CANTIDAD\"];\r\n            $sMonto = number_format($fCantidad,2,\",\",\"\");\r\n            $sMonto = \"$sMonto $cEuro\";\r\n            $this->Cell($iAnchoColumna, $iAltura, $sMonto,\"LR\",0,\"R\");\r\n            \r\n            $this->Ln();\r\n        }\r\n\r\n        //Línea de cierre\r\n        $iAnchoTotal = array_sum($arAnchoColumna);\r\n        $this->Cell($iAnchoTotal,0,\"\",\"T\");\r\n        $this->Ln();\r\n    }\r\n\r\n    //TODO se puede mejorar con un bucle\r\n    private function set_resumen_totales()\r\n    {\r\n        //Símbolo del euro\r\n        $cEuro = $this->_AsciiEuro;\r\n        $oFactura = $this->_oFactura;\r\n        \r\n        $this->SetFont(\"Arial\",\"B\",12);\r\n \r\n        $arLabels = array\r\n        (\r\n            \"subtotal\"=>\"Subtotal: \",\r\n            \"iva\"=>\"Iva: \",\r\n            \"total\"=>\"Total: \"\r\n        );\r\n \r\n        //Anchuras de las columnas\r\n        $arAnchoColumna = array(\"concepto\"=>150,\"cantidad\"=>35);\r\n        $iAltoCelda = 6;\r\n        foreach ($arLabels as $sIndice =>$sLabel)\r\n        {\r\n            switch ($sIndice) \r\n            {\r\n                case \"subtotal\":\r\n                    $sEuros = number_format($oFactura->get_subtotal(),2,\",\",\"\");\r\n                break;\r\n                case \"iva\":\r\n                    $sEuros = number_format($oFactura->get_iva(),2,\",\",\"\");\r\n                break;\r\n                case \"total\":\r\n                    $sEuros = number_format($oFactura->get_total(),2,\",\",\"\");\r\n                break;\r\n                default:\r\n                    $sEuros = \"0,00\";\r\n                break;\r\n            }\r\n            $sEuros = \"$sEuros $cEuro\";\r\n            //Label\r\n            $this->Cell($arAnchoColumna[\"concepto\"],$iAltoCelda, $sLabel, \"LR\",0,\"R\");\r\n            //Cantidad\r\n            $this->Cell($arAnchoColumna[\"cantidad\"],$iAltoCelda, $sEuros, \"LR\",0,\"R\");\r\n            $this->Ln();            \r\n        }\r\n        //Línea de cierre\r\n        $iAnchoTotal = array_sum($arAnchoColumna);\r\n        $this->Cell($iAnchoTotal,0,\"\",\"T\");\r\n    }\r\n    \r\n    //Pie de página\r\n    private function set_config_footer()\r\n    {\r\n        $iNumPagina = $this->PageNo();\r\n        //Posición: a 15mm (1,5) cm del final\r\n        $this->SetY(-31);\r\n        //Arial Bold italic 8\r\n        $this->SetFont(\"Arial\",\"B\",8);\r\n        //Número de página\r\n        $sTextoCelda = \"Página $iNumPagina/{nb}\";\r\n        $sTextoCelda = utf8_decode($sTextoCelda);\r\n        $cAlineacion = \"C\";\r\n        //Ver la configuracion de los parametros en la linea 49\r\n        $this->Cell(0,10, $sTextoCelda, 0,0, $cAlineacion);\r\n    }\r\n    \r\n    /**\r\n     * IMPORTANTE: Este metodo se encarga del rasterizado del contenido\r\n     * pasado a formato PDF.  \r\n     * No se puede llamar a este metodo despues de haber enviado cabeceras al\r\n     * navegador. No porque sea mi metodo, es que la clase FPDF tiene esa restricción\r\n     * El error provocado es este:\r\n     * FPDF error: Some data has already been output, can\'t send PDF file (output started at ...\r\n     */\r\n    public function generar_factura()\r\n    {\r\n        //Iniciamos el objeto Página sobre el que se dibujará el contenido del\r\n        //PDF\r\n        $this->AddPage();\r\n        //Activamos la opción para que muestre el número de páginas\r\n        $this->AliasNbPages();\r\n        \r\n        //LOS METODOS EXTENDIDOS:\r\n        //Posiciona el logotipo de la hoja, en este caso para emular un papel membretado\r\n        //el logo es una imagen .jpg de tamaño A4\r\n        $this->set_config_header();\r\n        //Asignamos el número de factura a: Factura nº:, creado en el paso anterior\r\n        $this->set_numero_factura();        \r\n        //Dibujamos la fecha de la factura y los datos de nuestra empresa\r\n        //Lleva un salto de linea de 10\r\n        $this->set_datos_empresa_emisora();\r\n        //Saltamos 10 lineas extra, un pequeño parche\r\n        $this->Ln(8);\r\n        //Dubujamos los datos del cliente: Nombre, Nif, Domicilio\r\n        //lleva un salto de línea de 20\r\n        $this->set_datos_cliente();\r\n        //Dibujamos el detalle desglosado de la factura: Concepto, Cantidad\r\n        $this->set_datos_detalle();\r\n        //Dibujamos el resumen de: subtotal, iva y total\r\n        $this->set_resumen_totales();\r\n        //Configuramos lo que mostrará en el pie de página: Página i/n\r\n        $this->set_config_footer();\r\n        //En este punto todo el documento está generado, con este metodo\r\n        //lo imprimimos en PDF\r\n        $this->Output();\r\n    }\r\n    \r\n    public function set_imagen($rImagen)\r\n    {\r\n        $this->_rImagen = $rImagen;\r\n    }\r\n \r\n}\r\n\r\n//La clase CCliente deberia ser un modelo, aqui estoy emulando el objeto.\r\n$oCliente = new CCliente(\"E.M.P. Cliente S.L\", \"12345678\", \"San Fermin 12\", \"28006\", \"Madrid\");\r\n$oFactura = new CFactura(\"1 de Enero de 2011\", 250.50, 225.25, 25.25, \"FAC0000123\");\r\n//$oPdf = new CPdf($oCliente, $oFactura, $arDetalles, $sEmpresaEmisora, $sCif, $cOrientacion, $sUnidDistancia, $sTamanoFolio)\r\n$oFacturaPdf = new CPdf($oCliente, $oFactura, \"M.I Empresa. S.A\", \"MI9876543\");\r\n//$rImagen = guarda algo como: protohtt://localhost/proy_anytest/html_images/LogoHoja.jpg\r\n$rImagen = TFW_PATH_HTTPWS.FOL_HTML_IMAGES.DS.\"LogoHoja.jpg\";\r\n$oFacturaPdf->set_imagen($rImagen);\r\n$oFacturaPdf->generar_factura();\r\n</pre>\r\nEl resultado:\r\n<a target=\"_blank\" href=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/fpdf_w584xh825.png\" rel=\"prettyPhoto\" >\r\n    <img width=\"113\" height=\"160\" border=\"0\" alt=\"\" src=\"http://www.eduardoaf.com/wp-content/uploads/img_articulos/fpdf_w113xh160.png\" style=\"border: 0pt none;\" />\r\n</a>','Hay muchas formas de trabajar con clases de terceros.  Muchas veces nos encontramos código útil y que se adata casi al cien por ciento de nuestras necesidades.  Esta vez vuelvo a hacer incapie en la utilización de la programación orientada a objetos y MVC para la extensión y utilización de la clase FPDF.','publish','como-usar-fpdf-para-la-creacion-de-pdfs-en-php'),(31,'2012-04-14 11:51:39','2012-04-27 20:11:32','POO, MVC y Helpers en php','Despues de una temporada sin aportar nada a esta, nuestra comunidad :) voy a dejar unas clases denominadas helpers.\r\nSi has trabajado con <strong>Cakephp</strong> sabes de lo que hablo así pues te puedes saltar su definición conceptual.\r\n\r\nAntes de esto una breve explicación de que son, como utilizarlos y donde.\r\n\r\nLos <strong>helpers</strong>, \"ayudantes\" son clases que nos permiten realizar una lógica extra en nuestras vistas (hablando en MVC).  Las vistas están concebidas para mostrar los datos recuperados desde el controlador u obtener datos ingresados por el usuario.  \r\n\r\nLos helpers son a las vistas lo que los componentes a los controladores.\r\n\r\nDicho esto el flujo de datos seria el siguiente:\r\n\r\n<h3>De la capa de datos (modelo) a la capa de presentación (vista):</h3>\r\nModelo->(datos)->Controlador->(procesa datos y define donde presentarlos)->Vista(imprime los datos) ó\r\n\r\n<h3>De la capa de presentación (vista) a la de datos:</h3>\r\nVista(formulario)->Conrolador->(metodo que procesara estos datos)->Modelo(realiza CRUD según el caso)\r\n\r\n<h3>Aplicando helpers se añadiría una capa extra entre controlador y vista:</h3>\r\nModelo->(datos)->Controlador->(procesa datos y define donde presentarlos)->Helper->Vista(imprime los datos) ó\r\n\r\nVeamos el ejemplo en código php y html:\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n//importamos nuestro modelo o modelos a utilizar\r\ninclude_once \"ModelUsuario\";\r\n//Definimos el controlador\r\nclass ControllerUsuarios extends MainController\r\n{\r\n	public function __construct(){}\r\n	\r\n	public function nuevo_registro()\r\n	{\r\n		if(empty($_POST[\"codigo\"]))\r\n		{\r\n			//Como vamos añadir un nuevo usuario nuestro objeto lo creamos vacio\r\n			//este el el constructor: ($codigo=\"\",$nombre=\"\",$login=\"\",$password=\"\")\r\n			$oUsuario = new ModelUsuario();\r\n			//asignamos algunos valores que se mostrarán al cargarse el formulario\r\n			$oUsuario-&gt;set_nombre(\"obligatorio\");\r\n		    //Pasamos el objeto a pintar en la vista. Como es un registro nuevo aplicaremos\r\n			//un valor por defecto a los campos\r\n			$this-&gt;view_params(\"oUsuario\",$oUsuario);\r\n			//este método indica en que vista se utilizará los datos pasados en params.\r\n			$this-&gt;view(\"usuarios/detalle.inc\");\r\n		}\r\n	}\r\n}\r\n//Se construye una instancia del controlador y se ejecuta el metodo indicado\r\n$sMethod = $_POST[\"controller_method\"];\r\n$oController = new ControllerUsuarios();\r\n$oController-&gt;{$sMethod};\r\n?&gt;\r\n</pre>\r\nEste seria el código de la vista, archivo detalle.inc.\r\n<pre class=\"brush: php\">\r\n&lt;!-- //VISTA: archivo \"detalle.inc\" aqui contamos con el objeto $oUsuario pasado en Params--&gt;\r\n&lt;form id=\"frmNuevoUsuario\" action=\"controller_usuarios.php\" method=\"post\"&gt;\r\n	&lt;label for=\"txtCodigo\"&gt;Código&lt;/label&gt;\r\n	&lt;input type=\"text\" name=\"codigo\" id=\"txtCodigo\" value=\"\" readonly &gt;\r\n	&lt;label for=\"txtNombre\"&gt;Nombre&lt;/label&gt;\r\n	&lt;input type=\"text\" name=\"nombre\" id=\"txtNombre\" value=\"&lt;?php echo $oUsuario-&gt;get_nombre(); ?&gt;\" required&gt;\r\n	&lt;label for=\"txtLogin\"&gt;Login&lt;/label&gt;\r\n	&lt;input type=\"text\" name=\"login\" id=\"txtLogin\" value=\"&lt;?php echo $oUsuario-&gt;get_login(); ?&gt;\" required&gt;\r\n	&lt;label for=\"passPassword\"&gt;Password&lt;/label&gt;\r\n	&lt;input type=\"password\" name=\"password\" id=\"passPassword\" value=\"&lt;?php echo $oUsuario-&gt;get_password(); ?&gt;\" required&gt;\r\n	&lt;input type=\"hidden\" name=\"controller_method\" id=\"hidMethod\" value=\"agregar\" &gt; \r\n&lt;/form&gt;\r\n</pre>\r\nImaginemos que desearamos aplicar el atributo readonly al login cuando este no este vacio. \r\ndeberiamos hacer algo como esto:\r\n<pre class=\"brush: php\">\r\n...\r\n&lt;input type=\"text\" name=\"login\" id=\"txtLogin\" value=\"&lt;?php echo $oUsuario-&gt;get_nombre(); ?&gt;\" \r\n&lt;?php if($oUsuario-&gt;get_login()!=\"\")echo \"readonly\"; ?&gt; required /&gt;\r\n...\r\n</pre>\r\nAqui interviene el helper. Nuestro ayudante en este caso se encargará de generar un control text, password y/o hidden.  \r\nEste contará con los atributos y metodos que permitan la creación del código html teniendo la flexibilidad que al  crearlos directamente sin php.\r\nUno de estos metodos será <strong>\"readonly()\"</strong>\r\n\r\nNuestra vista quedaria algo asi:\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n//Definimos los objetos que representan a nuestros controles\r\n//El segundo parámetro del constructor es la etiqueta. Crea el tag \"&lt;label for=\"controlid\"&gt;Parametro2&lt;label&gt;\r\n$oTxtCodigo = new HelperText(\"codigo\",\"Código\",$oUsuario-&gt;get_codigo());\r\n$oTxtCodigo-&gt;readonly();\r\n$oTxtNombre = new HelperNombre(\"nombre\",\"Nombre\",$oUsuario-&gt;get_nombre());\r\n$oTxtNombre-&gt;required();\r\n$oTxtLogin = new HelperText(\"login\",\"Login\",$oUsuario-&gt;get_login());\r\nif($oUsuario-&gt;get_login()!=\"\") $oTxtLogin-&gt;readonly();\r\n$oTxtLogin-&gt;required();\r\n$oPassPassword = new HelperPassword(\"password\",\"Password\",$oUsuario-&gt;get_password());\r\n$oPassPassword-&gt;required();\r\n$oHidMetodo = new HelperHidden(\"controller_method\",\"agregar\");\r\n?&gt;\r\n\r\n&lt;form id=\"frmNuevoUsuario\" action=\"controller_usuarios.php\" method=\"post\"&gt;\r\n&lt;?php\r\n//Ahora utilizamos el metodo show().  Este generará el código html de los controles\r\n$oTxtCodigo-&gt;show();\r\n$oTxtNombre-&gt;show();\r\n$oTxtLogin-&gt;show();\r\n$oPassPassword-&gt;show();\r\n$oHidMetodo-&gt;show();\r\n?&gt;\r\n&lt;/form&gt;\r\n</pre>\r\n\r\nEn conclusión, hemos utilizado clases tipo helper para generar la lógica extra, esta, es la creación de controles mediante código php, basada en programación orientada a objetos (POO) y aplicandolas a nuestra arquitectura modelo vista controlador (MVC) o en tres capas.\r\n\r\nEl paquete de helpers los iré subiendo uno a uno.\r\nEl primero: el helper Text <a href=\"\" target=\"_blank\">HelperText.php</a>\r\n\r\n<h4>Te puede interesar</h4>\r\n<ul>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-helper-mainhelper/\" target=\"_blank\"> PHP - La clase MainHelper</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-progrmacion/programacion-php/poo-helper-helpertext-input-text/\" target=\"_blank\">PHP - La clase HelperText</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-helper-helperselect-control-select/\" target=\"_blank\">PHP - La clase HelperSelect</a>\r\n</li>\r\n</ul>','Los helpers. ¿Qué son? ¿Cómo se utilizan?. En una arquitectura en tres capas (MVC) los ayudantes nos facilitan la generación de elementos que participan en una vista.  ','publish','poo-mvc-y-helpers-en-php'),(32,'2012-04-14 12:42:00','2012-04-27 20:15:55','POO, MVC Helper \"MainHelper\"','Antes de utilizar cualquier helper debes saber:\r\n<ul>\r\n<li>Las clases están pensadas para su utilización en la arquitectura en tres capas. Pero la puedes adaptar para incluirla en cualquier proyecto</li>\r\n<li>El código html que se generá se basa en un proyecto con HTML5 y jquery mobile</li>\r\n<li>No es la última versión puesto que día a dia voy mejorando el código o añadiendo mas funcionalidad</li>\r\n<li>Todos los helpers contarán con el metodo get_html(), el cual devuelve un sring.</li>\r\n<li>Todos los helpers contarán con el metodo show(), este hace un \"echo\" del metodo anterior</li>\r\n</ul>\r\nEsta es la clase principal.  Todas las demas la extenderán.\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/*\r\n@author: Eduardo Acevedo Farje\r\n@web: www.eduardoaf.com\r\n*/\r\nclass MainHelper\r\n{\r\n    /**\r\n     * @var string index.php\r\n     */\r\n    protected $_start_uri;\r\n    /**\r\n     * @var string index.php?\r\n     */\r\n    protected $_start_uri_for_params = \"\";\r\n    /**\r\n     * @var string index.php?module=\r\n     */\r\n    protected $_start_uri_with_param_module = \"\";\r\n    \r\n    //Para crear uri\r\n    protected $_code_module = \"\";\r\n    protected $_code_tab = \"\";\r\n    protected $_style = \"\";\r\n    \r\n    protected $_display = true;\r\n    protected $_arClasses = array();\r\n    protected $_class = \"\";\r\n    \r\n    //Esto emula el atributo bloqueado. Si esta a true crea el control autoseleccionado con un\r\n    //único valor en los objetos tipo select\r\n    protected $_isReadOnly = false;\r\n    protected $_isRequired = false;\r\n    protected $_isDisabled = false;\r\n    protected $_isKeyCode = false;\r\n    protected $_useFieldContain = false; //&lt;div data-role=\"fieldcontain\"&gt;   \r\n    \r\n    protected $_js_onchange = \"\";\r\n    protected $_js_onkeypress = \"\";\r\n    protected $_js_onblur = \"\";\r\n    \r\n    protected $oBD = null;\r\n    \r\n    public function __construct()\r\n    {\r\n        global $oDB;\r\n        $this-&gt;_start_uri = JQ_DOMAIN_URI_HTTPWS_INDEXPHP;\r\n        $this-&gt;_start_uri_for_params = $this-&gt;_start_uri.\"?\";\r\n        $this-&gt;_start_uri_with_param_module = $this-&gt;_start_uri_for_params.\"module=\";\r\n        $this-&gt;oBD = $oDB;\r\n    }\r\n    \r\n    public function create_html_label($sFor,$sText,$sExtras=\"\")\r\n    {\r\n        return \"&lt;label for=\\\"$sFor\\\" $sExtras &gt;$sText&lt;/label&gt;\\n\";\r\n    }\r\n    \r\n    protected function concat_param_value($sParamName,$sValue)\r\n    {\r\n        $sValue=urlencode($sValue);\r\n        return \"$sParamName=$sValue\";\r\n    }  \r\n    \r\n    protected function build_uri_params_with_keys($arKeysAndValues=array())\r\n    {\r\n        $arDestinyKeys = array();\r\n        $sDestinyKeys = \"\";\r\n        foreach($arKeysAndValues as $sFieldName=&gt;$sValue)\r\n        {\r\n            $arDestinyKeys[]=$this-&gt;concat_param_value($sFieldName, $sValue);;\r\n        }\r\n        if(!empty($arDestinyKeys))\r\n            $sDestinyKeys = implode(\"&\",$arDestinyKeys);\r\n        return $sDestinyKeys;\r\n    }\r\n    \r\n    /**\r\n     *\r\n     * @param string $sCodeModule\r\n     * @param string $sCodeTab\r\n     * @param array $arKeysAndValues\r\n     * @return string index.php?module=$codeModule&tab=$sCodeTab&key1=value1&..&keyN=valueN\r\n     */\r\n    protected function get_full_uri_to_nav($sCodeModule,$sCodeTab=\"\",$arKeysAndValues=array())\r\n    {\r\n        $sCodeModule = strtolower($sCodeModule);\r\n        $sCodeTab = strtolower($sCodeTab);\r\n        $sModuleParam = \"\"; $sTabParam = \"\";$sKeysParams = \"\"; \r\n        if(!empty($arKeysAndValues))\r\n            $sKeysParams = \"&\".$this-&gt;build_uri_params_with_keys($arKeysAndValues);\r\n        \r\n        if(!empty($sCodeTab))\r\n            $sTabParam = \"&\".$this-&gt;concat_param_value(\"tab\", $sCodeTab);\r\n        \r\n        return $this-&gt;_start_uri_with_param_module . \"$sCodeModule$sTabParam$sKeysParams\";\r\n    }\r\n    \r\n    protected function extract_fields_and_values($arFields, $arFieldNames)\r\n    {\r\n        $arExtracted = array();\r\n        foreach($arFields as $sFieldName=&gt;$sValue)\r\n        {\r\n            if(in_array($sFieldName, $arFieldNames))\r\n                $arExtracted[$sFieldName] = $sValue;\r\n        }\r\n        return $arExtracted;\r\n    }\r\n       \r\n    /**\r\n     * De un array tipo (\"fieldname\"=&gt;\"value\") recupera solo los \"value\" de los \"fieldname\"\r\n     * indicados en $arFieldNames\r\n     * @param array $arFields\r\n     * @param array $arFieldNames\r\n     * @param boolean $asArray\r\n     * @param string $sSeparator\r\n     * @return mixed Array or String depende de $asArray\r\n     */\r\n    protected function extract_values($arFields, $arFieldNames, $asArray=false, $sSeparator=\"-\")\r\n    {\r\n        $arExtracted = array(); $sExtracted=\"\";\r\n        foreach($arFields as $sFieldName=&gt;$sValue)\r\n        {\r\n            if(in_array($sFieldName, $arFieldNames))\r\n                $arExtracted[] = $sValue;\r\n        }\r\n        if(!empty($arExtracted) && !$asArray)\r\n            $sExtracted = join($sSeparator,$arExtracted);\r\n        else\r\n            $sExtracted = $arExtracted;\r\n        return $sExtracted;\r\n    }  \r\n    \r\n    //Pasar a main helper\r\n    protected function get_class_style_from_array()\r\n    {\r\n        if(!empty($this-&gt;_class)) $this-&gt;_class .=\" \";\r\n        if($this-&gt;_isRequired)\r\n        {   \r\n            $this-&gt;_class .= \"clsRequired\";\r\n        }\r\n        elseif($this-&gt;_isKeyCode)\r\n        {\r\n            $this-&gt;_class .= \"clsCode\";\r\n        }\r\n        //Solo si no renombro la clase con set_class se toma normal\r\n        //sino se omite y se aplica solamente la asignada desde el set\r\n        elseif(empty($this-&gt;_class))\r\n        {\r\n            $this-&gt;_class .= \"clsNormal\";\r\n        }\r\n\r\n        $this-&gt;_arClasses[] = $this-&gt;_class;\r\n        $sClass = join(\" \",$this-&gt;_arClasses);\r\n        //bug($sClass); \r\n        return \" class=\\\"$sClass\\\" \";\r\n    }    \r\n    \r\n    public function show()\r\n    {\r\n        if($this-&gt;_display)\r\n            echo $this-&gt;get_html();\r\n    }\r\n    \r\n    public function display($showIt=true)\r\n    {\r\n        $this-&gt;_display = $showIt;\r\n    }    \r\n\r\n    public function set_code_module($sValue)\r\n    {\r\n        $this-&gt;_code_module = $sValue;\r\n    }\r\n    \r\n    public function isDisabled()\r\n    {\r\n        return $this-&gt;_isDisabled;\r\n    }\r\n    \r\n    public function set_code_tab($sValue)\r\n    {\r\n        $this-&gt;_code_tab = $sValue;\r\n    }\r\n    \r\n    public function set_style($sStyle)\r\n    {\r\n        $this-&gt;_style = $sStyle;\r\n    }\r\n    \r\n    public function set_class($sValor)\r\n    {\r\n        $this-&gt;_class = $sValor;\r\n    }\r\n    \r\n    public function required($isRequired=true)\r\n    {\r\n        $this-&gt;_isRequired = $isRequired;\r\n    }\r\n    \r\n    public function readonly($isReadOnly=true)\r\n    {\r\n        $this-&gt;_isReadOnly = $isReadOnly;\r\n    }\r\n    \r\n    public function disabled($isDisabled=true)\r\n    {\r\n        $this-&gt;_isDisabled = $isDisabled;\r\n    }\r\n    \r\n    public function use_fieldcontain($useFieldContain=true)\r\n    {\r\n        $this-&gt;_useFieldContain = $useFieldContain;\r\n    }\r\n    \r\n    public function add_class($sClass)\r\n    {\r\n        $this-&gt;_arClasses[] = $sClass;\r\n    }\r\n    \r\n    public function get_code_tab()\r\n    {\r\n        return $this-&gt;_code_tab;\r\n    }\r\n    \r\n    public function get_code_module()\r\n    {\r\n        return $this-&gt;_code_module;\r\n    }\r\n    \r\n    public function set_js_onchange($sJs)\r\n    {\r\n        return $this-&gt;_js_onchange = $sJs;\r\n    }\r\n    \r\n    public function set_js_keypress($sJs)\r\n    {\r\n        return $this-&gt;_js_onkeypress = $sJs;\r\n    }\r\n\r\n    public function set_js_onblur($sJs)\r\n    {\r\n        $this-&gt;_js_onblur = $sJs;\r\n    }\r\n    \r\n    protected function get_icon_path($isIcon,$sIconFile)\r\n    {\r\n        $sIconPath = \"images/\";\r\n        $sIconPath .= $sIconFile;\r\n        if($isIcon && is_file($sIconPath))\r\n        {\r\n            return $sIconPath;\r\n        }    \r\n        return \"\";    \r\n    }    \r\n}\r\n</pre>\r\n<h4>Te puede interesar</h4>\r\n<ul>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-y-helpers-en-php/\" target=\"_blank\"> PHP - ¿Qué es un helper?</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-progrmacion/programacion-php/poo-helper-helpertext-input-text/\" target=\"_blank\">PHP - La clase HelperText</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-helper-helperselect-control-select/\" target=\"_blank\">PHP - La clase HelperSelect</a>\r\n</li>\r\n</ul>','Esta es la clase principal del conjunto de helpers. El resto de ayudantes deberan estenderla.','publish','poo-mvc-helper-mainhelper'),(33,'2012-04-14 13:10:05','2012-04-27 20:10:02','POO Helper \"HelperText\" - input-text','<h2>PHP Clase para crear y manipular un control text </h2>\r\nEl metodo <strong>get_html()</strong> devuelve el string html asociado al control input-text.\r\n<pre class=\"brush: php\">\r\n&lt;input type=\"text\" ... &gt;\r\n</pre>\r\n<h3>¿Cómo utilizarla?</h3>\r\n<pre class=\"brush: php\">\r\n&lt;?php \r\n//Por defecto el id y el nombre del campo se crea con el mismo valor. \r\n//si se desea otro nombre puedes usar el metodo set_name(\"valor_para_name\");\r\n$oTxtCampo = new HelperText(\"NombreCampo\",\"textoLabel\",\"string en value\");\r\n//Si se desea que se muestre en solo lectura\r\n$oTxtCampo->readonly();\r\n//Obligatorio \r\n$oTxtCampo->required();\r\n//añadiendo código javascript a un evento\r\n$oTxtCampo->js_onchange(\"alert(\'se ha ejecutado el evento onchange()\')\");\r\n//añadiendo clases de estilos\r\n$oTxtCampo->add_class(\"clsMiEstilo\");\r\n$oTxtCampo->add_class(\"clsMiEstilo2\"); \r\n//añadiendo estilos desde style\r\n$oTxtCampo->set_style(\"background:red;\");\r\n//si necesitas añadir atributos extras al elemento input\r\n$oTxtCampo->set_extras(\"someattrib=\\\"value\\\"\");\r\n\r\n//Un ejemplo del uso de atributo display. display por defecto está a true.\r\n//si se pasa a false no se mostrará con show().\r\nif($unValor==\"invalido\") $oTxtCampo->display(false);\r\n\r\n$oTxtCampo->show();\r\n?&gt;\r\nRESULTADO:\r\n&lt;label for=\"NombreCampo\"&gt;textoLabel&lt;/label&gt;\r\n&lt;input type=\"text\" name=\"NombreCampo\" id=\"NombreCampo\" value=\"string en value\" \r\nreadonly required onchange=\"alert(\'se ha ejecutado el evento onchange()\')\" \r\nclass=\"clsMiEstilo clsMiEstilo2\" style=\"background:red;\" someattrib=\"value\"&gt;\r\n\r\n</pre>\r\n<h3>Dependencia:</h3>\r\n<ul>\r\n	<li><a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-helper-mainhelper-inc/\" target=\"_blank\">MainHelper</a></li>\r\n</ul>\r\n<h3>La clase HelperText</h3>\r\n<pre class=\"brush: php\">\r\n/*\r\n@author: Eduardo Acevedo Farje\r\n@web: www.eduardoaf.com\r\n*/\r\n&lt;?php\r\nclass HelperText extends MainHelper\r\n{\r\n    private $_type = \"text\";\r\n    private $_value = \"\";\r\n    private $_name;\r\n    private $_maxlength; //Para text\r\n\r\n    private $_extras;\r\n    private $_extras_for_label;\r\n    \r\n    public function __construct\r\n    ($sControlId, $sValue=\"\", $label=\"\", $extras=\"\", $iMaxLength=\"50\", $class=\"\", $extrasForLabel=\"\")\r\n    {\r\n        $this-&gt;_control_id = $sControlId;\r\n		//Esta clase estatica ComponentText lo que hace es convertir \r\n		//caracteres conflictivos de texto plano a entidades html.\r\n        $this-&gt;_value = ComponentText::clean_for_html($sValue);\r\n        $this-&gt;_name = $sControlId;\r\n        $this-&gt;_label = $label;\r\n        $this-&gt;_maxlength = $iMaxLength;\r\n        $this-&gt;_extras = $extras;\r\n        $this-&gt;_class = $class;\r\n        $this-&gt;_extras_for_label = $extrasForLabel;\r\n    }\r\n    \r\n    public function get_html()\r\n    {  \r\n        $sHtmlInputText = \"\";\r\n        \r\n        $sDivFieldContain = \"&lt;div data-role=\\\"fieldcontain\\\"&gt;\\n\";\r\n        $sDivFieldContainEnd = \"&lt;/div&gt;\\n\";\r\n        \r\n        $sClass = $this-&gt;get_class_style_from_array();\r\n        $this-&gt;_extras_for_label .= $sClass;\r\n        if(!empty($this-&gt;_label))\r\n            $sHtmlInputText .= $this-&gt;create_html_label($this-&gt;_control_id,$this-&gt;_label,$this-&gt;_extras_for_label);\r\n\r\n        $sHtmlInputText .= \"&lt;input \";\r\n        $sHtmlInputText .= \"type=\\\"$this-&gt;_type\\\" \";\r\n        $sHtmlInputText .= \"id=\\\"$this-&gt;_control_id\\\" \";\r\n        $sHtmlInputText .= \"name=\\\"$this-&gt;_name\\\" \";\r\n        $sHtmlInputText .= \"value=\\\"$this-&gt;_value\\\" \";\r\n        if(!empty($this-&gt;_maxlength))$sHtmlInputText .= \"maxlength=\\\"$this-&gt;_maxlength\\\" \";\r\n        if($this-&gt;_isDisabled) $sHtmlInputText .= \"disabled \";\r\n        if($this-&gt;_isReadOnly) $sHtmlInputText .= \"readonly \"; \r\n        if($this-&gt;_isRequired) $sHtmlInputText .= \"required \"; \r\n        if($this-&gt;_js_onblur) $sHtmlInputText .= \"onblur=\\\"$this-&gt;_js_onblur\\\" \"; \r\n        \r\n        $sHtmlInputText .= $sClass;\r\n        if(!empty($this-&gt;_style)) $sHtmlInputText .= \"style=\\\"$this-&gt;_style\\\" \";\r\n        if(!empty($this-&gt;_extras)) $sHtmlInputText .= $this-&gt;_extras;\r\n        $sHtmlInputText .= \"&gt;\\n\";\r\n\r\n        if($this-&gt;_useFieldContain) $sHtmlInputText = $sDivFieldContain.$sHtmlInputText.$sDivFieldContainEnd;\r\n        return $sHtmlInputText;\r\n    }\r\n \r\n    public function set_type($sType)\r\n    {\r\n        $this-&gt;_type = $sType;\r\n    }\r\n    \r\n    public function set_control_id($sValor)\r\n    {\r\n        $this-&gt;_control_id = $sValor;\r\n    }\r\n\r\n    public function set_name($sValor)\r\n    {\r\n        $this-&gt;_name = $sValor;\r\n    }\r\n\r\n    public function set_extras($sValor)\r\n    {\r\n        $this-&gt;_extras = $sValor;\r\n    }\r\n\r\n    public function set_value($sValue)\r\n    {\r\n        $this-&gt;_value = ComponentText::clean_for_html($sValue);\r\n    }\r\n    \r\n    public function set_label($sValue)\r\n    {\r\n        $this-&gt;_label = $sValue;\r\n    }\r\n    \r\n    public function set_extras_for_label($sValue)\r\n    {\r\n        $this-&gt;_extras_for_label = $sValue;\r\n    }\r\n\r\n    public function set_maxlength($iNumChars)\r\n    {\r\n        $this-&gt;_maxlength = $iNumChars;\r\n    }\r\n    \r\n\r\n    public function set_keycode($isKeyCode=true)\r\n    {\r\n        $this-&gt;_isKeyCode = $isKeyCode;\r\n    }\r\n    \r\n    //=============== GET ======================  \r\n    public function get_control_id()\r\n    {\r\n        return $this-&gt;_control_id;\r\n    }\r\n\r\n    public function get_name()\r\n    {\r\n        return $this-&gt;_name;\r\n    }\r\n   \r\n    public function get_value()\r\n    {\r\n        return $this-&gt;_value;\r\n    }\r\n\r\n    public function get_class()\r\n    {\r\n        return $this-&gt;_class;\r\n    }\r\n\r\n    public function get_extras()\r\n    {\r\n        return $this-&gt;_extras;\r\n    }\r\n    \r\n    public function get_label()\r\n    {\r\n        return $this-&gt;_label;\r\n    }\r\n}\r\n</pre>\r\n\r\n<h4>Te puede interesar</h4>\r\n<ul>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-y-helpers-en-php/\" target=\"_blank\">PHP -¿Qué es un helper?</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-helper-mainhelper-inc/\" target=\"_blank\">PHP - La clase MainHelper</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-helper-helperselect-control-select/\" target=\"_blank\">PHP - La clase HelperSelect</a>\r\n</li>\r\n</ul>','Ayudante para generar elemento input text.','publish','poo-helper-helpertext-input-text'),(34,'2012-04-26 21:28:45','2012-04-27 18:33:05','PHP - Automatización de include, require, include_once y require_once','<h2>¿Cómo incluir archivos en nuestros proyectos sin necesidad de indicar toda la ruta hacia los mismos?</h2>\r\nPara los que empiezan con php y necesitan una aclaración extra sobre estas funciones y como tener disponibles nuestros archivos para ser incluidos en nuestro proyecto sin necesidad de escribir toda la ruta, sea esta, absoluta o relativa explico el concepto y como siempre lo refuerzo con ejemplos.  \r\n\r\nMás adelante te encontrarás funciones para tratar con directorios que pueden ser útiles por separado.\r\n\r\nSi ejecutamos la funcion <strong>phpinfo();</strong> se nos mostrará la configuración almacenada en nuestro <strong>\"php.ini\"</strong> en este listado si buscamos la directiva <strong>include_path</strong> veremos la ruta por defecto de donde apache intentará hacer las inclusiónes de los archivos que instanciemos mediante alguna de las siguientes funciones:\r\n<ul>\r\n<li>include</li>\r\n<li>require</li>\r\n<li>include_once</li>\r\n<li>require_once</li>\r\n</ul>\r\nen mi caso cuento con la siguiente ruta por defecto: <b>/Applications/MAMP/bin/php5.3/lib/php</b> esto quiere decir que si en algún archivo dentro de mi proyecto hago lo siguiente:\r\n<pre class=\"brush:php\">\r\ninclude(\"algun_archivo_a_incluir.php\");\r\ninclude_once(\"otro_archivo_a_incluir.inc\");\r\nrequire(\"un_archivo_mas.html\");\r\n</pre>\r\n\r\nApache automaticamente irá a buscarlos dentro del directorio <b>php</b> en la ruta anterior.  Si no existierán entonces lanzaria un error.\r\n\r\n<h3>Ejemplo aclaratorio:</h3>\r\nSupongamos que contamos con la siguiente estructura de archivos\r\n<pre class=\"brush:php\">\r\n/my_project\r\n    /classes\r\n        /models\r\n            model_user.inc\r\n        /views\r\n            /users\r\n                view_user_new.inc\r\n                view_user_detail.inc\r\n                view_list.inc\r\n            /clients\r\n                view_client_new.inc\r\n                view_client_detail.inc\r\n                view_list.inc\r\n        /controllers\r\n            controller_user.inc\r\n    /plugins\r\n    /vendors\r\n</pre>\r\n\r\nSi en nuestro controlador  <strong>controller_user.inc</strong> desearamos utilizar el modelo <strong>model_user.inc</strong> y la vista <strong>view_client_detail</strong> \r\n\r\ndeberíamos hacer lo siguiente:\r\n<pre class=\"brush:php\">\r\n&lt;?php \r\ninclude_once(\"../models/model_user.inc\");\r\ninclude_once(\"../views/users/view_user_detail.inc\");\r\n\r\n//Archivo controller_user.inc\r\nclass ControllerUser extends MainController\r\n{\r\n    public function __construct(){}\r\n    \r\n    public function detail()\r\n    {\r\n        //atributo en link del listado de usuarios que forma una url con formato\r\n        //controller=controller_user&method=detail&user_id=usr1234\r\n        $id_usuario = $_GET[\"user_id\"];\r\n        //Creo el usuario desde el Modelo\r\n        $oUsuario = new ModelUser($id_usuario);\r\n        //carga el usuario en el objeto Usuario. Ejecuta la \r\n        //sql \"SELECT * FROM tabla_usuario WHERE id=\'$id_usuario\';\r\n        $oUsuario->read();\r\n        //Despues de read() podriamos mostrar los datos del select directamente\r\n        //con los getters del objeto: $oUsuario->get_name(); $oUsuario->get_email()...\r\n        \r\n        //Creo la vista \r\n        $oUserDetail = new ViewUserDetail($oUsuario);\r\n        //Esto muestra todo el html \r\n        $oUserDetail->render();\r\n    }\r\n}\r\n//Creo el objeto controlador y ejecuto el metodo indicado, que a su vez creará\r\n//la vista detalle, un formulario con campos readonly, es lo que se indica en la url.\r\n$oControllerUser = new ControllerUser();\r\n$sMethodName = $_GET[\"method\"];\r\n$oControllerUser->$sMethodName();\r\n?>\r\n</pre>\r\n\r\nPodriamos mejorar la inclusión de los archivos sin necesidad de indicar la ruta relativa o absoluta a los mismos.  ¿Cómo? con la función <strong>set_include_path($path);</strong>\r\n\r\nPara el ejemplo anterior deberiamos hacer lo siguiente en las primeras lineas de ejecución de nuestro proyecto:\r\n<pre class=\"brush:php\">\r\n&lt;?php\r\n//recuperamos la ruta que tiene almacenada por defecto.\r\n$arPaths[] = get_include_path();\r\n//guardamos las rutas personalizadas.  Para este ejemplo solo utilizaré\r\n//los modelos controladores y vistas\r\n$arPaths[] = \"/Applications/MAMP/htdocs/my_project/classes/models\";\r\n$arPaths[] = \"/Applications/MAMP/htdocs/my_project/classes/views\";\r\n$arPaths[] = \"/Applications/MAMP/htdocs/my_project/classes/controllers\";\r\n\r\n$sMergedPaths = implode(PATH_SEPARATOR,$arPaths);\r\nset_include_path($sMergedPaths);\r\n//El nuevo included path será algo como esto:\r\n//.:/Applications/MAMP/bin/php5.3/lib/php:/Applications/MAMP/htdocs/my_project/classes/models:\r\n///Applications/MAMP/htdocs/my_project/classes/views:/Applications/MAMP/htdocs/my_project/classes/controllers\r\n?>\r\n</pre>\r\n\r\nAsí nuestro archivo controllador quedaría modificado a :\r\n<pre class=\"brush:php\">\r\n&lt;?php \r\ninclude_once(\"model_user.inc\");\r\ninclude_once(\"view_user_detail.inc\");\r\n\r\n//Archivo controller_user.inc\r\nclass ControllerUser extends MainController\r\n{\r\n...\r\n?>\r\n</pre>\r\n\r\n<h3>Para automatizar la carga de rutas he creado unas funciones que trabajan recorriendo un arbol de directorios</h3>\r\nEn otro post explicaré cómo hacer una clase con ellas.  Estas funciones son las siguientes.\r\n\r\n<h4>¿Qué hacen y Cómo?</h4>\r\nAyudan en la creación de rutas a partir de una carpeta (directorio) raíz, recorriendo\r\nrecursivamente sus subdirectorios.\r\n\r\nLos parámetros son los siguientes:\r\n<pre>\r\n<b>$sPathDir</b>&lt;string&gt; Ruta del directorio raiz. A partir de este se generarán \r\ntodas las rutas.\r\n<b>$arNotToCountOn</b>&lt;array&gt; Lista de carpetas ó directorios que no se tomarán \r\nen cuenta. Pe: las carpetas de subversion \".svn\"\r\n<b>$sDS</b>&lt;string&gt; Directory Separator. Permite que se pueda configurar el separa\r\ndor para windows. Por defecto esta para sistemas unix.\r\n</pre>\r\n\r\n\r\n<pre class=\"brush:php\">\r\n&lt;?php \r\n//NOTA: La función \"bug()\" comentada es un var_dump customizado.\r\nfunction get_folders($sPathDir,$arNotToCountOn=array(),$sDS=\"/\")\r\n{\r\n    $arFolders = array();\r\n    \r\n    if ($oDirHandler = opendir($sPathDir)) \r\n    {\r\n        while(($dirElement = readdir($oDirHandler))!==false) \r\n        {\r\n            $sTmPath = $sPathDir . $sDS . $dirElement;\r\n            //bug(\"dirElement=$dirElement\");bug($arNotToCountOn); \r\n            //bug(\"inarray=\".in_array($dirElement, $arNotToCountOn));\r\n            if(is_dir($sTmPath) && $dirElement!=\".\" && $dirElement!=\"..\" && !in_array($dirElement, $arNotToCountOn))\r\n            {\r\n                $arFolders[] = $dirElement;\r\n            }\r\n        }\r\n        closedir($oDirHandler);\r\n    }\r\n    //bug($arFolders); \r\n    return $arFolders;\r\n}\r\n\r\n\r\nfunction has_dir($sPathDir,$arNotToCountOn=array(),$sDS=\"/\")\r\n{\r\n    if($oDirHandler = opendir($sPathDir)) \r\n    {\r\n        while(($dirElement = readdir($oDirHandler))!==false) \r\n        {\r\n            $sTmPath = $sPathDir . $sDS . $dirElement; \r\n            //bug(is_dir($sTmPath),$sTmPath); \r\n            //bug($arNotToCountOn);\r\n            if(is_dir($sTmPath) && $dirElement!=\".\" && $dirElement!=\"..\" && !in_array($dirElement, $arNotToCountOn))\r\n            {\r\n                closedir($oDirHandler);\r\n                return true;\r\n            }\r\n        }\r\n        closedir($oDirHandler);\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction dir_tree($sPathDir,$arNotToCountOn=array(),$sDS=\"/\")\r\n{\r\n    $arTree = array();\r\n    if(is_dir($sPathDir))\r\n    {\r\n        $arTree[] = $sPathDir;\r\n        //bug($sPathDir,\"is dir\");\r\n        //bug($arNotToCountOn);\r\n        if(has_dir($sPathDir,$arNotToCountOn,$sDS))\r\n        {\r\n            //bug($sPathDir,\"has folders\");\r\n            $arSubDir = get_folders($sPathDir,$arNotToCountOn,$sDS);\r\n            //bug($arSubDir,\"subdir\");\r\n            foreach($arSubDir as $sFolderName)\r\n            {\r\n                $sPath = $sPathDir .$sDS. $sFolderName;\r\n                //$arTree[] = dir_tree($sPath);\r\n                foreach(dir_tree($sPath,$arNotToCountOn,$sDS) as $sPaths)\r\n                {\r\n                    $arTree[] = $sPaths;\r\n                }\r\n            }\r\n        }\r\n        \r\n    }\r\n    return $arTree; \r\n}\r\n\r\n//FUNCION PARA AUTOCARGA DE LA RUTA DE INCLUSIÓN:\r\nfunction load_recursive_include_path($sPathDir, $arNotToCountOn=array(), $sDS=\"/\")\r\n{\r\n    //bug($arNotToCountOn);die;\r\n    $arDirPaths = dir_tree($sPathDir,$arNotToCountOn, $sDS);\r\n    $sDirPaths = implode(PATH_SEPARATOR,$arDirPaths);\r\n    if(!empty($sDirPaths))\r\n    {\r\n        $sDirPaths = get_include_path().PATH_SEPARATOR.$sDirPaths;\r\n        set_include_path($sDirPaths);\r\n    }\r\n}\r\n\r\n?>\r\n</pre>\r\n\r\n<h4>Su utilización:</h4>\r\nAprovecho para poner un ejemplo de un prototipo de un archivo bootstrap para\r\nun framewor MVC.\r\n<pre class=\"brush:php\">\r\n&lt;?php \r\n//Archivo index.php. \r\n//================================\r\n//      CARGA DE RUTAS\r\n//================================\r\n//Defino la ruta absoluta de mi proyecto\r\n$sProjectDir = \"/Applications/MAMP/htdocs/my_project\";\r\n//Aplico set_include_path de forma recursiva saltando todas las carpetas de\r\n//subversion.\r\nload_recursive_include_path($sProjectDir,array(\".svn\"));\r\n//================================\r\n// DEFINE CONTROLADOR DESDE URL\r\n//================================\r\n$arPathToController=array(\"usuarios\"=>array(\"controller_user.inc\",\"ControllerUser\")\r\n,...);\r\n$sControllerName = $_GET[\"controller\"];\r\n$sMethod = $_GET[\"method\"];\r\n$sControllerFile = $arPathToController[$sControllerName][0];\r\n$sControllerClass = $arPathToController[$sControllerName][1];\r\ninclude_once($sControllerFile);\r\n$oControllerName = new $sControllerClass();\r\n$oControllerName->$sMethod();\r\n?>\r\n</pre>\r\n\r\nAntes de terminar quisiera comentar sobre esta forma de autocarga en el <strong>set_include_path()</strong>, como todo esto tiene sus ventajas y desventajas.\r\n\r\nSi nos fijamos en parte de la estructura, concretamente en las vistas de listado de <b>\"users\"</b> y <b>\"clients\"</b>, ambas tienen el mismo nombre <b>view_list.inc</b>. \r\n<pre class=\"brush:php\">\r\n...\r\n    /views\r\n        /users\r\n            view_user_new.inc\r\n            view_user_detail.inc\r\n            view_list.inc\r\n        /clients\r\n            view_client_new.inc\r\n            view_client_detail.inc\r\n            view_list.inc\r\n...\r\n</pre>\r\n\r\nSi en nuestro controlador hacemos <strong>include_once(\"view_list.inc\");</strong> primero se buscaria la existencia en la carpeta <b>\"clients\"</b> al ser encontrado el archivo <b>view_list.inc</b> se incluiria y <b><i>no</i></b> se buscaría ningún otro para ser añadido. \r\nAl no ser este el <b>.inc</b> que necesitamos ya que deseamos mostrar el listado de usuarios, es decir, el <b>view_list.inc</b> de la carpeta <b>\"users\"</b> no obtendriamos el comportamiento deseado.\r\n\r\nPor lo tanto, a mi parecer es una pequeña desventaja y esta radica en que deberiamos o bién no tomar en cuenta estas carpetas (users, clients) en <strong>$arNotToCountOn</strong> y usar el <strong>include_once(\"users/view_list.inc\");</strong> ó renombrar los archivos.\r\n\r\nEspero que la entrada les sirva de ayuda.  \r\nUn saludo a tod@s!\r\n','Por lo general cuando necesitamos un código extra y disponemos de este en varios archivos solemos utilizar las funciones require, include, require_once e include_once.  A estas hay que pasarle una ruta ya sea absoluta o relativa.  En este post explico cómo evitar esto, de modo que se pueda incluir un archivo esté donde esté utilizando su nombre mediante la utilización de set_include_path. ','publish','php-automatizacion-de-include-require-include_once-y-require_once'),(35,'2012-04-27 19:59:12','2012-04-27 20:08:27','POO Helper “HelperSelect” – control \"select\"','<h2>PHP Clase para crear y manipular un control select</h2>\r\nEl metodo <strong>get_html()</strong> devuelve el string html asociado al control html <strong>select</strong>.\r\n<pre class=\"brush: php\">\r\n&lt;select ... &gt;\r\n    &lt;option ...&gt;texto&lt;/option ...&gt;\r\n    ...\r\n&lt;/select ... &gt;\r\n</pre>\r\n<h3>¿Cómo utilizarla?</h3>\r\n<pre class=\"brush: php\">\r\n&lt;?php \r\n//Por defecto el id y el nombre del campo se crea con el mismo valor. \r\n//si se desea otro nombre puedes usar el metodo set_name(\"valor_para_name\");\r\n//Opciones para crear una lista de clientes\r\n$arOpciones = array(\"\"=>\"\",\"cl01\"=>\"El Chalán - Aruba\",\"cl02\"=>\"Todaytours.es\",\"cl03\"=>\"Fibex\");\r\n$oSelCampo = new HelperSelect($arOpciones,\"selClientes\",\"Clientes\");\r\n//Deseamos autoseleccionar un valor del array anterior. Pe \"El Chalán\"\r\n$oSelCampo->set_value_to_select(\"cl01\");\r\n//Si se desea que se muestre en solo lectura\r\n$oSelCampo->readonly();\r\n//Obligatorio \r\n$oSelCampo->required();\r\n//añadiendo código javascript a un evento\r\n$oSelCampo->js_onchange(\"alert(\'select onchange() ejecutado\')\");\r\n//añadiendo clases de estilos\r\n$oSelCampo->add_class(\"clsMiEstilo\");\r\n$oSelCampo->add_class(\"clsMiEstilo2\"); \r\n//añadiendo estilos desde style\r\n$oSelCampo->set_style(\"background:red;\");\r\n//si necesitas añadir atributos extras al elemento select\r\n$oSelCampo->set_extras(\"someattrib=\\\"value\\\"\");\r\n\r\n//Un ejemplo del uso de atributo display. display por defecto está a true.\r\n//si se pasa a false no se mostrará con show().\r\nif($unValor==\"invalido\") $oSelCampo->display(false);\r\n\r\n$oSelCampo->show();\r\n?&gt;\r\nRESULTADO:\r\n&lt;label for=\"selCliente\"&gt;Clientes&lt;/label&gt;\r\n&lt;select id=\"selClientes\" name=\"selClientes\" onchange=\"alert(\'se ha ejecutado el evento onchange()\')\" \r\nclass=\"clsMiEstilo clsMiEstilo2\" style=\"background:red;\" someattrib=\"value\"&gt;\r\n    &lt;option value=\"cl01\" selected &gt;El Chalán - Aruba&lt;/option&gt;\r\n&lt;/select&gt;\r\n</pre>\r\nUna aclaración.  Si bien le hemos pasado un array con <b>\"tres\"</b> opciones y solo se visualiza una, esto es así porque se ha aplicado el metodo <strong>readonly()</strong>\r\n\r\nEste comportamiento intenta emular el la porpiedad <strong>readonly</strong> que tienen los controles input.\r\n\r\nPara el control <strong>select</strong> no existe tal propiedad.  Hay una parecida, esta es: <strong>disabled</strong>.\r\nEl problema con <strong>disabled</strong> es que este atributo hace que no se tome en cuenta el campo cuando se hace un submit del formulario.  Si hacemos un <strong>var_dump($_POST)</strong> podremos ver que no existe el nodo <b>$_POST[\"selClientes\"]=\"cl01\"</b> por lo tanto habria que aplicar el método <strong>set_selected_value_as_hidden_on()</strong> este generaria un campo hidden con el mismo nombre permitiendo asi la existenciade \"selClientes\" en el array POST.\r\n\r\n<h3>Dependencia:</h3>\r\n<ul>\r\n    <li><a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-helper-mainhelper-inc/\" target=\"_blank\">MainHelper</a></li>\r\n</ul>\r\n<h3>La clase HelperSelect</h3>\r\n<pre class=\"brush: php\">\r\n/*\r\n@author: Eduardo Acevedo Farje\r\n@web: www.eduardoaf.com\r\n*/\r\n&lt;?php\r\nclass HelperSelect extends MainHelper\r\n{\r\n    private $_arOptions;\r\n    private $_mx_value_to_select = \"\";\r\n    private $_selected_as_hidden =\"\";\r\n    \r\n    private $_name;\r\n    private $_isMultiple;\r\n    private $_size;\r\n    \r\n    private $_extras;\r\n    private $_extras_for_label;\r\n    private $_null_option = \"\";\r\n\r\n    public function __construct\r\n    ($arOptions, $sControlId, $label=\"\",$mxValueToSelect =\"\", $isMultiple=false,\r\n    $size=\"1\", $extras=\"\", $class=\"\", $extrasForLabel=\"\", $isReadOnly=false)\r\n    {\r\n        //$this->add_blank_item($arOptions, \"\", \"\");\r\n        $this->_arOptions = $arOptions;\r\n        //array or string\r\n        $this->_mx_value_to_select = $mxValueToSelect;\r\n        \r\n        $this->_control_id = $sControlId;\r\n        $this->_isMultiple = $isMultiple;\r\n        $this->_name = $sControlId;\r\n        $this->_size = $size;\r\n        $this->_label = $label;\r\n        $this->_extras = $extras;\r\n        $this->_class = $class;\r\n        $this->_extras_for_label = $extrasForLabel;\r\n        $this->_isReadOnly = $isReadOnly;\r\n    }\r\n\r\n    //<label for=\"detm_Empresa\">Empresa</label> \r\n    \r\n    public function get_html()\r\n    {  \r\n        $sHtmlSelect = \"\";\r\n        \r\n        $sDivFieldContain = \"<div data-role=\\\"fieldcontain\\\">\\n\";\r\n        $sDivFieldContainEnd = \"</div>\\n\";        \r\n        \r\n        $sClass = $this->get_class_style_from_array();\r\n        if(!$this->_classNotForLabel) $this->_extras_for_label .= $sClass;        \r\n        if(!empty($this->_label))\r\n            $sHtmlSelect .= $this->create_html_label($this->_control_id,$this->_label,$this->_extras_for_label);\r\n       \r\n        $sHtmlSelect .= \"<select \";\r\n        $sHtmlSelect .= \"id=\\\"$this->_control_id\\\" \";\r\n        \r\n        if($this->_isMultiple) $sHtmlSelect .= \"name=\\\"$this->_name[]\\\" \";\r\n        else $sHtmlSelect .= \"name=\\\"$this->_name\\\" \";\r\n        \r\n        $sHtmlSelect .= \"size=\\\"$this->_size\\\" \";\r\n        if($this->_isMultiple) $sHtmlSelect .= \"multiple \";\r\n        if($this->_isDisabled) $sHtmlSelect .= \"disabled \";\r\n        //if($this->_isReadOnly) $sHtmlSelect .= \"readonly \"; no existe esta propiedad para select\r\n        if($this->_isRequired) $sHtmlSelect .= \"required \"; \r\n        if(!empty($this->_js_onchange)) $sHtmlSelect .= \"onchange=\\\"$this->_js_onchange\\\" \";\r\n        if(!empty($this->_extras)) $sHtmlSelect .= $this->_extras ;\r\n        $sHtmlSelect .= \" $sClass>\\n\";\r\n        \r\n        if(!is_array($this->_mx_value_to_select)) $mxValueToSelect = (string)$this->_mx_value_to_select;\r\n        else $mxValueToSelect = $this->_mx_value_to_select;\r\n        \r\n        //No es readonly\r\n        if(!$this->_isReadOnly)        \r\n        {\r\n            if(!$this->_isMultiple)\r\n            {    \r\n                foreach($this->_arOptions as $valor=>$texto)\r\n                {\r\n                    $sOptionValue = (string)$valor;\r\n                    $isSelected = ($mxValueToSelect==$sOptionValue);\r\n                    $sHtmlSelect .= $this->generar_option($valor, $texto, $isSelected);\r\n                }\r\n            }\r\n            //Multiple\r\n            else\r\n            {\r\n                //if($this->_name==\"sch_Meses\") bug(\"is multiple\"); bug(is_array($this->_mx_value_to_select),\"is array\");\r\n                //mxValue puede ser array o no\r\n                foreach($this->_arOptions as $valor=>$texto)\r\n                {\r\n                    if(is_array($mxValueToSelect))\r\n                        $isSelected = in_array($valor, $mxValueToSelect);\r\n                        //if($this->_name==\"sch_Meses\") bug($texto,\"texto en options\")\r\n                    else\r\n                        $isSelected = ($mxValueToSelect==((string)$valor));\r\n                    $sHtmlSelect .= $this->generar_option($valor, $texto, $isSelected);\r\n                }\r\n            }\r\n        }\r\n        //ReadOnly=true\r\n        else\r\n        {\r\n            if(!$this->_isMultiple)\r\n            {\r\n                \r\n                //Hay dos opciones y una es vacia.\r\n                if(count($this->_arOptions)<=2 && key_exists(\"\", $this->_arOptions))\r\n                {\r\n                    unset($this->_arOptions[\"\"]);\r\n                    $arItemReadonly = $this->_arOptions;\r\n                }   \r\n                else\r\n                {    \r\n                    //recupera el valor de autoselección\r\n                    $arItemReadonly = $this->get_item_readonly($this->_arOptions, $mxValueToSelect);\r\n                }\r\n                foreach($arItemReadonly as $sValue => $sText)\r\n                    $sHtmlSelect .= $this->generar_option($sValue, $sText, true);\r\n            }\r\n            //es multiple\r\n            else\r\n            {\r\n                //bug(\"is multiple\"); bug(is_array($this->_isMultiple),\"is multiple\");\r\n                //Falta implementar\r\n            }\r\n        }\r\n       \r\n        $sHtmlSelect .= \"</select>\\n\";\r\n        $sHtmlSelect .= $this->_selected_as_hidden;\r\n        if($this->_useFieldContain) $sHtmlSelect = $sDivFieldContain.$sHtmlSelect.$sDivFieldContainEnd;\r\n        return $sHtmlSelect;\r\n    }\r\n   \r\n    private function get_item_readonly($arOptions,$sValueToSelect)\r\n    {\r\n        $arItemReadOnly = array(\"\"=>\"\");\r\n        foreach($arOptions as $sValue=>$sText)\r\n        {\r\n            if($sValueToSelect == (string)$sValue)\r\n            {    \r\n                $arItemReadOnly = array($sValue=>$sText);\r\n                return $arItemReadOnly;\r\n            }\r\n        }\r\n        return $arItemReadOnly;\r\n    }\r\n    \r\n    private function generar_option($sValor,$sTexto,$isSelected=false)\r\n    {\r\n        $sOption = \"\";\r\n        $sOption .= \"\\t<option \";\r\n        $sOption .= \"value=\\\"$sValor\\\" \";\r\n        if($isSelected) $sOption .= \"selected \";\r\n        $sOption .= \">\";\r\n        $sOption .= $sTexto;                  \r\n        $sOption .= \"</option>\\n\";\r\n       \r\n        return $sOption;\r\n    }\r\n\r\n    public function set_control_id($sValor)\r\n    {\r\n        $this->_control_id = $sValor;\r\n    }\r\n\r\n    public function set_name($sValor)\r\n    {\r\n        $this->_name = $sValor;\r\n    }\r\n\r\n    public function set_extras($sValor)\r\n    {\r\n        $this->_extras = $sValor;\r\n    }\r\n\r\n    public function set_value_to_select($sValue)\r\n    {\r\n        $this->_mx_value_to_select = $sValue;\r\n    }\r\n    \r\n    public function set_label($sValue)\r\n    {\r\n        $this->_label = $sValue;\r\n    }\r\n    \r\n    public function set_extras_for_label($sValue)\r\n    {\r\n        $this->_extras_for_label = $sValue;\r\n    }\r\n    \r\n    public function set_null_option_text($sValue)\r\n    {\r\n        $this->_null_option = $sValue;\r\n    }\r\n    /**\r\n     * Usar en caso de aplicar el atributo disabled: set_extras(\"disabled\");\r\n     */\r\n    public function set_selected_value_as_hidden_on()\r\n    {\r\n        $sName = $this->_control_id;\r\n        $sValue = $this->_mx_value_to_select;\r\n        $this->_selected_as_hidden = \"<input type=\\\"hidden\\\" name=\\\"$sName\\\" id=\\\"$sName\\\" value=\\\"$sValue\\\" />\\n\";\r\n    }\r\n    \r\n    //=============== GET ======================  \r\n    public function get_control_id()\r\n    {\r\n        return $this->_control_id;\r\n    }\r\n\r\n    public function get_name()\r\n    {\r\n        return $this->_name;\r\n    }\r\n   \r\n    public function get_value()\r\n    {\r\n        return $this->_value;\r\n    }\r\n\r\n    public function get_class()\r\n    {\r\n        return $this->_class;\r\n    }\r\n\r\n    public function get_extras()\r\n    {\r\n        return $this->_extras;\r\n    }\r\n    \r\n    public function get_selected_value()\r\n    {\r\n        return $this->_mx_value_to_select;\r\n    }\r\n    \r\n    public function get_label()\r\n    {\r\n        return $this->_label;\r\n    }\r\n}\r\n</pre>\r\n\r\n<h4>Te puede interesar</h4>\r\n<ul>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-y-helpers-en-php/\" target=\"_blank\">PHP -¿Qué es un helper?</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-mvc-helper-mainhelper-inc/\" target=\"_blank\">PHP - La clase MainHelper</a>\r\n</li>\r\n<li>\r\n<a href=\"http://www.eduardoaf.com/blog-programacion/programacion-php/poo-helper-helpertext-input-text/\" target=\"_blank\">PHP - La clase HelperText</a>\r\n</li>\r\n</ul>','Este helper ayuda en la creación de un elemento ó control html tipo select.','publish','poo-helper-helperselect-control-select'),(36,'2012-05-04 16:19:02','2012-06-10 17:47:35','PHP Conectar con SQL Server utilizando clase singleton CBaseDatos','Clase que conecta con sqlserver y mysql.  En esta versión singleton he ampliado algunas funcionalidades, como por ejemplo la posibilidad de conectarse a sqlserver y permitir utilizar los metodos <strong>query($sSQL)</strong> y <strong>execute($sSQL)</strong> sin que exista la necesidad de instanciar previamente el método <strong>conectar()</strong>.\r\n\r\nUna leve mejora en la captura de excepciones.  Ahora no se imprimirá todo el objeto \"e\", solamente el mensaje asociado.\r\n\r\nEl constructor espera argumentos con valores si estos están vacios entonces intentará recuperar el contenido de las constantes.\r\n\r\n<p>\r\n    <span style=\"color: #ff9900;\">\r\n        <strong>Descarga la clase CBaseDatos <a target=\"_blank\" href=\"http://downloads.eduardoaf.com/classes/php/php_component_database_v1.2.3.txt\" title=\"Clase CBaseDatos en php\">aqui</a>.\r\n        </strong>\r\n    </span>\r\n</p>\r\n\r\n<strong>CBaseDatos</strong> ahora cuenta ahora con:\r\n<ul>\r\n    <li>el método <strong>get_rows_affected()</strong></li>\r\n    <p>Mostrará la cantidad de registros que han intervenido en la consulta.</p>\r\n    <li>el método <strong>is_error()</strong></li>\r\n    <p>Indica si ha ocurrido un error tanto al leer como al escribir.</p>\r\n    <li>El método \"get\", <strong>get_link_id()</strong></li>\r\n    <p>Queda obsoleto, de momento está como privado antes era necesario utilizarlo\r\n    ya que por un lado se creaba un objeto conexión y por otro el componente\r\n    para atacar la base de datos.\r\n    </p>\r\n    <li>el método <strong>convert_to_utf8($arRow=array(), $origCollation=\"windows-1252\")</strong></li>\r\n    <p>Es necesario si se va a trabajar con SQLSERVER y el html se presentará en UTF-8.\r\n    ya que por defecto la codificación con la que trabaja es \"windows-1252\", \r\n    vamos la de los sistemas windows</p>\r\n    <li>el método <stron>convert_to_windows()</stron></li>\r\n    <p>El inverso del método anterior. Si deseamos guardar datos desde una página html en utf8\r\n        habrá que pasarlos a formato windows.\r\n    </p>\r\n</ul>\r\n\r\n\r\n<h3>Definición clase CBaseDatos</h3>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n/**\r\n* @author Eduardo Acevedo Farje\r\n* @version 1.2.0\r\n* @web http://www.eduardoaf.com/blog-programacion/programacion-php/php-conectar-con-sql-server-utilizando-clase-singleton-cbasedatos/\r\n* Clase tipo SINGLETON para interactuar con bases de datos sqlserver y mysql\r\n*/\r\nclass CBaseDatos \r\n{\r\n    private $_sServidor;\r\n    private $_sNombreBD;\r\n    private $_sUsuario;\r\n    private $_sClave;\r\n    private $_sTipoBD;\r\n   \r\n    private $_oLinkId;\r\n    private $_sMensaje;\r\n    private $_isError;\r\n    private $_iRowsAffected;\r\n   \r\n    /**\r\n    * @var CBaseDatos\r\n    */\r\n    private static $_oSelf = null;\r\n   \r\n    private function __construct($sServidorBD=\"\",$sNombreBD=\"\",$sUserBD=\"\",$sClaveBD=\"\",$sTipoBD=\"\")\r\n    {\r\n        $this->_sServidor = $sServidorBD;\r\n        $this->_sNombreBD = $sNombreBD;\r\n        $this->_sUsuario = $sUserBD;\r\n        $this->_sClave = $sClaveBD;\r\n        $this->_sTipoBD = $sTipoBD;\r\n        //Se sobreescribe los vacios\r\n        if(empty($sServidorBD))$this->_sServidor = TFW_DB_SERVER;\r\n        if(empty($sNombreBD))$this->_sNombreBD = TFW_DB_NAME;\r\n        if(empty($sUserBD))$this->_sUsuario = TFW_DB_USER;\r\n        if(empty($sClaveBD))$this->_sClave = TFW_DB_PASSWORD;\r\n        if(empty($sTipoBD))$this->_sTipoBD = TFW_DB_TYPE;\r\n        \r\n        //object con Id de Conexión\r\n        $this->_oLinkId = null; \r\n        $this->_sMensaje = \"\";\r\n        $this->_isError = false;\r\n    }\r\n   \r\n    /**\r\n    * Este es el pseudo constructor singleton\r\n    * Comprueba si la variable privada $_oSelf tiene un objeto\r\n    * de esta misma clase, sino lo tiene lo crea y lo guarda en dicha variable\r\n    * @return CBaseDatos\r\n    */\r\n    public static function get_instancia($sServidorBD=\"\",$sNombreBD=\"\",$sUserBD=\"\",$sClaveBD=\"\",$sTipo=\"mysql\")\r\n    {\r\n        if(!self::$_oSelf instanceof self)\r\n        {\r\n            self::$_oSelf = new self($sServidorBD,$sNombreBD,$sUserBD,$sClaveBD,$sTipo);\r\n        }\r\n        return self::$_oSelf;\r\n    }\r\n\r\n    //=================== CONECTAR ===========================\r\n    private function conectar_mysql()\r\n    {\r\n        $sNombreBD = $this->_sNombreBD;\r\n        if($this->_oLinkId==0 || $this->_oLinkId==null)\r\n        {\r\n            $oConnect = mysql_connect\r\n            (\r\n                $this->_sServidor,\r\n                $this->_sUsuario,\r\n                $this->_sClave\r\n            );\r\n            if(!is_resource($oConnect))\r\n            {\r\n                $this->_sMensaje = \"ERROR 0001: No se pudo conectar con la base de datos \\\"$sNombreBD\\\"\";\r\n                $this->_isError = true;\r\n                return false;\r\n            }\r\n           \r\n            $isExisteBD = mysql_select_db($this->_sNombreBD, $oConnect);\r\n            //si no se pudo encontrar esa BD lanza un error\r\n            if(!$isExisteBD)\r\n            {\r\n                $this->_sMensaje = \"ERROR 0002: La base de datos \\\"$sNombreBD\\\" \";\r\n                $this->_isError = true;\r\n                return false;\r\n            }\r\n            //Hay base de datos y se conecto\r\n            else\r\n            {\r\n                //Guardo el id de conexión\r\n                $this->_oLinkId = $oConnect;\r\n                $this->_sMensaje = \"Conexión realizada con la bd: \\\"$sNombreBD\\\"\";  \r\n                mysql_set_charset(\'utf8\',$this->_oLinkId);\r\n            }\r\n        }\r\n        //Ya existe recurso abierto, oLinkId!=0\r\n        else\r\n        {}\r\n        return true;\r\n    }\r\n   \r\n    private function conectar_sqlserver()\r\n    {\r\n        $sNombreBD = $this->_sNombreBD;\r\n        if($this->_oLinkId==0 || $this->_oLinkId==null)\r\n        {\r\n            $oConnect = mssql_connect\r\n            (\r\n                $this->_sServidor,\r\n                $this->_sUsuario,\r\n                $this->_sClave\r\n            );\r\n            \r\n            if(!is_resource($oConnect))\r\n            {\r\n                $this->_sMensaje = \"ERROR 0003: No se puede conectar a la base de datos..! \".$this->_sNombreBD;\r\n                $this->_isError = true;\r\n                return false;\r\n            }\r\n           \r\n            $isExisteBD  = mssql_select_db($this->_sNombreBD, $oConnect);\r\n            if(!$isExisteBD)\r\n            {\r\n                $this->_sMensaje = \"ERROR 0004: La base de datos \\\"$sNombreBD\\\" \";\r\n                $this->_isError = true;\r\n                return false;\r\n            }\r\n            //Hay base de datos y se conectó\r\n            else\r\n            {\r\n                $this->_oLinkId = $oConnect;\r\n                $this->_sMensaje = \"Conexión realizada con la bd: \\\"$sNombreBD\\\"\";  \r\n            }\r\n        }\r\n        //Existe recurso abierto\r\n        else\r\n        {}\r\n        return true;\r\n    }\r\n   \r\n    public function conectar()\r\n    {\r\n        $sTipoBD = $this->_sTipoBD;\r\n        $isConnected = false;\r\n        switch ($sTipoBD)\r\n        {\r\n            case \"mysql\":\r\n                $isConnected = $this->conectar_mysql();\r\n            break;\r\n            case \"sqlserver\":\r\n                $isConnected = $this->conectar_sqlserver();\r\n            default:\r\n            break;\r\n        }\r\n        return $isConnected;\r\n    }\r\n    //=================== FIN CONECTAR ===========================\r\n    \r\n    //Metodos para utilización de codificación utf8. Sobre todo para entornos windows\r\n    //como SQLServer 2008\r\n    private function convert_to_utf8($arRow=array(), $origCollation=\"windows-1252\")\r\n    {\r\n        $arRowInUtf8 = array();\r\n        foreach ($arRow as $sFieldName => $sValue)\r\n        {\r\n            $arRowInUtf8[$sFieldName] = iconv($origCollation, \"utf-8\", trim($sValue));\r\n        }\r\n        return $arRowInUtf8;\r\n    }    \r\n    \r\n    private function convert_to_windows($arRow=array(), $origCollation=\"utf-8\")\r\n    {\r\n        $arRowInWindows = array();\r\n        foreach ($arRow as $sFieldName => $sValue)\r\n        {\r\n            $arRowInWindows[$sFieldName] = iconv($origCollation, \"windows-1252\", $sValue);\r\n        }\r\n        return $arRowInWindows;\r\n    }        \r\n   \r\n    //==================== QUERY==================================\r\n    private function query_mysql($sSQL, $sNombreTabla=\"table\")\r\n    {\r\n        //Cuando se recupera un objeto desde sesion no cuenta\r\n        //con linkid (linkid = 0)\r\n        if(empty($this->_oLinkId)) $this->conectar();\r\n        \r\n        try\r\n        {\r\n            $arTabla = array();\r\n            $arFilas = array();\r\n\r\n            $oResource = mysql_query($sSQL, $this->_oLinkId);\r\n            if($oResource!=false)\r\n            {  \r\n                while($arFila = mysql_fetch_array($oResource, MYSQL_ASSOC))\r\n                {\r\n                    $arFilas[] = $arFila;\r\n                }\r\n                if(!empty($sNombreTabla))\r\n                {\r\n                    $arTabla[$sNombreTabla] = $arFilas;\r\n                }\r\n                else\r\n                {\r\n                    $arTabla = $arFilas;\r\n                }\r\n            }\r\n            else\r\n            {\r\n                $this->_isError = true;\r\n                $this->_sMensaje = \"ERROR EN SQL: $sSQL\";\r\n                return -1;\r\n            }\r\n            return $arTabla;\r\n        }\r\n        catch (Exception $e)\r\n        {\r\n            $this->_isError = true;\r\n            $this->_sMensaje = \"ERROR 0005 SQL: $sSQL,\\n\".$e->getMessage();\r\n            return -1;\r\n        }\r\n    }\r\n    \r\n    private function query_mssql($sSQL, $sNombreTabla=\"table\")\r\n    {\r\n        //Cuando se recupera un objeto desde sesion no cuenta\r\n        //con linkid (linkid = 0)\r\n        if(empty($this->_oLinkId)) $this->conectar();\r\n\r\n        $arTabla = array();\r\n        $arFilas = array();\r\n       \r\n        try\r\n        {\r\n            $oResource = mssql_query($sSQL, $this->_oLinkId);\r\n            //oResource existen filas afectadas, true consulta ok pero sin filas\r\n            //false error al ejecutar consulta\r\n            //$oResource=true ó $oResource\r\n            if($oResource!=false)\r\n            {\r\n                while($arFila = mssql_fetch_array($oResource, MSSQL_ASSOC))\r\n                {\r\n                    $arFilas[] = $this->convert_to_utf8($arFila);\r\n                }\r\n                if(!empty($sNombreTabla)) $arTabla[$sNombreTabla] = $arFilas;\r\n                else $arTabla = $arFilas;\r\n                \r\n                $this->_iRowsAffected = mssql_num_rows($oResource);\r\n                mssql_free_result($oResource);\r\n            }\r\n            //$oResource == false //TODO habría que estudiar en que casos se dá\r\n            //esta condición y en que otros se lanza la excepción\r\n            else\r\n            {\r\n                $this->_isError = true;\r\n                $this->_sMensaje = \"ERROR EN SQL: $sSQL\";\r\n                return -1;\r\n            }            \r\n            return $arTabla;\r\n        }\r\n        catch (Exception $e)\r\n        {\r\n            $this->_isError = true;\r\n            $this->_sMensaje = \"ERROR 0006 SQL: $sSQL,\\n\".$e->getMessage();\r\n            return -1;\r\n        }\r\n    }\r\n    \r\n    public function query($sSQL, $sNombreTabla=\"\")\r\n    {\r\n        $sTipoBD = $this->_sTipoBD;\r\n        $arTabla = array();\r\n        switch ($sTipoBD)\r\n        {\r\n            case \"mysql\":\r\n                $arTabla = $this->query_mysql($sSQL,$sNombreTabla);\r\n            break;\r\n            case \"sqlserver\":\r\n                $arTabla = $this->query_mssql($sSQL,$sNombreTabla);\r\n            default:\r\n            break;\r\n        }\r\n        return $arTabla;\r\n    }\r\n    //==================== FIN QUERY ================================\r\n   \r\n    //==================== QUERY OBJECT ================================\r\n    private function query_object_mysql($sSQL)\r\n    {\r\n        try\r\n        {\r\n            $arTabla = array();\r\n            //TODO comprobar lo que devuelve _query\r\n            $oResource = mysql_query($sSQL, $this->_oLinkId);\r\n            while($arFila = mysql_fetch_object($oResource))\r\n            {\r\n                $arTabla[] = $arFila;\r\n            }\r\n            return $arTabla;\r\n        }\r\n        catch (Exception $e)\r\n        {\r\n            $this->_isError = true;\r\n            $this->_sMensaje = \"ERROR 0011 SQL: $sSQL,\\n\".$e->getMessage();\r\n            return -1;\r\n        }\r\n    }\r\n    \r\n    private function query_object_mssql($sSQL)\r\n    {\r\n        try\r\n        {\r\n            $arTabla = array();\r\n            //TODO comprobar lo que devuelve _query\r\n            $oResource = mssql_query($sSQL, $this->_oLinkId);\r\n            \r\n            while($arFila = mssql_fetch_object($oResource))\r\n            {\r\n                $arTabla[] = $arFila;\r\n            }\r\n            $this->_iRowsAffected = mssql_num_rows($oResource);\r\n            mssql_free_result($oResource);            \r\n            return $arTabla;\r\n        }\r\n        catch (Exception $e)\r\n        {\r\n            $this->_isError = true;\r\n            $this->_sMensaje = \"ERROR 0012 SQL: $sSQL,\\n\".$e->getMessage();\r\n            return -1;\r\n        }\r\n    }\r\n    \r\n    public function query_object($sSQL)\r\n    {\r\n        $sTipoBD = $this->_sTipoBD;\r\n        $arTabla = array();\r\n        switch ($sTipoBD)\r\n        {\r\n            case \"mysql\":\r\n                $arTabla = $this->query_object_mysql($sSQL);\r\n            break;\r\n            case \"sqlserver\":\r\n                $arTabla = $this->query_object_mssql($sSQL);\r\n            default:\r\n            break;\r\n        }\r\n        return $arTabla;    \r\n    }    \r\n    //==================== FIN QUERY OBJECT ================================\r\n\r\n    //==================== EXECUTE ================================\r\n    private function execute_mysql($sSQL)\r\n    {\r\n        //Cuando se recupera un objeto desde sesion no cuenta\r\n        //con linkid (linkid = 0)\r\n        $oLinkId = $this->_oLinkId;\r\n        if(empty($oLinkId))\r\n            $this->conectar();\r\n\r\n        try\r\n        {\r\n            $oResource = mysql_query($sSQL);\r\n            if(!$oResource)\r\n            {\r\n                $sMensaje  = \"Sentencia SQL con errores: \".mysql_error();\r\n                $sMensaje .= \"\\nSQL = $sSQL\";\r\n                $this->_isError = true;\r\n                $this->_sMensaje = $sMensaje;\r\n                return -1;\r\n            }\r\n        }\r\n        catch(Exception $e)\r\n        {\r\n            $sMensaje  = \"Excepción: \".$e->getMessage();\r\n            $sMensaje .= \"\\nSQL = $sSQL\";\r\n            $this->_isError = true;\r\n            $this->_sMensaje = $sMensaje;\r\n            return -1;\r\n        }\r\n        \r\n        $this->_iRowsAffected = mysql_affected_rows($oResource);\r\n        mysql_free_result($oResource);        \r\n        $this->_isError = false;\r\n        $this->_sMensaje = \"executed: $sSQL\";\r\n        return true;\r\n    }\r\n   \r\n    private function execute_mssql($sSQL)\r\n    {\r\n        //Cuando se recupera un objeto desde sesion no cuenta\r\n        //con linkid (linkid = 0)\r\n        $oLinkId = $this->_oLinkId;\r\n        if(empty($oLinkId))\r\n            $this->conectar();\r\n\r\n        try\r\n        {\r\n            $sSQL = iconv(\"utf-8\", \"windows-1252\", $sSQL);\r\n            $oResource = mssql_query($sSQL);\r\n            //if $oResource = false \r\n            if(!$oResource)\r\n            {\r\n                $sMensaje  = \"Sentencia SQL con errores: \".mssql_error().\"\\n\";\r\n                $sMensaje .= \"\\nSQL = $sSQL\";\r\n                $this->_isError = true;\r\n                $this->_sMensaje = $sMensaje;\r\n                return -1;\r\n            }\r\n        }\r\n        catch(Exception $e)\r\n        {\r\n            $sMensaje  = \"Excepción: \".$e->getMessage().\"\\n\";\r\n            $sMensaje .= \"\\nSQL = $sSQL\";\r\n            $this->_isError = true;\r\n            $this->_sMensaje = $sMensaje;\r\n            return -1;\r\n        }\r\n        \r\n        $this->_iRowsAffected = mssql_affected_rows($oResource);\r\n        mssql_free_result($oResource);        \r\n        $this->_isError = false;\r\n        $this->_sMensaje = \"executed: $sSQL\";\r\n        return true;\r\n    }  \r\n\r\n    public function execute($sSQL)\r\n    {\r\n        $sTipoBD = $this->_sTipoBD;\r\n        switch ($sTipoBD)\r\n        {\r\n            case \"mysql\":\r\n                return $this->execute_mysql($sSQL);\r\n            break;\r\n            case \"sqlserver\":\r\n                return $this->execute_mssql($sSQL);\r\n            break;\r\n            default:\r\n            break;\r\n        }\r\n        return null;\r\n    }\r\n    //==================== FIN EXECUTE ================================\r\n    \r\n    //================== GET ==================================\r\n    private function get_servidor()\r\n    {\r\n        return $this->_sServidor;\r\n    }\r\n\r\n    public function get_usuario()\r\n    {\r\n        return $this->_sUsuario;\r\n    }\r\n\r\n    private function get_clave()\r\n    {\r\n        return $this->_sClave;\r\n    }\r\n\r\n    public function get_mensaje()\r\n    {\r\n        return $this->_sMensaje;\r\n    }\r\n   \r\n    public function get_nombre_bd()\r\n    {\r\n        return $this->_sNombreBD;\r\n    }\r\n\r\n    private function get_link_id()\r\n    {\r\n        return $this->_oLinkId;\r\n    }        \r\n   \r\n    public function get_tipo_bd()\r\n    {\r\n        return $this->_sTipoBD;\r\n    }\r\n    \r\n    public function is_error()\r\n    {\r\n        return $this->_isError;\r\n    }\r\n    \r\n    public function get_rows_afected()\r\n    {\r\n        return $this->_iRowsAffected;\r\n    }\r\n}\r\n?&gt;\r\n</pre>\r\n\r\n<h3>Utilización de CBaseDatos mejorada</h3>\r\n<pre class=\"brush:php\">\r\n&lt;?php\r\n//Archivo de configuración. \r\n//\"config_it.inc\"\r\n//La ip o el nombre dns.\r\ndefine(\"TFW_DB_SERVER\",\"192.168.15.45\");\r\n//El nombre de la base de datos\r\ndefine(\"TFW_DB_NAME\",\"mssql_elchalan\");\r\ndefine(\"TFW_DB_USER\",\"a_user\");\r\ndefine(\"TFW_DB_PASSWORD\",\"his_password\");\r\n//Es una base de datos que corre bajo SQLSERVER2008 R2\r\ndefine(\"TFW_DB_TYPE\",\"sqlserver\");\r\n...\r\n?&gt;\r\n\r\n&lt;?php\r\n//Al no pasar argumentos a get_instancia automaticamente se recuperan\r\n//desde las constantes.\r\n//Creamos el objeto de tipo CBaseDatos\r\n$oBD = CBaseDatos::get_instancia();\r\n//Conectamos y obtenemos el resultado\r\n$isConnected = $oBD->conectar();\r\n//La función bug() es un var_dump customizado\r\n//bug($isConnected);\r\n//bug($oBD);\r\n//En este punto podriamos enviar un mensaje y terminar el script si no se ha podido\r\n//conectar con la Base de datos.\r\n\r\n//Creamos nuestra SQL\r\n$sSQL = \"SELECT * FROM blog_usuario\";\r\n//Utilizamos query para lectura\r\n$arTabla = $oBD->query($sSQL);\r\nbug($arTabla);\r\n$sSQL = \"INSERT INTO blog_usuario (id_creador)\r\n         VALUES (2)\";\r\n//Utilizamos execute para escritura.\r\n$oBD->execute($sSQL);\r\n$sSQL = \"DELETE FROM blog_usuario WHERE id_creador=2\";\r\n$oBD->execute($sSQL);\r\nbug($oBD->get_mensaje());\r\n?&gt;\r\n</pre>\r\n<h3>Utilización de CBaseDatos en MVC</h3>\r\n<pre class=\"brush: php\">\r\n&lt;?php\r\n//La clase CBaseDatos\r\ninclude_once(\"component_base_datos.php\");\r\nclass ModelUsuario\r\n{\r\n    private $_oDB = null;\r\n    ...\r\n\r\n    public function __construct() \r\n    {\r\n        ...\r\n        $this->_oDB = CBaseDatos::get_instancia();\r\n        ...\r\n    }\r\n    \r\n    public function get_listado()\r\n    {\r\n        $sSQL = \"SELECT * FROM blog_users\";\r\n        return $this->_oDB->query($sSQL);\r\n    }\r\n    ...\r\n}\r\n...\r\n//Archivo: view_listado.php\r\nclass ViewListado\r\n{\r\n    private $_arTabla = array();\r\n\r\n    public function __construct() \r\n    { }\r\n    \r\n    //Pintar pagina html con el listado\r\n    public function show()\r\n    {\r\n        ...\r\n        foreach($this->arTabla ...)\r\n        {\r\n            ...\r\n        }\r\n        ...\r\n    }\r\n    \r\n    public function set_params($arArray)\r\n    {\r\n        $this->_arTabla = $arArray;\r\n    }\r\n}\r\n...\r\ninclude_once(\"model_usuario.php\");\r\ninclude_once(\"view_listado.php\");\r\nclass ControllerUsuarios\r\n{\r\n    public function __construct() \r\n    { }\r\n    \r\n    public function listar()\r\n    {\r\n        $oUsuario = new ModelUsuario();\r\n        $arUsuarios = $oUsuario->get_listado();\r\n        $oViewListado = new ViewListado();\r\n        $oViewListado->set_params($arUsuarios);\r\n    }\r\n    ...\r\n}\r\n?&gt;\r\n</pre>','Clase CBaseDatos mejorada.  Permite la interacción con Microsoft SQL Server y Mysql.','publish','php-conectar-con-sql-server-utilizando-clase-singleton-cbasedatos'),(37,'2012-06-09 17:56:51','2012-06-10 17:35:44','php Clase para trabajar con google maps','Permite interactuar desde php con la api de googlemaps. Recupera coordenadas desde una dirección. Dibuja marcadores (chinchetas), les añade comentarios y contenido.\r\n\r\n<h3>¿Cómo se utiliza?</h3>\r\n<h4>Ejemplo: Obtener latitud y longitud desde una dirección</h4>\r\n<pre class=\"brush: php\">\r\n&lt;html&gt;\r\n    &lt;head&gt;\r\n    &lt;title&gt;Goglemaps API 3 Clase PHP&lt;/title&gt;\r\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"&gt;\r\n    &lt;meta charset=\"UTF-8\"&gt;\r\n    &lt;script type=\"text/javascript\" src=\"html_js/js_google/js_google_maps_3.js\"&gt;&lt;/script&gt;\r\n    &lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;?php\r\ninclude_once(\"google_maps_3.php\");\r\n//Obtener latitud y longitud con los datos de una dirección.\r\n//El array debe llevar\r\n$arDireccion[] = array\r\n(\r\n    //\"pais\" => \"España\", //opcional\r\n    \"direccion\" => \"La granja 8\",\r\n    \"zona\" => \"alcobendas\",\r\n    \"cp\" => \"\"\r\n);\r\n\r\n$arDireccion[] = array\r\n(\r\n    \"pais\" => \"España\", //opcional\r\n    \"direccion\" => \"Conde de Peñalver 51\",\r\n    \"zona\" => \"madrid\",\r\n    \"cp\" => \"28006\"\r\n);\r\n//creamos el objeto\r\n$oGoogleMap = new GoogleMaps3();\r\n//lo configuramos para que no esté acotado.  Es decir que si encuentra la\r\n//dirección 0 fuera de España. p.e Latinoamérica, que obtenga los datos.\r\n$oGoogleMap->dont_narrow();\r\n\r\n//La función bug es un var_dump() customizado. Sirve para mostrar trazas.\r\nbug($oGoogleMap->get_latlong_from_address($arDireccion[0]),$arDireccion[0][\"direccion\"]);\r\nbug($oGoogleMap->get_latlong_from_address($arDireccion[1]),$arDireccion[1][\"direccion\"]);\r\n//Esta traza mostraria lo siguiente:\r\n\r\n//VARIABLE La granja 8:\r\n//array(2){[\"latitude\"]=>float(40.5475437)[\"longitude\"]=>float(-3.6420912)}\r\n\r\n//VARIABLE Conde de Peñalver 51:\r\n//array(2){[\"latitude\"]=>float(40.4363505) [\"longitude\"]=>float(-3.685144)}   \r\n?&gt;      \r\n&lt;div id=\"map_canvas\"&gt;&lt;/div&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;    \r\n</pre>\r\n\r\n<h4>Ejemplo: Posicionar marcadores (chinchetas, globos) en googlemap</h4>\r\n<pre class=\"brush: php\">\r\n&lt;html&gt;\r\n    &lt;head&gt;\r\n    &lt;title&gt;Goglemaps API 3 Clase PHP&lt;/title&gt;\r\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\"&gt;\r\n    &lt;meta charset=\"UTF-8\"&gt;\r\n    &lt;script type=\"text/javascript\" src=\"html_js/js_google/js_google_maps_3.js\"&gt;&lt;/script&gt;\r\n    &lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;?php\r\ninclude_once(\"google_maps_3.php\");\r\n//Los marcadores identifican a los globitos o chinchetas en el mapa.\r\n//El formato de los indices del array a pasar en el constructor debe ser el siguiente:\r\n//title : es equivalente al \"tooltiptext\" que aparece cuando se pasa el puntero \r\n//por encima.\r\n//content: el valor que se mostrará en el popup informativo. Se puede incluir html, \r\n//controles y eventos.\r\n//latitude, longitude: coordenadas de tipo real\r\n//PENDIENTE: Un indice \"address\" para poder crear un marcador directamente desde\r\n//este dato. De momento no lo hace.\r\n//El orden de los arrays anidados influira en el número que se asigna al marcador.\r\n$arMarcadores[]=array(\r\n    \"title\"=>\"uno \",\"content\"=>\"&lt;b&gt;Content 1&lt;/b&gt;&lt;input type=\\\"text\\\" value=\\\"marcador uno\\\"&gt;\",\r\n    \"latitude\"=>\"40.5475437\",\"longitude\"=>\"-3.6420912\"\r\n    );\r\n$arMarcadores[]=array(\r\n    \"title\"=>\"dos \",\"content\"=>\"&lt;b&gt;Content 2&lt;/b&gt;\",\r\n    \"latitude\"=&gt;\"40.4363505\",\"longitude\"=>\"-3.685144\"\r\n    );\r\n$arMarcadores[]=array(\r\n    \"title\"=>\"tres \",\"content\"=>\"&lt;b&gt;Content 3&lt;/b&gt;\",\r\n    \"latitude\"=>\"41.4166909\",\"longitude\"=>\"-3.7003454\"\r\n    );\r\n$oGoogleMap = new GoogleMaps3($arMarcadores);\r\n//Configuramos el zoom\r\n$oGoogleMap->set_zoom(7);\r\n//Dibujamos las lineas entre los marcadores (pines)\r\n$oGoogleMap->draw_lines();\r\n//Tamaño del mapa\r\n$oGoogleMap->set_size_container(800,600);\r\n//Unidad del tamaño del mapa. Solo acepta pt y px. He probado con % y no va.\r\n$oGoogleMap->set_size_unit(\'pt\');\r\n//No se mostrarán numeros en los pines de googlemaps\r\n$oGoogleMap->set_markers_numbers_off();\r\n//Calcula la distancia entre las chinchetas\r\n$fDistancia = $oGoogleMap->sum_distance();\r\n//bug($fDistancia);  muestra 11.1\r\n//Ejecuta la creación del mapa en el div \"map_canvas\"\r\n$oGoogleMap->draw_map();\r\n?&gt;      \r\n&lt;div id=\"map_canvas\"&gt;&lt;/div&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;    \r\n</pre>\r\n<h3>¿Qúé se necesita?</h3>\r\nEn principio solo dos archivos:\r\n<ul>\r\n    <li><a href=\"http://downloads.eduardoaf.com/classes/js/js_google_maps_3_v1.0.4.txt\" target=\"_blank\">js_google_maps_3.js</a></li>\r\n    <p>La clase javascript que actua directamente sobre el api de googlemaps</p>\r\n    <li><a href=\"http://downloads.eduardoaf.com/classes/php/php_google_maps_3_v1.0.7.txt\" target=\"_blank\">google_maps_3.php</a></li>\r\n    <p>La clase que hace de puente entre nuestro objeto php y el objeto javascript</p>\r\n</ul>\r\nDigo en principio porque <strong>\"GoogleMaps3\"</strong> ya incluye jquery directamente desde google.\r\nEsto lo puedes desactivar con el metodo <strong>no_google_jquery()</strong> de modo que continues usando la versión jquery que tengas en tu proyecto.\r\n\r\nCuando tenga un poco mas de tiempo pondre la demo en ejecución.\r\nBueno, espero que les sea de utilidad y cualquier duda, bug (seguro que los hay) que me lo comenten.\r\n\r\nUn saludo y les dejo los archivos tanto en los links anteriores como en pantalla.\r\n\r\n<h4>Clase php GoogleMaps3</h4>\r\n<pre class=\"brush: php\">\r\n\r\n/**\r\n * @author Eduardo Acevedo Farje.\r\n * @link www.eduardoaf.com\r\n * @version 1.0.7\r\n * @name Component GoogleMaps3  \r\n * @uses js_google_map_3.js, jquery v1.7+\r\n */\r\n\r\nclass GoogleMaps3\r\n{\r\n    private $_sApikey = \"\";\r\n    //Indica si se cargara automaticamente el tag \"&lt;script&gt;\" con la url \r\n    //de googlemaps. Si se ha definido una apikey se incluye\r\n    private $_isAutoApikey = true;\r\n    //Indica si se va a incluir la libreria jquery desde google. \r\n    //Si dispones de una copia local se puede desactivar.\r\n    private $_useGoogleJquery = true;\r\n    \r\n    //FOR JS\r\n    //Estos son parametros de configuración para el archivo: js_google_map_3.js\r\n    private $_arMarkers = \"[]\"; //Las chinchetas\r\n    private $_useMakersNumbers = true; //Si las chinchetas mostrarán números.\r\n    private $_sMapType = \"\'roadmap\'\"; //El tipo de mapa. \r\n    //Elemento div donde se mostrará el mapa generado.\r\n    private $_sIdDivContainer = \"\'map_canvas\'\";\r\n    //El zoom\r\n    private $_iZoom = 6;\r\n    //Punto inicial de muestreo. Cuando se crea el mapa debe mostrar algún punto\r\n    //he escogido las coord. de la Puerta del Sol (Madrid)\r\n    private $_fLatitude = 40.41694; \r\n    private $_fLongitude = -3.70361;\r\n    //Indica si ha de pintarse lineas entre las chinchetas (Markers).\r\n    private $_drawLines = false;\r\n    //Configuración del tamaño del mapa y su unidad. \r\n    private $_iWidth = 800;\r\n    private $_iHeight = 600;\r\n    private $_sUnitWH = \"px\";\r\n    \r\n    //FOR PHP\r\n    //Parametros para hacer peticiones de latitud y longitud de una dirección\r\n    //Url para enviar peticiones por get. Devolvera un objeto xml\r\n    private $_sUrlAskAddress = \"http://maps.googleapis.com/maps/api/geocode/xml\";\r\n    //Indica si se ha de acotar la busqueda de una dirección.\r\n    //Evita que te encuentre una dirección equivalente en otro país.\r\n    private $_doNarrowSearch = true;\r\n    //Coordenadas de acotación de España. Peninsula y Canarias.\r\n    private $_arNarrowLat = array(\"min\"=&gt;24.654534254781115,\"max\"=&gt;45.18786629495072);\r\n    private $_arNarrowLong = array(\"min\"=&gt;-19.80908203125, \"max\"=&gt;4.3828125);\r\n    //TODO: Direcciones a geolocalizar. Lo dejaré para otra versión.\r\n    private $_arAddresses = array();\r\n    //Indica si se ha de esperar x microsegundos a que responda la url de petición\r\n    private $_useDelay = true;\r\n    private $_iDelayTime = 250;\r\n    \r\n    //Indicadores del estado de la petición de geolocalización.\r\n    private $_is_error = false;\r\n    private $_message = \"\";\r\n    \r\n    \r\n    /**\r\n     * Formato del array de marcadores:\r\n       $arMarkers[]=array\r\n       (\r\n            \"title\"=&gt;\"un titulo \", Lo que se mostrara al pasar el raton\r\n            \"content\"=&gt;\"&lt;b&gt;Un contenido&lt;/b&gt;\", El texto dentro del popup de dialogo\r\n            \"latitude\"=&gt;\"36.643271085342\",\r\n            \"longitude\"=&gt;\"-4.578660819468\"\r\n        );\r\n     * @param array $arMarkers Array anidado tipo tabla filas x columnas \r\n     * @param array $arAddresses TODO próxima entrega ;0) \r\n     */\r\n    public function __construct($arMarkers=array(),$arAddresses=array(),$sApikey=\"\") \r\n    { \r\n        $this-&gt;_arMarkers = $arMarkers;\r\n        $this-&gt;_arAddresses = $arAddresses;\r\n        if(!empty($sApikey)) $this-&gt;_sApikey = $sApikey;\r\n    }\r\n    \r\n    //Pasa al objeto javascript los datos configurados en esta clase y despues\r\n    //ejecuta load_map(), función javascript que dibuja el mapa con los datos\r\n    //de configuración.\r\n    public function draw_map()\r\n    {\r\n        if($this-&gt;_useGoogleJquery) $this-&gt;show_google_jquery_tag();\r\n        if($this-&gt;_isAutoApikey) $this-&gt;show_apikey_tag();\r\n ?&gt;\r\n\r\n<script type=\"text/javascript\">\r\n    gmaps3.config.arMarkers = &lt;?php $this-&gt;show_js_array_table(); ?&gt;;\r\n    gmaps3.config.sIdDivContainer = &lt;?php $this-&gt;get_div_container(); ?&gt;;\r\n    gmaps3.config.iZoom = &lt;?php $this-&gt;get_zoom(); ?&gt;;\r\n    gmaps3.config.fLatitude = &lt;?php $this-&gt;get_latitude(); ?&gt;;\r\n    gmaps3.config.fLongitude = &lt;?php $this-&gt;get_longitude(); ?&gt;;\r\n    gmaps3.config.sMapType = &lt;?php $this-&gt;get_maptype(); ?&gt;;\r\n    gmaps3.config.useMarkersNumbers = &lt;?php $this-&gt;is_makers_with_numbers(); ?&gt;;\r\n    gmaps3.config.drawLines = &lt;?php $this-&gt;do_draw_lines(); ?&gt;;\r\n    gmaps3.config.iHeight = &lt;?php $this-&gt;get_height(); ?&gt;;\r\n    gmaps3.config.iWidth = &lt;?php $this-&gt;get_width(); ?&gt;;\r\n    gmaps3.config.sUnitWH = &lt;?php $this-&gt;get_size_unit(); ?&gt;;\r\n    //bug(gmaps3,\"gmaps3\"); //La función bug es equivalente a console.debug\r\n    //bug(gmaps3.config.arMarkers,\"markers\");\r\n    jQuery(document).ready(gmaps3.load_map);\r\n</script>\r\n&lt;?php\r\n    }\r\n    \r\n    /*\r\n     * Imprime en pantalla un array javascript de dos dimensiones.\r\n     */\r\n    private function show_js_array_table()\r\n    {\r\n        echo $this-&gt;get_js_as_array_table();\r\n    }\r\n    \r\n    /*\r\n     * Devuelve un string js con el formato de un array generado desde \r\n     * $this_arMarkers\r\n     */\r\n    private function get_js_as_array_table()\r\n    {\r\n        $arTable = $this-&gt;_arMarkers;\r\n        \r\n        $arItems = array();\r\n        $sJsArray = \"[\";\r\n        foreach($arTable as $i=&gt;$arRow)\r\n            $arItems[] = $this-&gt;get_as_js_array_row($arRow);\r\n\r\n        if(!empty($arItems)) $sJsArray .= implode(\",\", $arItems);\r\n        $sJsArray .= \"]\";\r\n        return $sJsArray;\r\n    }\r\n\r\n    /**\r\n     * Se le pasa un array de tipo columnas y lo convierte en array js\r\n     * @param array $arRow tipo array(\"nombre_columna\"=&gt;\"valor\",..,)\r\n     * @return string Cadena de texto en formato array \r\n     */\r\n    private function get_as_js_array_row($arRow=array())\r\n    {\r\n        $arItems = array();\r\n        $sJsArray = \"[\";\r\n        foreach($arRow as $key=&gt;$sFieldValue)\r\n        {\r\n            switch($key) \r\n            {\r\n                case \"content\":\r\n                case \"title\":\r\n                    $arItems[] = $this-&gt;get_as_js_string($sFieldValue);\r\n                break;\r\n                case \"number\":\r\n                case \"latitude\":\r\n                case \"longitude\":\r\n                case \"zindex\":\r\n                    $arItems[] = $sFieldValue;\r\n                break;\r\n            }\r\n        }\r\n        if(!empty($arItems)) $sJsArray .= implode(\",\", $arItems);\r\n        $sJsArray .= \"]\\n\";\r\n        return $sJsArray;\r\n        //[\'sTitle\', fLat, fLong, iZindex, sContent, iIconNumber]\r\n    }\r\n    \r\n    /**\r\n     * Se utiliza para generar un array de substrings\r\n     * @param string $sValue\r\n     * @return string algo como \'1\'. Asi js lo entenderá como un string.\r\n     */\r\n    private function get_as_js_string($sValue)\r\n    {\r\n        return \"\'$sValue\'\";\r\n    }\r\n    \r\n    /**\r\n     *\r\n     * @param array $arPoint1 array(\"latitude\"=&gt;valor,\"longitude\"=&gt;valor)\r\n     * @param array $arPoint2 array(\"latitude\"=&gt;valor,\"longitude\"=&gt;valor)\r\n     * @return float distancia redondeada a dos decimales. \r\n     */\r\n    public function distance_calculation(array $arPoint1, array $arPoint2)\r\n    {\r\n        $fX1 = $arPoint1[\"latitude\"];\r\n        $fY1 = $arPoint1[\"longitude\"];\r\n        $fX2 = $arPoint2[\"latitude\"];\r\n        $fY2 = $arPoint2[\"longitude\"];\r\n        \r\n        if(is_numeric($fX1)&&is_numeric($fY1)&&is_numeric($fX2)&&is_numeric($fY2))\r\n            $fX1 = sqrt(pow(($fX1 - $fX2),2) + pow(($fY1-$fY2),2));\r\n        $fX1 = round($fX1, 2);\r\n        return (float)$fX1;\r\n    }\r\n    \r\n    /*\r\n     * Dependiendo de los datos de las chinchetas se va calculando las distancias\r\n     * ojo, NO EL RECORRIDO.\r\n     */\r\n    public function sum_distance()\r\n    {\r\n        $arPoint1 = array(\"latitude\"=&gt;0,\"longitude\"=&gt;0);\r\n        $arPoint2 = array(\"latitude\"=&gt;0,\"longitude\"=&gt;0);\r\n        $iNumMarkers =count($this-&gt;_arMarkers);\r\n        $fDistance = 0;\r\n        for($i=0; $i&lt;$iNumMarkers-1; $i++)\r\n        {\r\n            $arPoint1[\"latitude\"] = $this-&gt;_arMarkers[$i][\"latitude\"];\r\n            $arPoint1[\"longitude\"] = $this-&gt;_arMarkers[$i][\"longitude\"];                \r\n            $arPoint2[\"latitude\"] = $this-&gt;_arMarkers[$i+1][\"latitude\"];\r\n            $arPoint2[\"longitude\"] = $this-&gt;_arMarkers[$i+1][\"longitude\"];\r\n            $fDistance += $this-&gt;distance_calculation($arPoint1, $arPoint2);\r\n        }\r\n        return (float)$fDistance;\r\n    }\r\n    \r\n    //GETTERS\r\n    public function get_markers(){return $this-&gt;_arMarkers;}\r\n    public function is_makers_with_numbers()\r\n    {\r\n        if($this-&gt;_useMakersNumbers) echo \"true\";\r\n        else echo \"false\";\r\n    }\r\n    \r\n    public function do_draw_lines()\r\n    {\r\n        if($this-&gt;_drawLines) echo \"true\";\r\n        else echo \"false\";\r\n    }\r\n    \r\n    /**\r\n     * Segun un array con datos de una dirección se recupera su latitud y longitud\r\n     * @param array $arAddress array(\"pais\"=&gt;\"España\",\"direccion\"=&gt;\"Conde de Peñalver 32\", \"zona\"=&gt;\"Madrid\", \"cp\"=&gt;\"28006\");\r\n     */\r\n    public function get_latlong_from_address(array $arAddress)\r\n    {\r\n        $arLl = array(\"latitude\"=&gt;\"\",\"longitude\"=&gt;\"\");\r\n        \r\n        if(!empty($arAddress))\r\n        {\r\n            $sGmapAskAddress = $this-&gt;_sUrlAskAddress;\r\n            //Une con comas el array\r\n            $sAddrForUrl = join(\", \",$arAddress);\r\n            //codifica el string en utf\r\n            $sAddrForUrl = utf8_encode($sAddrForUrl);\r\n            //codifica el string en formato url\r\n            $sAddrForUrl = urldecode($sAddrForUrl);\r\n            //sustituye espacios por el caracter +\r\n            $sAddrForUrl = str_replace(\" \", \"+\", $sAddrForUrl);\r\n            \r\n            $sGmapAskAddress = $sGmapAskAddress.\"?address=\".$sAddrForUrl.\"&sensor=false\";\r\n            //bug($sGmapAskAddress);\r\n            $oXml = simplexml_load_file($sGmapAskAddress);\r\n            //bug($oXml); die;\r\n            \r\n            //Dependiendo de cuanto esté ocupado el servidor de google puede tardar mas ó menos. \r\n            //Para asegurarnos que se cree correctamente el objeto xml con los detalles de la dirección pedida\r\n            //forzamos a que el archivo espere unos instantes\r\n            if($this-&gt;_useDelay) usleep($this-&gt;_iDelayTime);//microsegundos\r\n            \r\n            if($oXml!=false)\r\n            {\r\n                //bug($oXml);\r\n                $sXmlStatus = $oXml-&gt;status;\r\n                \r\n                //status ok. Se ha localizado la dirección\r\n                if(strcmp($sXmlStatus,\"OK\") == 0)\r\n                {\r\n\r\n                    $fLatitude = $oXml-&gt;result-&gt;geometry-&gt;location-&gt;lat;//v3\r\n                    $fLongitude = $oXml-&gt;result-&gt;geometry-&gt;location-&gt;lng;//v3\r\n                    $fLatitude = (float) $fLatitude;\r\n                    $fLongitude = (float) $fLongitude;\r\n                    //bug($fLatitude,\"latitud\"); bug($fLongitude,\"longitud\");\r\n                    if($this-&gt;_doNarrowSearch)\r\n                    {    \r\n                        if($this-&gt;is_in_range_latlong($fLatitude, $fLongitude))\r\n                        {\r\n                            $arLl[\"latitude\"]=$fLatitude; $arLl[\"longitude\"]=$fLongitude;\r\n                            $this-&gt;_message = \"Dirección encontrada\";\r\n                        }\r\n                        //fuera de rango\r\n                        else\r\n                        {\r\n                            //bug(\"fuera de rango\");\r\n                            $this-&gt;set_message_error(\"Dirección fuera de rango: Lat:$fLatitude, Long:$fLongitude\");\r\n                        }\r\n                    }\r\n                    //No se usa acotación\r\n                    else\r\n                    {\r\n                        $arLl[\"latitude\"]=$fLatitude; $arLl[\"longitude\"]=$fLongitude;\r\n                        $this-&gt;_message = \"Dirección encontrada\";\r\n                    }\r\n                }\r\n                //status de xml fallido\r\n                else\r\n                {\r\n                    $this-&gt;set_message_error(\"La dirección $sAddrForUrl no se pudo geolocalizar. Estado=$sXmlStatus\");\r\n                }\r\n            }\r\n            //error en simplexml_load_file\r\n            else\r\n            {\r\n                $this-&gt;set_message_error(\"No se ha podido crear xml desde: $sGmapAskAddress\");\r\n            }\r\n\r\n        }\r\n        return $arLl;\r\n    }\r\n    \r\n    /**\r\n     * Determina si las coordenadas obtenidas de una dirección está dentro de los limites\r\n     * de acotación\r\n     * @param float $fLatitude \r\n     * @param float $fLongitude\r\n     * @return boolean \r\n     */\r\n    private function is_in_range_latlong($fLatitude=0.0,$fLongitude=0.0)\r\n    {\r\n        //bug($this-&gt;_arNarrowLat,\"lat\"); bug($fLatitude,\"lat\"); bug($this-&gt;_arNarrowLong,\"long\"); bug($fLongitude,\"long\");\r\n        //bug($this-&gt;comapre_float($fLatitude,\"&lt;\",$this-&gt;_arNarrowLat[\"max\"]),\"lat &lt; latmax?\");\r\n        //bug($this-&gt;comapre_float($this-&gt;_arNarrowLat[\"min\"],\"&lt;\",$fLatitude),\"latmin &gt; latitude?\");\r\n        //bug($this-&gt;comapre_float($fLongitude,\"&lt;\",$this-&gt;_arNarrowLong[\"max\"]),\"long &lt; longmax?\");\r\n        //bug($this-&gt;comapre_float($this-&gt;_arNarrowLong[\"min\"],\"&lt;\",$fLongitude),\"longmin &gt; longitude?\");\r\n        $isInRange = \r\n        (\r\n            $this-&gt;comapre_float($fLatitude,\"&lt;\",$this-&gt;_arNarrowLat[\"max\"]) &&\r\n            $this-&gt;comapre_float($this-&gt;_arNarrowLat[\"min\"],\"&lt;\",$fLatitude) &&\r\n\r\n            $this-&gt;comapre_float($fLongitude,\"&lt;\",$this-&gt;_arNarrowLong[\"max\"]) &&\r\n            $this-&gt;comapre_float($this-&gt;_arNarrowLong[\"min\"],\"&lt;\",$fLongitude)                 \r\n        );\r\n        return $isInRange;\r\n    }\r\n    \r\n    /**\r\n     * Función para comparar números en coma flotante (eaf)\r\n     * La comparación de números en coma flotante no es tribial. No se puede \r\n     * utilizar por ejemplo: $float1&gt;$float2... es decir, los operadores comunes.\r\n     * Esta función pasa los numeros a binarios con una precision marcada\r\n     * @param float $float1\r\n     * @param char $cOperator =, &lt;, &gt;, &lt;=, &gt;= !=\r\n     * @param float $float2 \r\n     * @param integer $iPrecision \r\n     * @return boolean o \"operator error\";\r\n     */\r\n    private function comapre_float($float1,$cOperator=\"=\",$float2,$iPrecision=10)\r\n    {\r\n        //Siempre la comparación se hace de float1 con respecto a float1\r\n        // si el resultado es: 0 son igulaes, -1 f1 menor, 1 f1 mayor\r\n        switch (trim($cOperator)) \r\n        {\r\n            case \"=\":\r\n                return bccomp($float1, $float2, $iPrecision)==0;\r\n            break;\r\n            case \"&lt;\":\r\n                return bccomp($float1, $float2, $iPrecision)==-1;\r\n            break;\r\n            case \"&gt;\":\r\n                return bccomp($float1, $float2, $iPrecision)==1;\r\n            break;\r\n            case \"!=\":\r\n                return !(compare_float($float1,\"=\",$float2, $iPrecision));\r\n            break;        \r\n            case \"&gt;=\":\r\n                return compare_float($float1,\"&gt;\",$float2, $iPrecision)\r\n                    ||compare_float($float1,\"=\",$float2, $iPrecision);\r\n            break;\r\n            case \"&lt;=\":\r\n                return compare_float($float1,\"&lt;\",$float2, $iPrecision)\r\n                    ||compare_float($float1,\"=\",$float2, $iPrecision);\r\n            break;\r\n\r\n            default:\r\n                return \"operator error\";\r\n            break;\r\n        }\r\n    }\r\n    \r\n    //Devuelve un string con el tag de javascript de la libreria jquery\r\n    public function get_google_jquery()\r\n    {\r\n        $sTagJquery = \"&lt;script type=\\\"text/javascript\\\" src=\\\"https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js\\\"&gt;&lt;/script&gt;\\n\";\r\n        return $sTagJquery;     \r\n    }\r\n    \r\n    public function show_google_jquery_tag(){echo $this-&gt;get_google_jquery();}\r\n    \r\n    \r\n    public function get_apikey_tag()\r\n    {\r\n        $sApiUrl = \"\";\r\n        //bug($this-&gt;_sApikey);\r\n        if(!empty($this-&gt;_sApikey))\r\n            $sApiUrl = \"&lt;script type=\\\"text/javascript\\\" src=\\\"http://maps.googleapis.com/maps/api/js?key=$this-&gt;_sApikey&sensor=false\\\"&gt;&lt;/script&gt;\\n\";\r\n        else\r\n            $sApiUrl = \"&lt;script type=\\\"text/javascript\\\" src=\\\"http://maps.googleapis.com/maps/api/js?sensor=false\\\"&gt;&lt;/script&gt;\\n\";\r\n        return $sApiUrl;\r\n    }\r\n    \r\n    public function show_apikey_tag(){echo $this-&gt;get_apikey_tag();}\r\n    \r\n    private function get_maptype(){echo $this-&gt;_sMapType;}\r\n    private function get_div_container(){echo $this-&gt;_sIdDivContainer;}\r\n    private function get_zoom(){echo $this-&gt;_iZoom;}\r\n    private function get_latitude(){ echo $this-&gt;_fLatitude; }\r\n    private function get_longitude(){ echo $this-&gt;_fLongitude; }\r\n    private function get_height(){echo $this-&gt;_iHeight;}\r\n    private function get_width(){echo $this-&gt;_iWidth;}\r\n    private function get_size_unit(){echo \"\'$this-&gt;_sUnitWH\'\";}\r\n    private function get_message(){return $this-&gt;_message;}\r\n    public function get_sApikey(){ return $this-&gt;_sApikey;}\r\n    \r\n    //SETTERS\r\n    public function set_markers($arMarkers=array()){ $this-&gt;_arMarkers = $arMarkers; }\r\n    public function set_markers_numbers_off($isOn=false){$this-&gt;_useMakersNumbers = $isOn;}\r\n    \r\n    public function set_maptype($sValue){$this-&gt;_sMapType = strtolower(\"\'$sValue\'\");}\r\n    public function set_div_container($sValue){ $this-&gt;_sIdDivContainer = \"\'$sValue\'\"; }\r\n    public function set_zoom($iZoom){ $this-&gt;_iZoom = $iZoom; }\r\n    public function set_latitude($fLatitude){ $this-&gt;_fLatitude = $fLatitude; }\r\n    public function set_longitude($fLongitude){ $this-&gt;_fLongitude = $fLongitude; }\r\n    public function draw_lines($isOn=true){ $this-&gt;_drawLines = $isOn; }\r\n    public function set_size_container($iWidth=800,$iHeight=600)\r\n    {\r\n        if(!empty($iHeight))$this-&gt;_iHeight = $iHeight;\r\n        if(!empty($iWidth)) $this-&gt;_iWidth = $iWidth;        \r\n    }\r\n    public function set_size_unit($sType=\"pt\"){ $this-&gt;_sUnitWH = $sType; }\r\n    public function add_address(array $arAddress){ $this-&gt;_arAddresses[] = $arAddress; }\r\n    private function set_message_error($sMessage,$isError=true)\r\n    {\r\n        $this-&gt;_is_error = $isError;\r\n        $this-&gt;_message = $sMessage;\r\n    }\r\n    /**\r\n     * Solo influye para recuperar latitud y longitud de direcciones. \r\n     * No en el pintado de marcadores\r\n     * @param boolean $isOn     \r\n     */\r\n    public function no_narrow($isOn=false){ $this-&gt;_doNarrowSearch = $isOn; }\r\n    public function set_delay_time($iMicroSeconds){$this-&gt;_iDelayTime = $iMicroSeconds;}\r\n    public function no_dalay($isOn=false){ $this-&gt;_useDelay = $isOn; }\r\n    public function set_apikey($sApikey){$this-&gt;_sApikey = $sApikey;}\r\n    public function no_auto_apikey($isOn=false){$this-&gt;_isAutoApikey = $isOn;}\r\n    public function no_google_jquery($isOn=false){$this-&gt;_useGoogleJquery = $isOn;}\r\n}\r\n\r\n</pre>\r\n\r\n<h4>Clase javascript gmaps3</h4>\r\n<pre class=\"brush: javascript\">\r\n/**\r\n * @author Eduardo Acevedo Farje.\r\n * @link www.eduardoaf.com\r\n * @version 1.0.4\r\n * @name Javascript class for GoogleMaps3  \r\n * @uses google_maps_3.php, jquery v1.7+\r\n */\r\n//La función bug es equivalente a la de php. Imprime trazas en la consola\r\n//de firebug\r\nvar bug = function(value,title)\r\n{\r\n    if(window.console != undefined)\r\n    {    \r\n        if(title!=null) console.debug(title);\r\n        console.debug(value);\r\n    }\r\n};\r\n\r\nvar gmaps3 =\r\n{\r\n    config : \r\n    {\r\n        sMapType : \'roadmap\',\r\n        sIdDivContainer : \'map_canvas\', //Div contenedor\r\n        iZoom : 6,\r\n        fLatitude : 40.41694, //Puerta del sol (Madrid).\r\n        fLongitude : -3.70361,\r\n        arMarkers : [],\r\n        useMarkersNumbers : true,\r\n        drawLines : false,\r\n        iWidth : 800,\r\n        iHeight: 600,\r\n        sUnitWH : \'px\'\r\n    },\r\n    \r\n    //arLocations: [sTitle, sContent, fLatitude, fLongitude],..[]\r\n    draw_markers : function(arMarkers)\r\n    {\r\n        var arTmpMarker;\r\n        var oLatLng;\r\n        var sTitle;\r\n        var sContent;\r\n        var iMarkerNumber;\r\n        var iCoordZ;\r\n        \r\n        for(var i = 0; i < arMarkers.length; i++) \r\n        {\r\n            arTmpMarker = arMarkers[i];\r\n            sTitle = arTmpMarker[0];\r\n            sContent = arTmpMarker[1];\r\n            oLatLng = new google.maps.LatLng(arTmpMarker[2], arTmpMarker[3]);\r\n            iMarkerNumber = i+1;\r\n            iCoordZ = i+1;\r\n            //bug(oLatLng,\"oLatLng\");\r\n            //iIconNumber = arTmpLocation[5];\r\n            this.draw_marker(sTitle, sContent, oLatLng, iMarkerNumber, iCoordZ);\r\n        }\r\n    },\r\n    \r\n    //https://developers.google.com/maps/documentation/javascript/overlays#Markers\r\n    draw_marker : function(sTitle, sContent, oLatLng, iNumber, iCoordZ, \r\n    oMiImage,oMiShadow,oMiIcon,oShape)\r\n    {\r\n        var sIconUrl = \'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=\';\r\n        var sEndIconUrl = \'|FE6256|000000\';\r\n        var oInfoWindow = null;\r\n       \r\n        var oMarker = new google.maps.Marker\r\n        (\r\n            {\r\n                map: this.oMap,\r\n                title: sTitle,\r\n                position: oLatLng,\r\n                zIndex: iCoordZ,\r\n                image: oMiImage, //oMarkerImage\r\n                shadow: oMiShadow, //oMarkerImage\r\n                icon: oMiIcon, //oMarkerImage\r\n                shape: oShape // coord: [1, 1, 1, 20, 18, 20, 18 , 1], type: \'poly\'\r\n            }\r\n        );\r\n        \r\n        if(oMiIcon==null && iNumber!=\'\' && gmaps3.config.useMarkersNumbers)\r\n            oMarker.icon = sIconUrl + iCoordZ + sEndIconUrl;\r\n        \r\n        if(sContent!=null && jQuery.trim(sContent)!=\'\')\r\n        {\r\n            oInfoWindow = new google.maps.InfoWindow\r\n            (\r\n                { content: sContent }\r\n            );\r\n            \r\n            var on_click = function()\r\n            {\r\n                oInfoWindow.open(gmaps3.oMap,oMarker);\r\n            }\r\n            google.maps.event.addListener(oMarker,\'click\',on_click);\r\n        }\r\n        //bug(oMarker,\"oMarker\");\r\n    },\r\n    \r\n    draw_lines : function(arLatLong)\r\n    {\r\n        var arObjectsLl = [];\r\n        var fLat = 0;\r\n        var fLong = 0;\r\n        var arTmpLatLong = [];\r\n        var oTmpLatLng = null;\r\n        for(var i = 0; i < arLatLong.length; i++) \r\n        {\r\n            arTmpLatLong = arLatLong[i];\r\n            fLat = arTmpLatLong[0];\r\n            fLong = arTmpLatLong[1];\r\n            \r\n            oTmpLatLng = new google.maps.LatLng(fLat, fLong);\r\n            arObjectsLl.push(oTmpLatLng);\r\n        }\r\n        //bug(arObjectsLl,\"arObjectsLi\");\r\n        var oPolyLine = new google.maps.Polyline\r\n        (\r\n            {\r\n                path: arObjectsLl,\r\n                strokeColor: \"#FF0000\",\r\n                strokeOpacity: 1.0,\r\n                strokeWeight: 2\r\n            }\r\n        );\r\n\r\n        oPolyLine.setMap(gmaps3.oMap);\r\n    },\r\n    \r\n    get_maptype : function(sType)\r\n    {\r\n        var oMapTypeId = null;\r\n        var sType = sType || this.config.sMapType;\r\n        sType = sType.toLowerCase();\r\n        if(sType==\"roadmap\")\r\n        {\r\n            oMapTypeId = google.maps.MapTypeId.ROADMAP;\r\n        }\r\n        else if(sType==\"satelite\")\r\n        {\r\n            oMapTypeId = google.maps.MapTypeId.SATELITE;\r\n        }\r\n        else if(sType==\"hybrid\")\r\n        {\r\n            oMapTypeId = google.maps.MapTypeId.HYBRID;\r\n        }\r\n        else //if(sType=\"terrain\")\r\n        {\r\n            oMapTypeId = google.maps.MapTypeId.TERRAIN;\r\n        }\r\n        return oMapTypeId;\r\n    },\r\n    \r\n    extract_latlong_from_markers : function(arMarkers, asGoogleObj)\r\n    {\r\n        var arMarkers = arMarkers || this.config.arMarkers;\r\n        var arLatLong = [];\r\n        var arTemp = [];\r\n        var fLatitude = 0;\r\n        var fLongitude = 0;\r\n        //Los marcadores es un array de arrays cuyas filas llevan como \r\n        //campos los datos a mostrar en pantalla\r\n        for(var i=0; i<arMarkers.length i++)\r\n        {\r\n            arTemp = arMarkers[i];\r\n            fLatitude = arTemp[2];\r\n            fLongitude = arTemp[3];\r\n            if(asGoogleObj==null) arTemp = [fLatitude,fLongitude];\r\n            else arTemp = new google.maps.LatLng(fLatitude,fLongitude);\r\n            arLatLong.push(arTemp);\r\n        }\r\n        return arLatLong;\r\n    },\r\n    \r\n    fit_in_screen : function()\r\n    {\r\n        //Objetos de tipo maps.LatLng\r\n        var arLlObjects = this.extract_latlong_from_markers(null,true);\r\n        //bug(arLlObjects,\"llobjects\");\r\n        //Recuperamos los limites que se están visualizando\r\n        var oLlBound = new google.maps.LatLngBounds();\r\n        //Recorremos cada punto y lo pasamos por el metodo extend\r\n        for(var i = 0; i < arLlObjects.length; i++) \r\n        {\r\n            oLlBound.extend(arLlObjects[i]);\r\n        }\r\n        //  Fit these bounds to the map\r\n        this.oMap.fitBounds(oLlBound);\r\n    },\r\n    \r\n    //=======================================================================\r\n    oMap : null, //El objeto mapa\r\n    \r\n    //Antes la llamaba initialize. Le he cambiado el nombre para demostrar\r\n    //que no necesariamente tiene que ser asi.\r\n    load_map: function()\r\n    {\r\n        //bug(this,\"this en initialize\"); //this aqui es document\r\n        //bug(this.gmap,\"this gmap\"); no existe \r\n        \r\n        //el div donde se dibujara el mapa\r\n        var eDivContainer = document.getElementById(gmaps3.config.sIdDivContainer);\r\n        //objeto jquery del div contenedor. Es distinto del anterior ya que no puedo\r\n        //utilizar este mismo dentro del constructor \"Map\". este objeto me sirve \r\n        //para configurar sus estilos\r\n        var eDivCanvas = jQuery(eDivContainer);\r\n        if(gmaps3.config.sUnitWH==\'px\')\r\n        {\r\n            eDivCanvas.width(gmaps3.config.iWidth);\r\n            eDivCanvas.height(gmaps3.config.iHeight);\r\n        }\r\n        else\r\n        {\r\n            var sSize = gmaps3.config.iWidth + gmaps3.config.sUnitWH;\r\n            bug(sSize);\r\n            eDivCanvas.width(sSize);\r\n            sSize = gmaps3.config.iHeight + gmaps3.config.sUnitWH;\r\n            eDivCanvas.height(sSize);\r\n            \r\n        }\r\n        eDivCanvas.css(\"margin\", \"0\");\r\n        eDivCanvas.css(\"padding\", \"0\");\r\n        \r\n        //La zona a visualizar. Es un objeto latitud longitud el cual se utilizará \r\n        //para centrar el mapa.\r\n        var oLlCenter = new google.maps.LatLng(gmaps3.config.fLatitude, gmaps3.config.fLongitude);\r\n        \r\n        var oConfig = \r\n        {\r\n            center: oLlCenter,\r\n            zoom: gmaps3.config.iZoom,\r\n            mapTypeId : gmaps3.get_maptype()\r\n        };\r\n        \r\n        //bug(oConfig,\"config\");\r\n        gmaps3.oMap = new google.maps.Map(eDivContainer, oConfig);\r\n        //bug(gmaps3.oMap,\"mapa recien construido\");\r\n        gmaps3.draw_markers(gmaps3.config.arMarkers);\r\n        \r\n        if(gmaps3.config.drawLines==true)\r\n        {\r\n            var arLatLong = gmaps3.extract_latlong_from_markers(gmaps3.config.arMarkers);\r\n            //bug(arLatLong,\"arLatLong\");\r\n            gmaps3.draw_lines(arLatLong);\r\n        }\r\n        //Reajusta la visualizacion de los marcadores\r\n        gmaps3.fit_in_screen();\r\n        //bug(gmaps3);\r\n        //gmaps3 = null; si hago esto no podria acceder a los marcadores al hacer click\r\n        //bug(gmaps3);\r\n    }\r\n};\r\n</pre>','Hace dos semanas empecé con un proyecto para trazar rutas del transporte escolar.  Una de las funciones era recibir las paradas en coordenadas y marcarlas en el mapa.  \r\nEsta clase de tipo componente hace eso y más.  Devuelve las coordenadas desde una dirección,  dibuja lineas entre marcadores, calcula distancias entre los puntos de inicio y final, controla el tamaño del mapa, el zoom.  Pero lo mejor de todo es que no tendrás que picar código javascript. Todo se hace con php.','publish','php-clase-para-trabajar-con-google-maps');

/*Table structure for table `migrations` */

DROP TABLE IF EXISTS `migrations`;

CREATE TABLE `migrations` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `migration` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `batch` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

/*Data for the table `migrations` */

insert  into `migrations`(`id`,`migration`,`batch`) values (1,'2014_10_12_000000_create_users_table',1),(2,'2014_10_12_100000_create_password_resets_table',1),(3,'2019_08_19_000000_create_failed_jobs_table',1),(4,'2020_09_02_111139_create_app_array_table',0),(5,'2020_09_02_111139_create_app_post_table',0),(6,'2020_09_02_111139_create_app_posts_tags_table',0),(7,'2020_09_02_111139_create_app_tag_table',0),(8,'2020_09_02_111139_create_app_tag_array_table',0),(9,'2020_09_02_111139_create_base_user_table',0),(10,'2020_09_02_111139_create_base_user_array_table',0),(11,'2020_09_02_111139_create_failed_jobs_table',0),(12,'2020_09_02_111139_create_password_resets_table',0),(13,'2020_09_02_111139_create_users_table',0),(14,'2020_09_02_105624_app_post',2);

/*Table structure for table `password_resets` */

DROP TABLE IF EXISTS `password_resets`;

CREATE TABLE `password_resets` (
  `email` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `token` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  KEY `password_resets_email_index` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

/*Data for the table `password_resets` */

/*Table structure for table `users` */

DROP TABLE IF EXISTS `users`;

CREATE TABLE `users` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `email` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `email_verified_at` timestamp NULL DEFAULT NULL,
  `password` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,
  `remember_token` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `users_email_unique` (`email`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

/*Data for the table `users` */

insert  into `users`(`id`,`name`,`email`,`email_verified_at`,`password`,`remember_token`,`created_at`,`updated_at`) values (1,'Eduardo','eacevedof@hotmail.com',NULL,'$2y$10$fy2V3jvaRA9l/N1JO1l1ZOlL/xeXT9.nuzqVAVbpkrTCgqUa8gT5G',NULL,'2020-09-02 14:07:52','2020-09-02 14:07:52');

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
